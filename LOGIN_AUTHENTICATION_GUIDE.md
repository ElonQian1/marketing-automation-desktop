# ç™»å½•è®¤è¯ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

æœ¬é¡¹ç›®å·²é›†æˆå®Œæ•´çš„ç™»å½•è®¤è¯ç³»ç»Ÿï¼ŒåŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

âœ… **æœ¬åœ°è®¤è¯**ï¼šæ— éœ€åç«¯æœåŠ¡å™¨ï¼ŒåŸºäºæœ¬åœ°å­˜å‚¨
âœ… **è¯•ç”¨æœŸç®¡ç†**ï¼šæ”¯æŒ 15 å¤©è¯•ç”¨æœŸï¼Œè‡ªåŠ¨è¿‡æœŸæ£€æµ‹
âœ… **æƒé™ç®¡ç†**ï¼šæ”¯æŒç®¡ç†å‘˜å’Œè¯•ç”¨ç”¨æˆ·ä¸¤ç§è§’è‰²
âœ… **æŒä¹…åŒ–å­˜å‚¨**ï¼šç™»å½•çŠ¶æ€è‡ªåŠ¨ä¿å­˜ï¼Œåˆ·æ–°é¡µé¢ä¸ä¼šä¸¢å¤±
âœ… **è¯•ç”¨æœŸæé†’**ï¼šå‰©ä½™å¤©æ•° â‰¤ 3 å¤©æ—¶è‡ªåŠ¨å¼¹çª—æé†’
âœ… **è¿‡æœŸå¼ºåˆ¶ç™»å‡º**ï¼šè¯•ç”¨æœŸç»“æŸåè‡ªåŠ¨é€€å‡ºï¼Œç¦æ­¢ä½¿ç”¨

---

## ğŸ” æµ‹è¯•è´¦æˆ·

### 1. ç®¡ç†å‘˜è´¦æˆ·
```
ç”¨æˆ·å: admin
å¯†ç : admin123
è§’è‰²: ç®¡ç†å‘˜
æƒé™: æ— é™æœŸä½¿ç”¨
```

### 2. è¯•ç”¨è´¦æˆ·
```
ç”¨æˆ·å: test
å¯†ç : test123
è§’è‰²: è¯•ç”¨ç”¨æˆ·
æƒé™: 15 å¤©è¯•ç”¨æœŸ
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨åº”ç”¨

```bash
npm run dev
```

### 2. ç™»å½•æµç¨‹

1. åº”ç”¨å¯åŠ¨åä¼šè‡ªåŠ¨æ˜¾ç¤ºç™»å½•é¡µé¢
2. è¾“å…¥æµ‹è¯•è´¦æˆ·çš„ç”¨æˆ·åå’Œå¯†ç 
3. ç‚¹å‡»"ç™»å½•"æŒ‰é’®
4. ç™»å½•æˆåŠŸåè¿›å…¥ä¸»åº”ç”¨

### 3. ç”¨æˆ·ä¿¡æ¯æŸ¥çœ‹

ç™»å½•åï¼Œåœ¨åº”ç”¨å³ä¸Šè§’å¯ä»¥çœ‹åˆ°ï¼š
- ç”¨æˆ·å¤´åƒï¼ˆç‚¹å‡»å±•å¼€ä¸‹æ‹‰èœå•ï¼‰
- ç”¨æˆ·åå’Œè§’è‰²æ ‡ç­¾
- è¯•ç”¨ç”¨æˆ·ä¼šæ˜¾ç¤ºå‰©ä½™å¤©æ•°
- é€€å‡ºç™»å½•æŒ‰é’®

---

## ğŸ› ï¸ ç³»ç»Ÿæ¶æ„

### æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ authStore.ts              # è®¤è¯çŠ¶æ€ç®¡ç† (Zustand)
â”œâ”€â”€ components/
â”‚   â””â”€â”€ auth/
â”‚       â””â”€â”€ AuthGuard.tsx         # è®¤è¯å®ˆå«ç»„ä»¶
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ auth/
â”‚       â””â”€â”€ LoginPageNative.tsx   # ç™»å½•é¡µé¢
â””â”€â”€ App.tsx                       # åº”ç”¨å…¥å£ï¼ˆé›†æˆ AuthGuardï¼‰
```

### æ ¸å¿ƒç»„ä»¶

#### 1. authStore.ts
- **ä½œç”¨**ï¼šå…¨å±€è®¤è¯çŠ¶æ€ç®¡ç†
- **æŠ€æœ¯æ ˆ**ï¼šZustand + Persist
- **å­˜å‚¨ä½ç½®**ï¼šLocalStorage (`auth-storage`)
- **åŠŸèƒ½**ï¼š
  - ç”¨æˆ·ç™»å½•/ç™»å‡º
  - è¯•ç”¨æœŸæ£€æŸ¥
  - å‰©ä½™å¤©æ•°è®¡ç®—
  - çŠ¶æ€æŒä¹…åŒ–

#### 2. AuthGuard.tsx
- **ä½œç”¨**ï¼šè·¯ç”±å®ˆå«ï¼Œä¿æŠ¤éœ€è¦ç™»å½•çš„é¡µé¢
- **åŠŸèƒ½**ï¼š
  - æ£€æŸ¥ç™»å½•çŠ¶æ€
  - æ£€æŸ¥è¯•ç”¨æœŸ
  - æ˜¾ç¤ºè¯•ç”¨æœŸè­¦å‘Š
  - å¼ºåˆ¶è¿‡æœŸç”¨æˆ·ç™»å‡º

#### 3. LoginPageNative.tsx
- **ä½œç”¨**ï¼šç¾è§‚çš„ç™»å½•ç•Œé¢
- **ç‰¹æ€§**ï¼š
  - å“åº”å¼è®¾è®¡
  - è¡¨å•éªŒè¯
  - é”™è¯¯æç¤º
  - æµ‹è¯•è´¦æˆ·æç¤º

---

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### 1. æ·»åŠ æ–°æµ‹è¯•è´¦æˆ·

ç¼–è¾‘ `src/stores/authStore.ts`ï¼š

```typescript
const TEST_ACCOUNTS = [
  {
    username: 'admin',
    password: 'admin123',
    role: 'admin' as const,
    email: 'admin@example.com'
  },
  {
    username: 'test',
    password: 'test123',
    role: 'trial' as const,
    email: 'test@example.com'
  },
  // ğŸ†• æ·»åŠ æ–°è´¦æˆ·
  {
    username: 'newuser',
    password: 'password123',
    role: 'trial' as const, // æˆ– 'admin'
    email: 'newuser@example.com'
  }
];
```

### 2. ä¿®æ”¹è¯•ç”¨æœŸå¤©æ•°

åœ¨ `authStore.ts` çš„ `login` å‡½æ•°ä¸­ä¿®æ”¹ï¼š

```typescript
// è¯•ç”¨è´¦æˆ·ï¼š15å¤©åˆ°æœŸ
const expiresAt = account.role === 'trial' 
  ? new Date(now.getTime() + 15 * 24 * 60 * 60 * 1000).toISOString() // ä¿®æ”¹è¿™é‡Œçš„ 15
  : undefined;
```

### 3. ä¿®æ”¹è¯•ç”¨æœŸè­¦å‘Šé˜ˆå€¼

åœ¨ `AuthGuard.tsx` ä¸­ä¿®æ”¹ï¼š

```typescript
// å¦‚æœå‰©ä½™å¤©æ•° <= 3 å¤©ï¼Œæ˜¾ç¤ºè­¦å‘Š
if (daysRemaining <= 3 && daysRemaining > 0) { // ä¿®æ”¹è¿™é‡Œçš„ 3
  setShowTrialWarning(true);
}
```

---

## ğŸ“Š åŠŸèƒ½æ¼”ç¤º

### 1. é¦–æ¬¡ç™»å½•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      å‘˜å·¥ç™»å½•                    â”‚
â”‚  ç¤¾äº¤å¹³å°è‡ªåŠ¨åŒ–æ“ä½œç³»ç»Ÿ           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æµ‹è¯•è´¦æˆ·:                       â”‚
â”‚  ç®¡ç†å‘˜è´¦æˆ·: admin / admin123    â”‚
â”‚  è¯•ç”¨è´¦æˆ·: test / test123 (15å¤©) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”¨æˆ·å: [___________________]   â”‚
â”‚  å¯†ç :   [___________________]   â”‚
â”‚  â–¡ è®°ä½æˆ‘          å¿˜è®°å¯†ç ï¼Ÿ    â”‚
â”‚  [        ç™»å½•        ]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. è¯•ç”¨æœŸè­¦å‘Š

å½“å‰©ä½™å¤©æ•° â‰¤ 3 å¤©æ—¶ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â° è¯•ç”¨æœŸå³å°†åˆ°æœŸ               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ‚¨çš„è¯•ç”¨æœŸè¿˜å‰© 3 å¤©             â”‚
â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘ 80%           â”‚
â”‚                                  â”‚
â”‚  è¯•ç”¨æœŸç»“æŸåï¼Œæ‚¨å°†æ— æ³•ç»§ç»­ä½¿ç”¨   â”‚
â”‚  æœ¬ç³»ç»Ÿã€‚è¯·åŠæ—¶è”ç³»ç®¡ç†å‘˜å‡çº§ã€‚   â”‚
â”‚                                  â”‚
â”‚            [æˆ‘çŸ¥é“äº†]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. è¯•ç”¨æœŸè¿‡æœŸ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          âš ï¸                      â”‚
â”‚      è¯•ç”¨æœŸå·²è¿‡æœŸ                â”‚
â”‚                                  â”‚
â”‚  æ‚¨çš„è¯•ç”¨æœŸå·²ç»“æŸã€‚å¦‚éœ€ç»§ç»­ä½¿ç”¨ï¼Œ â”‚
â”‚  è¯·è”ç³»ç®¡ç†å‘˜å‡çº§è´¦æˆ·ã€‚           â”‚
â”‚                                  â”‚
â”‚         [è¿”å›ç™»å½•]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹ LocalStorage

æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· â†’ Application â†’ Local Storageï¼š

```json
{
  "auth-storage": {
    "state": {
      "user": {
        "id": "abc123",
        "username": "test",
        "role": "trial",
        "createdAt": "2025-10-24T...",
        "expiresAt": "2025-11-08T..."
      },
      "token": "dGVzdDoxNzI5NzY1...",
      "isAuthenticated": true
    },
    "version": 0
  }
}
```

### 2. æ‰‹åŠ¨é‡ç½®è®¤è¯çŠ¶æ€

åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œï¼š

```javascript
localStorage.removeItem('auth-storage');
window.location.reload();
```

### 3. æ‰‹åŠ¨ä¿®æ”¹è¯•ç”¨æœŸåˆ°æœŸæ—¶é—´ï¼ˆæµ‹è¯•ç”¨ï¼‰

```javascript
const authData = JSON.parse(localStorage.getItem('auth-storage'));
authData.state.user.expiresAt = new Date(Date.now() + 1000 * 60 * 60).toISOString(); // 1å°æ—¶åè¿‡æœŸ
localStorage.setItem('auth-storage', JSON.stringify(authData));
window.location.reload();
```

---

## ğŸš¨ å¸¸è§é—®é¢˜

### Q1: ç™»å½•ååˆ·æ–°é¡µé¢éœ€è¦é‡æ–°ç™»å½•ï¼Ÿ

**A:** ä¸ä¼šã€‚ç™»å½•çŠ¶æ€ä¼šè‡ªåŠ¨ä¿å­˜åˆ° LocalStorageï¼Œåˆ·æ–°é¡µé¢ä¼šè‡ªåŠ¨æ¢å¤ç™»å½•çŠ¶æ€ã€‚

### Q2: è¯•ç”¨è´¦æˆ·è¿‡æœŸåå¦‚ä½•ç»§ç»­ä½¿ç”¨ï¼Ÿ

**A:** æœ‰ä¸¤ç§æ–¹æ³•ï¼š
1. ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ç™»å½•ï¼ˆæ— è¯•ç”¨æœŸé™åˆ¶ï¼‰
2. æ‰‹åŠ¨æ¸…é™¤ LocalStorage é‡æ–°è®¡ç®—è¯•ç”¨æœŸï¼ˆä»…æµ‹è¯•ç”¨ï¼‰

### Q3: å¦‚ä½•æ·»åŠ çœŸå®çš„åç«¯è®¤è¯ï¼Ÿ

**A:** ä¿®æ”¹ `authStore.ts` ä¸­çš„ `login` å‡½æ•°ï¼š

```typescript
login: async (username: string, password: string) => {
  try {
    // è°ƒç”¨çœŸå®çš„åç«¯ API
    const response = await fetch('https://your-api.com/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password })
    });
    
    const data = await response.json();
    
    if (!data.success) {
      return { success: false, error: data.message };
    }
    
    const user: User = {
      id: data.user.id,
      username: data.user.username,
      email: data.user.email,
      role: data.user.role,
      createdAt: data.user.createdAt,
      expiresAt: data.user.expiresAt
    };
    
    set({
      user,
      token: data.token,
      isAuthenticated: true
    });
    
    return { success: true };
  } catch (error) {
    return { success: false, error: 'ç½‘ç»œé”™è¯¯' };
  }
}
```

### Q4: å¦‚ä½•ç¦ç”¨ç™»å½•åŠŸèƒ½ï¼ˆä¸´æ—¶å¼€å‘ï¼‰ï¼Ÿ

**A:** åœ¨ `App.tsx` ä¸­ä¸´æ—¶æ³¨é‡Šæ‰ `AuthGuard`ï¼š

```tsx
return (
  <ThemeBridge>
    {/* <AuthGuard> */}
      <div className="app-container">
        <FullApp />
        {process.env.NODE_ENV === 'development' && <ThemeToggler />}
      </div>
    {/* </AuthGuard> */}
  </ThemeBridge>
);
```

---

## ğŸ“ˆ åç»­æ‰©å±•

### å¯ä»¥æ·»åŠ çš„åŠŸèƒ½

1. **å¿˜è®°å¯†ç åŠŸèƒ½**
   - é‚®ç®±éªŒè¯
   - é‡ç½®å¯†ç é“¾æ¥

2. **æ³¨å†ŒåŠŸèƒ½**
   - ç”¨æˆ·è‡ªåŠ©æ³¨å†Œ
   - é‚®ç®±éªŒè¯

3. **æƒé™ç®¡ç†**
   - æ›´å¤šè§’è‰²ç±»å‹
   - é¡µé¢çº§æƒé™æ§åˆ¶

4. **ç”¨æˆ·ç®¡ç†ç•Œé¢**
   - ç®¡ç†å‘˜æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·
   - æ‰‹åŠ¨å»¶é•¿è¯•ç”¨æœŸ
   - ç¦ç”¨/å¯ç”¨è´¦æˆ·

5. **å®¡è®¡æ—¥å¿—**
   - ç™»å½•å†å²è®°å½•
   - æ“ä½œæ—¥å¿—è¿½è¸ª

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- `src/stores/authStore.ts` - è®¤è¯é€»è¾‘
- `src/components/auth/AuthGuard.tsx` - è·¯ç”±å®ˆå«
- `src/pages/auth/LoginPageNative.tsx` - ç™»å½•ç•Œé¢

**æç¤º**ï¼šæ‰€æœ‰å…³é”®é€»è¾‘éƒ½æœ‰è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼

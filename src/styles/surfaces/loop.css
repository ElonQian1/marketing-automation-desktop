/* å¾ªç¯å¡ç‰‡ç‹¬ç«‹æ ·å¼åŸºå‡†çº¿ */
/* src/styles/surfaces/loop.css */

/* ===== å¾ªç¯å¡ç‰‡ç®€åŒ–æ ·å¼åŸºå‡† - é¢œè‰²åŒºåˆ†è®¾è®¡ ===== */

.loop-step-card {
  /* å¾ªç¯å¡ç‰‡ä¸“ç”¨é¢œè‰²ä¸»é¢˜ - ç»¿è‰²ç³» */
  --loop-card-bg: #065f46;           /* æ·±ç»¿è‰²èƒŒæ™¯ */
  --loop-card-border: #047857;       /* ç»¿è‰²è¾¹æ¡† */
  --loop-card-text: #ecfdf5;         /* æµ…ç»¿è‰²æ–‡å­— */
  --loop-card-text-secondary: #a7f3d0; /* æ¬¡è¦æ–‡å­— */
  
  /* å¸ƒå±€å˜é‡ */
  --loop-card-radius: 12px;
  --loop-card-padding: 16px;
  --loop-spacing-sm: 8px;
  --loop-spacing-md: 12px;
  
  /* åŸºç¡€æ ·å¼ */
  background: var(--loop-card-bg) !important;
  color: var(--loop-card-text) !important;
  border: 1px solid var(--loop-card-border) !important;
  border-radius: var(--loop-card-radius);
  padding: var(--loop-card-padding);
  margin-bottom: var(--loop-spacing-md);
  min-height: 80px;
  font-size: 14px;
  font-weight: 400;
  line-height: 1.5;
  cursor: grab;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12);
  transition: all 0.2s ease;
  position: relative;
  
  /* æ‹–æ‹½æŒ‡ç¤ºå™¨ */
  &::before {
    content: '';
    position: absolute;
    left: 6px;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    height: 20px;
    background: var(--loop-card-text-secondary);
    border-radius: 2px;
    opacity: 0.5;
  }
}

/* æ‚¬åœæ•ˆæœ */
.loop-step-card:hover {
  background: #047857 !important;
  border-color: #059669 !important;
  box-shadow: 0 2px 8px rgba(5, 150, 105, 0.3);
}

/* æ‰§è¡ŒçŠ¶æ€ */
.loop-step-card.executing {
  border: 2px solid #10b981 !important;
  box-shadow: 0 0 16px rgba(16, 185, 129, 0.4);
  animation: loop-executing-pulse 2s infinite;
}

@keyframes loop-executing-pulse {
  0%, 100% { box-shadow: 0 0 16px rgba(16, 185, 129, 0.4); }
  50% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.6); }
}

/* å¾ªç¯å¼€å§‹å¡ç‰‡ */
.loop-step-card.loop-start {
  border-left: 4px solid #10b981;
}

/* å¾ªç¯ç»“æŸå¡ç‰‡ */
.loop-step-card.loop-end {
  border-left: 4px solid #f59e0b;
}

/* ç¦ç”¨æ‰€æœ‰å¤æ‚çš„Ant Designæ ·å¼ */
.loop-step-card .ant-card-head,
.loop-step-card .ant-card-body,
.loop-step-card .ant-card-extra {
  background: transparent !important;
  border: none !important;
  padding: 0 !important;
}

/* æ–‡å­—é¢œè‰²ç»Ÿä¸€ */
.loop-step-card,
.loop-step-card * {
  color: var(--loop-card-text) !important;
}

/* æ¬¡è¦æ–‡å­— */
.loop-step-card .text-secondary {
  color: var(--loop-card-text-secondary) !important;
}

/* æŒ‰é’®æ ·å¼ç®€åŒ– */
.loop-step-card .ant-btn {
  background: rgba(255, 255, 255, 0.1) !important;
  border-color: rgba(255, 255, 255, 0.2) !important;
  color: var(--loop-card-text) !important;
}

.loop-step-card .ant-btn:hover {
  background: rgba(255, 255, 255, 0.2) !important;
  border-color: rgba(255, 255, 255, 0.3) !important;
}

/* æ ‡ç­¾æ ·å¼ */
.loop-step-card .ant-tag {
  background: rgba(16, 185, 129, 0.2) !important;
  border-color: rgba(16, 185, 129, 0.4) !important;
  color: #ecfdf5 !important;
}

/* å¾ªç¯å¯¹æŒ‡ç¤ºå™¨ */
.loop-pair-indicator {
  position: absolute;
  right: 8px;
  top: 8px;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #10b981;
  opacity: 0.8;
}

.loop-step-card.loop-start .loop-pair-indicator {
  background: #10b981; /* å¼€å§‹ï¼šç»¿è‰² */
}

.loop-step-card.loop-end .loop-pair-indicator {
  background: #f59e0b; /* ç»“æŸï¼šæ©™è‰² */
}

/* ===== å¾ªç¯å¡ç‰‡åŸºç¡€ç»“æ„ ===== */

.loop-step-card {
  background: var(--loop-card-bg) !important;
  border: 1px solid var(--loop-card-border) !important;
  border-radius: var(--loop-card-radius) !important;
  box-shadow: var(--loop-card-shadow) !important;
  margin-bottom: var(--loop-spacing-lg) !important;
  transition: all 0.3s ease !important;
  
  /* å¼ºåˆ¶ç™½åº•é»‘å­—ä¸»é¢˜ */
  color: var(--loop-card-text-primary) !important;
}

/* å¾ªç¯å¡ç‰‡å¤´éƒ¨ */
.loop-step-card .ant-card-head {
  background: var(--loop-header-bg) !important;
  border-bottom: 1px solid var(--loop-card-border) !important;
  color: var(--loop-header-text) !important;
}

.loop-step-card .ant-card-head-title {
  color: var(--loop-header-text) !important;
}

/* å¾ªç¯å¡ç‰‡å›¾æ ‡æ ·å¼ */
.loop-step-card .anticon {
  color: var(--loop-icon-primary) !important;
}

.loop-step-card .ant-card-head .anticon-redo {
  color: var(--loop-icon-primary) !important;
}

/* å¾ªç¯å¡ç‰‡ä¸»ä½“ */
.loop-step-card .ant-card-body {
  background: var(--loop-card-bg) !important;
  color: var(--loop-card-text-primary) !important;
  padding: var(--loop-spacing-lg) !important;
}

/* ===== æ‰§è¡ŒçŠ¶æ€æ ·å¼ ===== */

.loop-step-card.executing {
  border: 2px solid var(--loop-card-border-active) !important;
  box-shadow: var(--loop-card-shadow-active) !important;
  
  /* æ‰§è¡Œæ—¶çš„è„‰å†²åŠ¨ç”» */
  animation: loop-executing-pulse 2s infinite;
}

@keyframes loop-executing-pulse {
  0% {
    box-shadow: var(--loop-card-shadow-active);
  }
  50% {
    box-shadow: 0 4px 16px rgba(24, 144, 255, 0.25);
  }
  100% {
    box-shadow: var(--loop-card-shadow-active);
  }
}

/* ===== æŠ˜å çŠ¶æ€æ ·å¼ ===== */

.loop-step-card.collapsed {
  margin-bottom: var(--loop-spacing-sm) !important;
}

.loop-step-card.collapsed .ant-card-body {
  padding: var(--loop-spacing-sm) var(--loop-spacing-lg) !important;
}

/* ===== å¾ªç¯é…ç½®åŒºåŸŸ ===== */

.loop-config-area {
  background: var(--bg-2, #f9fafb);
  border: 1px solid var(--border-1, #f3f4f6);
  border-radius: var(--radius-1, 6px);
  padding: var(--loop-spacing-md);
  margin-bottom: var(--loop-spacing-md);
  color: var(--loop-card-text-primary) !important;
}

.loop-config-area label {
  color: var(--loop-card-text-secondary) !important;
  font-weight: 500;
  margin-right: var(--loop-spacing-sm);
}

.loop-config-area .ant-typography {
  color: var(--loop-card-text-secondary) !important;
}

/* ===== å¾ªç¯ä½“å®¹å™¨ ===== */

.loop-body-area {
  margin-top: var(--loop-spacing-md);
}

.loop-body-container {
  background: var(--loop-body-bg) !important;
  border: 2px dashed var(--loop-body-border) !important;
  border-radius: var(--loop-card-radius) !important;
  padding: var(--loop-spacing-lg) !important;
  color: var(--loop-body-text) !important;
  min-height: 100px;
  transition: all 0.3s ease;
}

.loop-body-container:hover {
  background: #f0f9e8 !important;
  border-color: #95de64 !important;
}

.loop-body-header {
  margin-bottom: var(--loop-spacing-md);
  font-weight: 600;
  color: var(--loop-body-text) !important;
}

.loop-body-content {
  color: var(--loop-body-text) !important;
}

/* ===== ç©ºå¾ªç¯ä½“çŠ¶æ€ ===== */

.empty-loop-body {
  text-align: center !important;
  padding: var(--loop-spacing-xl) 0 !important;
  color: var(--text-3, #9ca3af) !important;
  font-style: italic;
  border: 2px dashed transparent;
  border-radius: var(--radius-1, 6px);
  transition: all 0.3s ease;
}

.empty-loop-body:hover {
  color: var(--accent-8, #1677ff) !important;
  background: rgba(24, 144, 255, 0.05) !important;
  border-color: rgba(24, 144, 255, 0.2) !important;
}

/* ===== å¾ªç¯å†…æ­¥éª¤æ ·å¼ ===== */

.loop-inner-step {
  background: var(--bg-light-base, #ffffff);
  border: 1px solid var(--border-1, #f3f4f6);
  border-radius: var(--radius-1, 6px);
  padding: var(--loop-spacing-sm) var(--loop-spacing-md);
  margin-bottom: var(--loop-spacing-sm);
  color: var(--loop-card-text-primary) !important;
  position: relative;
  
  /* å·¦ä¾§å¾ªç¯æŒ‡ç¤ºæ¡ */
  border-left: 3px solid var(--accent-6, #69c0ff);
}

.loop-inner-step:last-child {
  margin-bottom: 0;
}

.loop-inner-step .ant-typography {
  color: var(--loop-card-text-primary) !important;
  margin: 0;
}

/* ===== å¾ªç¯çŠ¶æ€æ ‡ç­¾ ===== */

.loop-step-card .ant-tag {
  border: 1px solid;
  font-weight: 500;
}

.loop-step-card .ant-tag.ant-tag-processing {
  background: #e6f7ff !important;
  border-color: #91d5ff !important;
  color: #1890ff !important;
}

.loop-step-card .ant-tag.ant-tag-default {
  background: #f5f5f5 !important;
  border-color: #d9d9d9 !important;
  color: #666666 !important;
}

/* ===== å·¥å…·æ æŒ‰é’®æ ·å¼ ===== */

.loop-step-card .ant-card-extra .ant-btn {
  border: none !important;
  box-shadow: none !important;
  color: var(--loop-card-text-secondary) !important;
}

.loop-step-card .ant-card-extra .ant-btn:hover {
  background: var(--bg-2, #f5f5f5) !important;
  color: var(--loop-card-text-primary) !important;
}

.loop-step-card .ant-card-extra .ant-btn.ant-btn-dangerous {
  color: var(--red-6, #f5222d) !important;
}

.loop-step-card .ant-card-extra .ant-btn.ant-btn-dangerous:hover {
  background: var(--red-1, #fff2f0) !important;
  color: var(--red-7, #cf1322) !important;
}

/* ===== è¡¨å•æ§ä»¶æ ·å¼é‡å†™ ===== */

.loop-step-card .ant-select,
.loop-step-card .ant-input-number {
  color: var(--loop-card-text-primary) !important;
}

.loop-step-card .ant-select-selector {
  background: var(--bg-light-base, #ffffff) !important;
  border-color: var(--loop-card-border) !important;
  color: var(--loop-card-text-primary) !important;
}

.loop-step-card .ant-input-number {
  background: var(--bg-light-base, #ffffff) !important;
  border-color: var(--loop-card-border) !important;
}

/* ğŸ¯ å…³é”®ä¿®å¤ï¼šInputNumber å†…éƒ¨è¾“å…¥æ¡†æ–‡å­—é¢œè‰² */
.loop-step-card .ant-input-number-input {
  color: var(--loop-card-text-primary) !important;
  background: var(--bg-light-base, #ffffff) !important;
}

/* InputNumber å¢å‡æŒ‰é’®æ ·å¼ */
.loop-step-card .ant-input-number-handler-wrap {
  background: var(--bg-light-elevated, #f8fafc) !important;
  border-left: 1px solid var(--loop-card-border) !important;
}

.loop-step-card .ant-input-number-handler {
  color: var(--loop-card-text-primary) !important;
  border-color: var(--loop-card-border) !important;
}

.loop-step-card .ant-input-number-handler:hover:not(.ant-input-number-handler-down-disabled) {
  color: var(--loop-card-border-active, #10b981) !important;
  background: rgba(16, 185, 129, 0.1) !important;
}

.loop-step-card .ant-input-number-handler-down-disabled {
  color: var(--text-muted, #94a3b8) !important;
  cursor: not-allowed !important;
}

.loop-step-card .ant-input-number-handler .anticon {
  color: inherit !important;
}

/* ===== å“åº”å¼è®¾è®¡ ===== */

@media (max-width: 768px) {
  .loop-step-card {
    margin-bottom: var(--loop-spacing-md) !important;
  }
  
  .loop-body-container {
    padding: var(--loop-spacing-md) !important;
  }
  
  .loop-config-area {
    padding: var(--loop-spacing-sm) !important;
  }
}

/* ===== æ·±è‰²ä¸»é¢˜å…¼å®¹ ===== */

.dark .loop-step-card {
  --loop-card-bg: var(--bg-2, #1f2937);
  --loop-card-border: var(--border-2, #374151);
  --loop-card-text-primary: var(--text-1, #f9fafb);
  --loop-card-text-secondary: var(--text-2, #d1d5db);
  --loop-header-bg: var(--bg-3, #111827);
  --loop-header-text: var(--text-1, #f9fafb);
  --loop-body-bg: rgba(34, 197, 94, 0.1);
  --loop-body-border: rgba(34, 197, 94, 0.3);
  --loop-body-text: var(--text-1, #f9fafb);
}

/* ===== æ— éšœç¢æ”¯æŒ ===== */

.loop-step-card:focus-within {
  outline: 2px solid var(--accent-6, #69c0ff);
  outline-offset: 2px;
}

.loop-step-card [role="button"]:focus {
  outline: 2px solid var(--accent-6, #69c0ff);
  outline-offset: 1px;
}

/* ===== æ‰“å°æ ·å¼ ===== */

@media print {
  .loop-step-card {
    break-inside: avoid;
    box-shadow: none !important;
    border: 1px solid #000 !important;
  }
  
  .loop-step-card.executing {
    border: 2px solid #000 !important;
  }
}
/**
 * Universal UI Modal 专属样式
 * 专门处理Modal窗口的显示、背景、层级
 * 使用最高优先级确保不被主应用样式覆盖
 */

/* =============================================================================
   Modal 遮罩和容器
   ============================================================================= */

@layer universal-layout {
  /* Modal 遮罩层 - 最高优先级 */
  .universal-page-finder .ant-modal-mask {
    background: rgba(0, 0, 0, 0.85) !important;
    backdrop-filter: blur(12px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(12px) saturate(180%) !important;
    z-index: var(--uui-z-modal) !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
  }
  
  /* Modal 包装器 */
  .universal-page-finder .ant-modal-wrap {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    z-index: calc(var(--uui-z-modal) + 1) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: var(--uui-space-lg) !important;
    overflow: auto !important;
  }
  
  /* Modal 主容器 */
  .universal-page-finder .ant-modal {
    position: relative !important;
    width: auto !important;
    max-width: 90vw !important;
    margin: 0 !important;
    padding: 0 !important;
    top: auto !important;
    left: auto !important;
    transform: none !important;
    pointer-events: auto !important;
  }
}

/* =============================================================================
   Modal 内容区域
   ============================================================================= */

@layer universal-layout {
  /* Modal 内容容器 - 强制背景可见 */
  .universal-page-finder .ant-modal-content {
    /* 强制设置背景，覆盖任何外部样式 */
    background: var(--uui-gradient-card) !important;
    border: 3px solid var(--uui-border-secondary) !important;
    border-radius: var(--uui-radius-2xl) !important;
    box-shadow: var(--uui-shadow-2xl) !important;
    
    /* 确保容器可见性 */
    position: relative !important;
    overflow: hidden !important;
    opacity: 1 !important;
    visibility: visible !important;
    
    /* 尺寸控制 */
    min-width: 800px !important;
    min-height: 600px !important;
    max-height: 90vh !important;
    width: auto !important;
    
    /* 确保内容不透明 */
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    
    /* 添加内部发光效果 */
    box-shadow: 
      var(--uui-shadow-2xl),
      inset 0 1px 0 rgba(255, 255, 255, 0.1),
      0 0 60px rgba(59, 130, 246, 0.15) !important;
  }
  
  /* 确保Modal内容不被透明化 */
  .universal-page-finder .ant-modal-content::before {
    content: "" !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background: var(--uui-bg-primary) !important;
    opacity: 0.95 !important;
    z-index: -1 !important;
    pointer-events: none !important;
  }
}

/* =============================================================================
   Modal 头部样式
   ============================================================================= */

@layer universal-components {
  .universal-page-finder .ant-modal-header {
    background: var(--uui-bg-secondary) !important;
    border-bottom: 2px solid var(--uui-border-secondary) !important;
    border-radius: var(--uui-radius-2xl) var(--uui-radius-2xl) 0 0 !important;
    padding: var(--uui-space-lg) var(--uui-space-xl) !important;
    position: relative !important;
    z-index: 10 !important;
    
    /* 渐变背景增强 */
    background: linear-gradient(135deg, 
      var(--uui-bg-secondary) 0%, 
      var(--uui-bg-tertiary) 100%) !important;
    
    /* 添加顶部高光 */
    box-shadow: 
      0 1px 0 rgba(255, 255, 255, 0.1) inset,
      0 2px 8px rgba(0, 0, 0, 0.3) !important;
  }
  
  .universal-page-finder .ant-modal-title {
    color: var(--uui-text-primary) !important;
    font-size: 20px !important;
    font-weight: 700 !important;
    margin: 0 !important;
    display: flex !important;
    align-items: center !important;
    gap: var(--uui-space-sm) !important;
    
    /* 文字效果 */
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
    letter-spacing: -0.025em !important;
  }
  
  .universal-page-finder .ant-modal-title .anticon {
    color: var(--uui-accent-blue-light) !important;
    font-size: 24px !important;
    filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.5)) !important;
  }
  
  /* 关闭按钮 */
  .universal-page-finder .ant-modal-close {
    position: absolute !important;
    top: var(--uui-space-md) !important;
    right: var(--uui-space-md) !important;
    width: 44px !important;
    height: 44px !important;
    
    background: var(--uui-bg-tertiary) !important;
    border: 1px solid var(--uui-border-secondary) !important;
    border-radius: var(--uui-radius-lg) !important;
    color: var(--uui-text-muted) !important;
    
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;
    transition: var(--uui-transition-normal) !important;
    
    z-index: 20 !important;
  }
  
  .universal-page-finder .ant-modal-close:hover {
    background: var(--uui-bg-quaternary) !important;
    border-color: var(--uui-border-light) !important;
    color: var(--uui-text-secondary) !important;
    transform: scale(1.05) !important;
    box-shadow: var(--uui-shadow-md) !important;
  }
  
  .universal-page-finder .ant-modal-close .anticon {
    font-size: 18px !important;
    transition: var(--uui-transition-fast) !important;
  }
}

/* =============================================================================
   Modal 主体内容
   ============================================================================= */

@layer universal-layout {
  .universal-page-finder .ant-modal-body {
    background: var(--uui-bg-primary) !important;
    color: var(--uui-text-secondary) !important;
    padding: var(--uui-space-xl) !important;
    
    /* 确保内容区域可见 */
    min-height: 400px !important;
    max-height: calc(90vh - 200px) !important;
    overflow-y: auto !important;
    position: relative !important;
    
    /* 自定义滚动条 */
    scrollbar-width: thin !important;
    scrollbar-color: var(--uui-border-secondary) var(--uui-bg-primary) !important;
  }
  
  .universal-page-finder .ant-modal-body::-webkit-scrollbar {
    width: 8px !important;
    height: 8px !important;
  }
  
  .universal-page-finder .ant-modal-body::-webkit-scrollbar-track {
    background: var(--uui-bg-primary) !important;
    border-radius: var(--uui-radius-sm) !important;
  }
  
  .universal-page-finder .ant-modal-body::-webkit-scrollbar-thumb {
    background: linear-gradient(45deg, 
      var(--uui-border-secondary), 
      var(--uui-border-light)) !important;
    border-radius: var(--uui-radius-sm) !important;
    border: 2px solid var(--uui-bg-primary) !important;
  }
  
  .universal-page-finder .ant-modal-body::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(45deg, 
      var(--uui-border-light), 
      var(--uui-bg-elevated)) !important;
  }
  
  /* 内容间距 */
  .universal-page-finder .ant-modal-body > * {
    margin-bottom: var(--uui-space-md) !important;
  }
  
  .universal-page-finder .ant-modal-body > *:last-child {
    margin-bottom: 0 !important;
  }
}

/* =============================================================================
   Modal 底部样式
   ============================================================================= */

@layer universal-components {
  .universal-page-finder .ant-modal-footer {
    background: linear-gradient(135deg, 
      var(--uui-bg-secondary) 0%, 
      var(--uui-bg-tertiary) 100%) !important;
    border-top: 2px solid var(--uui-border-secondary) !important;
    border-radius: 0 0 var(--uui-radius-2xl) var(--uui-radius-2xl) !important;
    padding: var(--uui-space-lg) var(--uui-space-xl) !important;
    text-align: right !important;
    
    /* 添加底部阴影 */
    box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.3) !important;
  }
  
  .universal-page-finder .ant-modal-footer .ant-btn {
    margin-left: var(--uui-space-sm) !important;
    border-radius: var(--uui-radius-lg) !important;
    padding: var(--uui-space-sm) var(--uui-space-lg) !important;
    height: auto !important;
    font-weight: 600 !important;
    transition: var(--uui-transition-normal) !important;
    min-width: 100px !important;
  }
  
  .universal-page-finder .ant-modal-footer .ant-btn:first-child {
    margin-left: 0 !important;
  }
}

/* =============================================================================
   Modal 动画增强
   ============================================================================= */

@layer universal-themes {
  /* 进入动画 */
  .universal-page-finder.ant-modal-wrap {
    animation: universalModalFadeIn 0.4s cubic-bezier(0.23, 1, 0.32, 1) !important;
  }
  
  .universal-page-finder .ant-modal {
    animation: universalModalSlideIn 0.4s cubic-bezier(0.23, 1, 0.32, 1) !important;
  }
  
  /* 关键帧动画 */
  @keyframes universalModalFadeIn {
    from {
      opacity: 0 !important;
      backdrop-filter: blur(0px) !important;
    }
    to {
      opacity: 1 !important;
      backdrop-filter: blur(12px) !important;
    }
  }
  
  @keyframes universalModalSlideIn {
    from {
      opacity: 0 !important;
      transform: scale(0.8) translateY(-50px) !important;
      filter: blur(4px) !important;
    }
    to {
      opacity: 1 !important;
      transform: scale(1) translateY(0) !important;
      filter: blur(0px) !important;
    }
  }
  
  /* 悬停效果 */
  .universal-page-finder .ant-modal-content:hover {
    box-shadow: 
      var(--uui-shadow-2xl),
      inset 0 1px 0 rgba(255, 255, 255, 0.15),
      0 0 80px rgba(59, 130, 246, 0.2) !important;
    transform: translateY(-2px) !important;
    transition: var(--uui-transition-slow) !important;
  }
}

/* =============================================================================
   Modal 响应式适配
   ============================================================================= */

@layer universal-layout {
  /* 超大屏幕 */
  @media (min-width: 1600px) {
    .universal-page-finder .ant-modal-content {
      min-width: 1000px !important;
      max-width: 1400px !important;
    }
  }
  
  /* 大屏幕 */
  @media (min-width: 1200px) and (max-width: 1599px) {
    .universal-page-finder .ant-modal-content {
      min-width: 900px !important;
      max-width: 1200px !important;
    }
  }
  
  /* 中等屏幕 */
  @media (min-width: 992px) and (max-width: 1199px) {
    .universal-page-finder .ant-modal-content {
      min-width: 800px !important;
      max-width: 90vw !important;
    }
  }
  
  /* 平板 */
  @media (min-width: 768px) and (max-width: 991px) {
    .universal-page-finder .ant-modal-content {
      min-width: 90vw !important;
      max-width: 95vw !important;
      border-radius: var(--uui-radius-xl) !important;
      border-width: 2px !important;
    }
    
    .universal-page-finder .ant-modal-body {
      padding: var(--uui-space-lg) !important;
      min-height: 300px !important;
    }
  }
  
  /* 手机 */
  @media (max-width: 767px) {
    .universal-page-finder .ant-modal-wrap {
      padding: var(--uui-space-sm) !important;
    }
    
    .universal-page-finder .ant-modal-content {
      min-width: calc(100vw - 32px) !important;
      max-width: calc(100vw - 32px) !important;
      min-height: calc(100vh - 64px) !important;
      border-radius: var(--uui-radius-lg) !important;
      border-width: 1px !important;
    }
    
    .universal-page-finder .ant-modal-header {
      padding: var(--uui-space-md) var(--uui-space-lg) !important;
      border-radius: var(--uui-radius-lg) var(--uui-radius-lg) 0 0 !important;
    }
    
    .universal-page-finder .ant-modal-body {
      padding: var(--uui-space-lg) var(--uui-space-md) !important;
      max-height: calc(100vh - 200px) !important;
      min-height: 250px !important;
    }
    
    .universal-page-finder .ant-modal-footer {
      padding: var(--uui-space-md) var(--uui-space-lg) !important;
      border-radius: 0 0 var(--uui-radius-lg) var(--uui-radius-lg) !important;
    }
    
    .universal-page-finder .ant-modal-title {
      font-size: 18px !important;
    }
    
    .universal-page-finder .ant-modal-close {
      width: 36px !important;
      height: 36px !important;
      top: var(--uui-space-sm) !important;
      right: var(--uui-space-sm) !important;
    }
  }
}
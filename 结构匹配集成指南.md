# ç»“æ„åŒ¹é…åŠŸèƒ½é›†æˆæŒ‡å—

## ğŸ“¦ å·²å®Œæˆç»„ä»¶

### æ ¸å¿ƒæ¨¡å—
- âœ… `src/modules/structural-matching/` - å®Œæ•´çš„ç»“æ„åŒ¹é…æ¨¡å—
- âœ… `src/components/step-card/StructuralMatchingIntegration.tsx` - é›†æˆç»„ä»¶
- âœ… `src/components/step-card/structural-matching-manager.tsx` - å…¨å±€ç®¡ç†å™¨

### ActionSelector å¢å¼º
- âœ… é™æ€ç­–ç•¥èœå•æ·»åŠ å­é€‰é¡¹
  - ğŸ—ï¸ ç»“æ„åŒ¹é…
  - ğŸ”§ XPathæ¢å¤

---

## ğŸš€ å¿«é€Ÿé›†æˆç¤ºä¾‹

### æ–¹å¼1: ä½¿ç”¨ Contextï¼ˆæ¨èï¼‰

åœ¨Appæ ¹ç»„ä»¶ä¸­åŒ…è£¹Providerï¼š

```tsx
import { StructuralMatchingProvider } from '@/components/step-card/structural-matching-manager';

function App() {
  return (
    <StructuralMatchingProvider>
      {/* ä½ çš„åº”ç”¨ç»„ä»¶ */}
    </StructuralMatchingProvider>
  );
}
```

åœ¨ActionSelectoræˆ–æ­¥éª¤å¡ç‰‡ä¸­ä½¿ç”¨ï¼š

```tsx
import { useStructuralMatching } from '@/components/step-card/structural-matching-manager';

const { openStructuralMatching } = useStructuralMatching();

// å½“ç”¨æˆ·ç‚¹å‡»"ç»“æ„åŒ¹é…"èœå•é¡¹æ—¶
onClick: () => {
  openStructuralMatching({
    stepId: currentStepId,
    selectedElement: currentSelectedElement,
    initialConfig: stepData.structuralConfig,
    onSave: (config) => {
      // ä¿å­˜é…ç½®åˆ°æ­¥éª¤æ•°æ®
      updateStepData(stepId, {
        ...stepData,
        structuralConfig: config
      });
    }
  });
}
```

### æ–¹å¼2: ç›´æ¥ä½¿ç”¨ç»„ä»¶

```tsx
import { StructuralMatchingIntegration } from '@/components/step-card/StructuralMatchingIntegration';

<StructuralMatchingIntegration
  stepId={step.id}
  selectedElement={selectedElement}
  initialConfig={step.structuralConfig}
  onSave={(config) => {
    updateStep(step.id, { structuralConfig: config });
  }}
  showTriggerButton={true}
  triggerButtonText="ğŸ—ï¸ é…ç½®ç»“æ„åŒ¹é…"
/>
```

---

## ğŸ”§ åœ¨ActionSelectorä¸­çš„é›†æˆç‚¹

æ–‡ä»¶ï¼š`src/components/step-card/ActionSelector.tsx`

### å½“å‰çŠ¶æ€
ç¬¬637-639è¡Œå·²æ·»åŠ ç»“æ„åŒ¹é…å­èœå•é¡¹ï¼š

```tsx
children: [
  { key: 'structural_matching', label: 'ç»“æ„åŒ¹é…', icon: 'ğŸ—ï¸', desc: 'åŸºäºå…ƒç´ ç»“æ„ç›¸ä¼¼åº¦åŒ¹é…' },
  { key: 'xpath_recovery', label: 'XPathæ¢å¤', icon: 'ğŸ”§', desc: 'æ™ºèƒ½æ¢å¤æŸåçš„XPath' },
]
```

### éœ€è¦æ·»åŠ çš„ä»£ç 

åœ¨ç¬¬668è¡Œï¼ˆ`onClick: () => {`ï¼‰æ·»åŠ é€»è¾‘ï¼š

```tsx
onClick: () => {
  if (sub.key === 'structural_matching') {
    // éœ€è¦ä»çˆ¶ç»„ä»¶ä¼ å…¥çš„æ•°æ®
    const { stepId, selectedElement, structuralConfig, onUpdateConfig } = props;
    
    openStructuralMatching({
      stepId,
      selectedElement,
      initialConfig: structuralConfig,
      onSave: onUpdateConfig
    });
  } else if (sub.key === 'xpath_recovery') {
    // XPathæ¢å¤é€»è¾‘ï¼ˆæš‚æœªå®ç°ï¼‰
    console.log('XPathæ¢å¤åŠŸèƒ½å¼€å‘ä¸­');
  }
}
```

---

## ğŸ“ æ­¥éª¤æ•°æ®ç»“æ„æ‰©å±•

éœ€è¦åœ¨æ­¥éª¤æ•°æ®ä¸­æ·»åŠ  `structuralConfig` å­—æ®µï¼š

```typescript
interface StepData {
  // ... ç°æœ‰å­—æ®µ
  
  /**
   * ç»“æ„åŒ¹é…é…ç½®ï¼ˆå¯é€‰ï¼‰
   */
  structuralConfig?: StructuralMatchingConfig;
}
```

---

## ğŸ¯ æ‰§è¡Œæµç¨‹

1. **é…ç½®é˜¶æ®µ**
   - ç”¨æˆ·é€‰ä¸­å…ƒç´ 
   - ç‚¹å‡»"é™æ€ç­–ç•¥ â†’ ç»“æ„åŒ¹é…"
   - é…ç½®å­—æ®µæƒé‡ã€åŒ¹é…æ¨¡å¼ã€é˜ˆå€¼
   - ä¿å­˜åˆ°æ­¥éª¤æ•°æ®

2. **æ‰§è¡Œé˜¶æ®µ**
   - æ‰§è¡Œå¼•æ“æ£€æµ‹åˆ° `structuralConfig` å­˜åœ¨
   - è°ƒç”¨åç«¯Tauriå‘½ä»¤ `evaluate_structural_match`
   - ä¼ å…¥é…ç½®å’Œå€™é€‰å…ƒç´ åˆ—è¡¨
   - åç«¯è®¡ç®—æ¯ä¸ªå…ƒç´ çš„ç»“æ„ç›¸ä¼¼åº¦å¾—åˆ†
   - è¿”å›å¾—åˆ† â‰¥ é˜ˆå€¼çš„å…ƒç´ 

---

## âš¡ ä¸‹ä¸€æ­¥TODO

### é«˜ä¼˜å…ˆçº§
1. âœ… ActionSelectoræ·»åŠ propsï¼š`stepId`, `selectedElement`, `structuralConfig`, `onUpdateConfig`
2. âœ… åœ¨ActionSelectorä¸­é›†æˆ `useStructuralMatching` Hook
3. â³ åˆ›å»ºTauriå‘½ä»¤ `evaluate_structural_match`
4. â³ åœ¨æ‰§è¡Œå¼•æ“ä¸­æ·»åŠ ç»“æ„åŒ¹é…åˆ†æ”¯é€»è¾‘

### ä¸­ä¼˜å…ˆçº§
5. â³ æ·»åŠ é…ç½®é¢„è®¾æ¨¡æ¿ï¼ˆç¬”è®°å¡ç‰‡ã€è§†é¢‘å¡ç‰‡ã€ç›´æ’­å¡ç‰‡ï¼‰
6. â³ å®ç°é…ç½®çš„å¯¼å…¥å¯¼å‡º
7. â³ æ·»åŠ å†å²é…ç½®è®°å½•

### ä½ä¼˜å…ˆçº§
8. â³ ä¼˜åŒ–UIäº¤äº’ä½“éªŒ
9. â³ æ·»åŠ æ›´å¤šè¯„åˆ†è§„åˆ™é€‰é¡¹
10. â³ å›½é™…åŒ–æ”¯æŒ

---

## ğŸ§ª æµ‹è¯•æ¸…å•

- [ ] æ‰“å¼€ç»“æ„åŒ¹é…æ¨¡æ€æ¡†
- [ ] è°ƒæ•´å­—æ®µæƒé‡å’ŒåŒ¹é…æ¨¡å¼
- [ ] å®æ—¶é¢„è§ˆè¯„åˆ†å˜åŒ–
- [ ] ä¿å­˜é…ç½®åˆ°æ­¥éª¤æ•°æ®
- [ ] é‡æ–°æ‰“å¼€æ¨¡æ€æ¡†ï¼Œé…ç½®æ­£ç¡®åŠ è½½
- [ ] æ‰§è¡Œæ­¥éª¤æ—¶ä½¿ç”¨ç»“æ„åŒ¹é…
- [ ] å°çº¢ä¹¦ç¬”è®°å¡ç‰‡å®é™…æµ‹è¯•

---

**å½“å‰è¿›åº¦**: 40% (å‰ç«¯å®Œæˆï¼Œåç«¯Tauriå‘½ä»¤å¾…å®ç°ï¼Œæ‰§è¡Œé›†æˆå¾…å®Œæˆ)

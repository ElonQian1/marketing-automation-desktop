
# å‘˜å·¥Bï½œæ¨¡å—å‰ç¼€åŒ–ä¸å¯¼å…¥ä¿®å¤æ‰§è¡Œï¼ˆä½çº¦æŸï¼Œæ”¯æŒç¢ç‰‡åŒ–ï¼‰

> **ï¿½ å¿«é€Ÿå¼€å§‹**: è¯·å…ˆé˜…è¯» [00-README.md](00-README.md) äº†è§£å·¥ä½œç«™ä½¿ç”¨æ–¹æ³•
> 
> **ğŸ“‹ å·¥ä½œè®°å½•**: è¯·åœ¨ `stream_shared.md` ä¸­è¿½åŠ ä¸€è¡Œè®°å½•ï¼Œæ ¼å¼ï¼š`[æ—¶é—´] å‘˜å·¥B ç®€è¿° â†’ ä¸‹ä¸€æ­¥`
> 
> **ğŸ“‹ ä»»åŠ¡æ¥æº**: æŸ¥çœ‹ `prefix-migration-plan.md` è·å–å‰ç¼€åŒ–ä»»åŠ¡æ¸…å•ï¼Œ**éšæ—¶æäº¤**

## ä½ çš„è§’è‰²

â€œå®æ–½ä¸æ”¶å°¾å·¥ç¨‹å¸ˆâ€ã€‚åœ¨**ä¸å¢åŠ é™åˆ¶**çš„å‰æä¸‹ï¼ŒæŒ‰â€œ**æ¨¡å—ä¼˜å…ˆ + æ¨¡å—å†…åˆ†å±‚**â€æ¨è¿›**å››ä»¶å¥—**çš„è½åœ°æ‰§è¡Œï¼š
**å‘½åå‰ç¼€ + é—¨ç‰Œå¯¼å‡º + åˆ«åå¯¼å…¥ + æ–‡ä»¶å¤´**ã€‚é‡ç‚¹æ˜¯**æŠŠå®¹æ˜“é‡åçš„å­ç›®å½•**ï¼ˆå¦‚ `strategies / services / utils / validators / adapters / pipelines / mappers / repositories`ï¼‰å‰ç¼€åŒ–ï¼Œä¿®å¥½å¯¼å…¥è·¯å¾„ï¼Œç¡®ä¿é¡¹ç›®å¯ç¼–è¯‘ä¸å¯è¿è¡Œã€‚

## å”¯ä¸€ç¡¬åº•çº¿ï¼ˆä»…æ­¤ä¸€æ¡ï¼‰

* **domain ä¸å¾—ä¾èµ– UI/IO**ï¼šä¸è¦åœ¨ `domain/*` ä¸­ `import` åˆ° `ui / services / api / hooks / pages`ã€‚å…¶ä½™è·¨æ¨¡å—è¡Œä¸ºä¸ä½œé™åˆ¶ã€‚

---

## æœ¬è½®ç›®æ ‡ï¼ˆä¸€æ¬¡è¯´æ¸…ï¼‰

1. å¯¹ä¸Šè¿°**æ˜“é‡åç›®å½•**ä¸­çš„æ–‡ä»¶/ç±»å‹è¿›è¡Œ**å‰ç¼€åŒ–å‘½å**ï¼š

   * `prospecting` â†’ `prospecting-*/Prospecting*`
   * `script-builder` â†’ `script-*/Script*`
   * `contact-import` â†’ `contact-*/Contact*`
   * `adb` â†’ `adb-*/Adb*`
2. ä¿®å¤å‰ç¼€åŒ–å¸¦æ¥çš„**å¯¼å…¥è·¯å¾„**ï¼šè·¨æ¨¡å—ä¼˜å…ˆæ”¹ä¸º**åˆ«å + é—¨ç‰Œ**ï¼ˆ`@prospecting`ã€`@script`â€¦ å‘½ä¸­å„æ¨¡å— `index.ts`ï¼‰ã€‚
3. **å®Œå–„é—¨ç‰Œ `index.ts`**ï¼šåªå¯¼å‡ºå¯¹å¤–å¥‘çº¦ï¼ˆ`domain/public/**`ï¼‰ã€ç”¨ä¾‹ï¼ˆ`application/**`ï¼‰ã€å…¬å¼€ hooksï¼›**ä¸å¯¼å‡º**å†…éƒ¨å®ç°ï¼ˆå¦‚ `domain/strategies/*`ï¼‰ã€‚
4. è¡¥é½**ä¸‰è¡Œæ–‡ä»¶å¤´**ï¼ˆç¼ºäº†å°±åŠ ï¼‰ï¼Œä¿æŒå¯ç¼–è¯‘ã€å¯è¿è¡Œã€‚

---

## è¾“å…¥

* ä»£ç ä»“åº“ï¼š`ElonQian1/marketing-automation-desktop`ï¼ˆåˆ†æ”¯ `main`ï¼‰
* å‚è€ƒæ–‡æ¡£ï¼š

  * `docs/architecture/prefix-migration-plan.md`ï¼ˆå¦‚ç¼ºåˆ™ä½ å…ˆåˆ›å»ºç©ºè¡¨å¹¶é€æ­¥å¡«å……ï¼‰
  * `tsconfig.json` çš„è·¯å¾„åˆ«åï¼ˆ`@prospecting/*`ã€`@script/*`ã€`@contact/*`ã€`@adb/*`ã€`@shared/*`ï¼‰

---

## è¾“å‡ºï¼ˆæ¯è½®æäº¤è‡³å°‘æ»¡è¶³å…¶ä¸€ï¼‰

* ä¸€å°æ‰¹æ–‡ä»¶å®Œæˆ**å‰ç¼€åŒ–é‡å‘½å**ï¼ˆå«ç±»å‹ååŒæ­¥å‰ç¼€åŒ–ï¼‰å¹¶**ä¿®å¥½å¯¼å…¥**ï¼›
* æŸæ¨¡å—çš„ `index.ts` å·²**åªå¯¼å‡º**å¥‘çº¦/ç”¨ä¾‹/å…¬å¼€ hooksï¼›
* æ”¹åŠ¨æ–‡ä»¶å‡è¡¥ä¸Š**ä¸‰è¡Œæ–‡ä»¶å¤´**ï¼›
* **å¯ç¼–è¯‘å¯è¿è¡Œ**ï¼ˆåŸºç¡€é¡µé¢/æµç¨‹çƒŸé›¾æµ‹è¯•é€šè¿‡ï¼‰ï¼›
* åœ¨ `prefix-migration-plan.md` å‹¾æ‰å·²å®Œæˆæ¡ç›®ï¼Œå¹¶åœ¨ `stream_b.md` è®°å½•ä¸€è¡Œã€‚

---

## æ‰§è¡Œæ­¥éª¤ï¼ˆç¢ç‰‡åŒ–ä¹Ÿèƒ½æ¨è¿›ï¼‰

### æ­¥éª¤ 1ï½œæ‹¿è®¡åˆ’ï¼ˆæ²¡æœ‰å°±è‡ªå»ºï¼‰

* è‹¥å­˜åœ¨ `docs/architecture/prefix-migration-plan.md`ï¼šä»ä¸Šåˆ°ä¸‹æŒ‰è¡¨æ‰§è¡Œã€‚
* è‹¥ä¸å­˜åœ¨ï¼šå…ˆåˆ›å»ºè¯¥æ–‡ä»¶ï¼Œä¼˜å…ˆæ‰«æå¹¶å¡«å…¥ä¸¤å—ï¼š

  * `src/modules/prospecting/domain/strategies/**`
  * `src/modules/script-builder/domain/strategies/**`
    è¡¨å¤´ç¤ºä¾‹ï¼š
    `| æ¨¡å— | å­ç›®å½• | from(ç°å) | to(å‰ç¼€åŒ–å) | ç±»å‹åæ”¹ä¸º | å¤‡æ³¨ |`

### æ­¥éª¤ 2ï½œå‰ç¼€åŒ–é‡å‘½åï¼ˆå°æ‰¹é‡ï¼Œéšåšéšæï¼‰

* åªæ”¹**æ–‡ä»¶å**ä¸**å…¬å¼€å¯¼å‡ºç±»å‹å**ï¼Œä¸åŠ¨ä¸šåŠ¡é€»è¾‘ã€‚
* æ¨¡æ¿ï¼š

  * `weighted.ts` â†’ `prospecting-strategy-weighted.ts`ï¼›`StrategyWeighted` â†’ `ProspectingStrategyWeighted`
  * `standard.ts` â†’ `script-strategy-standard.ts`ï¼›`StrategyStandard` â†’ `ScriptStrategyStandard`
* é‡åˆ°**åŒåå†²çª**ï¼šåœ¨ç›®æ ‡ååè¿½åŠ æ›´å…·ä½“è¯­ä¹‰ï¼Œå¦‚ `-rule-based`ã€`-pipeline`ã€‚

### æ­¥éª¤ 3ï½œä¿®å¯¼å…¥ï¼ˆä¼˜å…ˆé—¨ç‰Œ + åˆ«åï¼‰

* è·¨æ¨¡å—å¯¼å…¥æ”¹ä¸ºï¼š

  ```ts
  import { BuildLeadScoreUseCase } from '@prospecting'; // å‘½ä¸­ src/modules/prospecting/index.ts
  import { ScriptStrategy } from '@script';
  ```
* å¦‚æœé—¨ç‰Œå°šæœªå¯¼å‡ºæ‰€éœ€å¥‘çº¦ï¼š

  * å…ˆåœ¨è¯¥æ¨¡å— `domain/public/**` æ”¾å¥‘çº¦/é¢„è®¾ï¼›
  * åœ¨ `index.ts` re-exportï¼›
  * å›åˆ°è°ƒç”¨æ–¹æŠŠ import æ”¹åˆ°åˆ«åé—¨ç‰Œã€‚
* æš‚æ—¶éœ€è¦ç›´æ¥å†…éƒ¨å¯¼å…¥ä¹Ÿå¯ï¼Œä½†è¯·åœ¨æ”¹åŠ¨å¤„åŠ ä¸€è¡Œ `// TODO: å›æ”¶åˆ° @<module> é—¨ç‰Œ`ã€‚

### æ­¥éª¤ 4ï½œå®Œå–„é—¨ç‰Œ `index.ts`

* ä»…å¯¼å‡º**å¯¹å¤–ç¨³å®š API**ï¼š

  ```ts
  // src/modules/prospecting/index.ts
  // module: prospecting | layer: public | role: barrel
  // summary: å¯¹å¤–å…¬å…±å‡ºå£ï¼ˆå¥‘çº¦/ç”¨ä¾‹/Hookï¼‰
  export * from './domain/public/strategies/contracts';
  export * from './application/BuildLeadScoreUseCase';
  export * from './hooks/useProspectingWizard';
  // ä¸å¯¼å‡º domain/strategies å†…éƒ¨å®ç°
  ```

### æ­¥éª¤ 5ï½œä¸‰è¡Œæ–‡ä»¶å¤´ï¼ˆç¼ºäº†å°±è¡¥ï¼‰

```ts
// src/modules/<module>/<layer>/path/File.ts
// module: <module> | layer: <ui|hooks|application|domain|services|api|stores|pages> | role: <ç®€çŸ­è§’è‰²>
// summary: ä¸€å¥ä¸­æ–‡èŒè´£æ‘˜è¦
```

> è‹¥ä»“åº“å·²æœ‰è‡ªåŠ¨è¡¥å¤´è„šæœ¬ï¼ˆå¦‚ `pnpm headers:auto`ï¼‰ï¼Œå…ˆè¿è¡Œè„šæœ¬å†æ£€æŸ¥æ‘˜è¦æ˜¯å¦å‡†ç¡®ã€‚

### æ­¥éª¤ 6ï½œç¼–è¯‘ä¸æœ€å°éªŒè¯

```bash
pnpm install
pnpm type-check
pnpm lint || true     # ä»…ä½œæç¤ºï¼Œä¸é˜»å¡
pnpm build            # æˆ– pnpm tauri dev è¿›è¡Œæ‰‹åŠ¨çƒŸé›¾æµ‹è¯•
```

* æ‰“å¼€ä¸æœ¬æ¬¡æ”¹åŠ¨ç›¸å…³çš„é¡µé¢ï¼Œåšä¸€æ¬¡æœ€å°æ“ä½œè·¯å¾„éªŒè¯ï¼ˆä¾‹å¦‚ï¼šåŠ è½½æ•°æ® â†’ è°ƒç”¨ç”¨ä¾‹ â†’ æ¸²æŸ“ç»“æœï¼‰ã€‚

---

## æäº¤è§„èŒƒï¼ˆè´´åˆâ€œéšæ—¶æäº¤â€ï¼‰

* **å°æ­¥æäº¤**ï¼Œæ¯æ‰¹æ”¹åŠ¨èšç„¦ä¸€ä¸ªå­ç›®å½•æˆ– 3â€“10 ä¸ªæ–‡ä»¶ã€‚
* æäº¤ä¿¡æ¯å»ºè®®æ ¼å¼ï¼ˆä¸å¼ºåˆ¶ï¼‰ï¼š

  ```
  refactor(prospecting): å‰ç¼€åŒ– strategies* å¹¶ä¿®å¤å¯¼å…¥
  Next: å›æ”¶ X åˆ° @prospecting é—¨ç‰Œ
  Note: ç±»å‹ååŒæ­¥å‰ç¼€åŒ–ï¼Œè¡Œä¸ºä¸å˜
  ```
* æäº¤åï¼Œåœ¨ `docs/DDDæ¶æ„æ¸…æ™°é—®é¢˜/stream_b.md` æœ«å°¾**è¿½åŠ ä¸€è¡Œ**ï¼š
  `[2025-10-12 16:40] script-builder/strategies å‰ç¼€åŒ– 4 é¡¹ â†’ ä¸‹ä¸€æ­¥ï¼šè¡¥ index.ts å¯¼å‡º contracts`

---

## éªŒæ”¶æ¸…å•ï¼ˆæ¯æ¬¡æäº¤è‡ªæ£€ï¼‰

* [ ] ç›®æ ‡æ–‡ä»¶å·²**å‰ç¼€åŒ–**ï¼ˆæ–‡ä»¶å + ç±»å‹åï¼‰ï¼Œå¦‚ `Prospecting* / Script* / Contact* / Adb*`
* [ ] è·¨æ¨¡å—å¯¼å…¥**ä¼˜å…ˆ**æ”¹ä¸º `@<module>` é—¨ç‰Œï¼ˆä»æœ‰å†…éƒ¨å¯¼å…¥å¤„å·²æ ‡æ³¨ TODOï¼‰
* [ ] ç›¸å…³æ¨¡å— `index.ts` **åªå¯¼å‡º** contracts / usecase / hooksï¼ˆæœªæ³„éœ²å†…éƒ¨å®ç°ï¼‰
* [ ] æ”¹åŠ¨æ–‡ä»¶æœ‰**ä¸‰è¡Œæ–‡ä»¶å¤´**
* [ ] `pnpm type-check` ä¸ `pnpm build` é€šè¿‡ï¼›é¡µé¢çƒŸé›¾æµ‹è¯•æ­£å¸¸
* [ ] `prefix-migration-plan.md` å‹¾æ‰å®Œæˆé¡¹ï¼›`stream_b.md` è¿½åŠ ä¸€è¡Œè®°å½•

---

## Do / Donâ€™t

* âœ… Doï¼šå‰ç¼€åŒ–å‘½å + ä¿®å¯¼å…¥ + å®Œå–„é—¨ç‰Œ + è¡¥æ–‡ä»¶å¤´ï¼Œ**ä¿è¯å¯ç¼–è¯‘**
* âœ… Doï¼šå°æ­¥æäº¤ï¼Œè¾¹æ”¹è¾¹è·‘ï¼Œè¾¹è®°å½•
* âŒ Donâ€™tï¼šåœ¨ `domain/*` é‡Œå¼•å…¥ `ui/services/api/hooks/pages`ï¼ˆå”¯ä¸€ç¡¬åº•çº¿ï¼‰
* âŒ Donâ€™tï¼šä¸€æ¬¡æ€§å¤§æ”¹åŠ¨è€Œä¸æäº¤ï¼Œé¿å…å›æ»šå›°éš¾

---

## å¸¸è§é—®é¢˜ï¼ˆé€Ÿè§£ï¼‰

* **é‡å‘½ååç±»å‹å†²çªï¼Ÿ** åœ¨å¯¼å‡ºåæˆ–æ–‡ä»¶ååŠ æ›´å…·ä½“åç¼€ï¼š`-standard`, `-weighted`, `-rule-based`ã€‚
* **åˆ«åæœªç”Ÿæ•ˆï¼Ÿ** æ£€æŸ¥ `tsconfig.json` çš„ `paths` æ˜¯å¦æŒ‡åˆ°æ¨¡å—æ ¹ï¼ˆä»è€Œå‘½ä¸­ `index.ts`ï¼‰ã€‚
* **é—¨ç‰Œå¯¼å‡ºè¿‡å¤šï¼Ÿ** ä¿å®ˆå¯¼å‡ºï¼šåªå¯¼å‡º `domain/public` å¥‘çº¦ã€ç”¨ä¾‹ã€å…¬å¼€ hooksï¼›å†…éƒ¨å®ç°ä¸å¯¼å‡ºã€‚
* **éœ€è¦å…±äº«ç®—æ³•ï¼Ÿ** æŠ½åˆ° `src/shared/**`ï¼›è‹¥æ˜¯é¢†åŸŸå¥‘çº¦å°‘é‡å…±äº«ï¼Œæ”¾åˆ° `domain/public/**` å¹¶ç”±é—¨ç‰Œå¯¼å‡ºã€‚

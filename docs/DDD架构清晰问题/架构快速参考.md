# 🚀 DDD架构快速参考

> **开发时的速查卡片**，详细说明请看 [架构导航指南](架构导航指南.md)

## 📁 代码应该放在哪里？

| 代码类型 | 放置位置 | 示例 |
|---------|----------|------|
| 业务实体、规则 | `domain/` | Device.ts, ConnectionRule.ts |
| 状态管理、用例 | `application/` | useAdb.ts, adbStore.ts |
| API调用、外部服务 | `infrastructure/` | TauriAdbRepository.ts |
| UI组件、页面 | `components/` | DeviceList.tsx, AdbPage.tsx |
| 通用工具、类型 | `shared/` | dateUtils.ts, CommonTypes.ts |

## 🎯 ADB统一接口 (必须使用)

```typescript
// ✅ 正确使用方式
const { 
  devices,           // 设备列表
  selectedDevice,    // 当前选中设备
  selectDevice,      // 选择设备
  refreshDevices     // 刷新设备列表
} = useAdb();

// ❌ 已废弃，不要使用
const devices = useAdbDevices();      // 已废弃
const diagnostic = useAdbDiagnostic(); // 已废弃
```

## 🔄 模块导入规范

```typescript
// ✅ 推荐：使用别名导入模块门牌
import { SomeService } from '@/modules/adb';
import { ContactType } from '@/modules/contact-import';

// ⚠️ 临时允许：直接相对路径 (后续会整理)
import { HelperFunc } from '../utils/helper';

// ❌ 禁止：跨层级直接导入内部实现
import { privateFunc } from '@/modules/adb/internal/private';
```

## 🚨 硬性约束 (违反必须修复)

1. **Domain层不依赖UI/IO**: 
   - ❌ `domain/` 中不能 import `components/`、`hooks/`、`api/`
   - ✅ `domain/` 只能依赖其他 `domain/` 和 `shared/`

2. **使用统一ADB接口**:
   - ❌ 不能创建新的设备状态管理
   - ✅ 必须通过 `useAdb()` 访问设备功能

## 📊 当前架构状态

- **架构完成度**: ✅ DDD分层已建立  
- **ADB统一度**: ✅ 统一接口广泛使用
- **模块化进度**: 🔄 前缀化迁移进行中
- **代码质量**: ⚠️ ESLint错误修复中

## 🆘 遇到问题怎么办？

| 问题类型 | 解决方案 | 记录位置 |
|---------|----------|----------|
| 不知道代码放哪里 | 参考上面的分层表格 | `stream_x.md` |
| ADB功能不工作 | 检查是否使用 `useAdb()` | `stream_x.md` |
| 模块导入报错 | 检查路径别名配置 | `stream_x.md` |
| 架构设计疑问 | 查看架构导航指南 | `_ACTIVE/URGENT_*.md` |

## 📝 日常工作流程

1. **开始工作**: 更新 `_ACTIVE/员工X_当前状态.md`
2. **遇到问题**: 在 `_STREAMS/stream_x.md` 追加记录
3. **完成功能**: 遵循分层规范，使用统一接口
4. **提交代码**: 更新状态文档，记录进展

---
**💡 记住**: 有疑问先查导航指南，紧急问题在URGENT文档中讨论！
# 🎨 高级功能 UI 位置说明

## 📍 UI 在哪里？

### 1. **入口位置**
当您在脚本编辑器中选择动作类型为 **`smartSelection`（智能选择）** 时，会自动显示高级功能配置区。

```
脚本编辑器
  └── 步骤卡片
      └── ActionSelector 组件
          └── 动作类型选择
              ├── click（点击）
              ├── input（输入）
              ├── swipe（滑动）
              └── ✅ smartSelection（智能选择） ← 选这个！
                  ↓
                  显示智能选择配置面板
                  ├── 模式选择（manual/auto/skip）
                  ├── 基础配置（目标文本、置信度）
                  ├── 必填字段（容器XPath、多语言别名）
                  └── 🔥 高级功能（新）← UI 在这里！
                      ├── 🚫 排除：[已关注|Following|已互关]
                      ├── 🔄 去重：[10] px
                      └── ✅ 轻校验：[开启/关闭]
```

---

## 🖼️ 可视化布局

```
┌─────────────────────────────────────────────────────┐
│  步骤卡片 - 智能选择动作                              │
├─────────────────────────────────────────────────────┤
│                                                      │
│  动作类型: [smartSelection ▼]                        │
│                                                      │
│  ┌─ 选择策略 ─────────────────────────────────┐     │
│  │ 模式: [manual ▼]  📌 手动选择一个           │     │
│  └────────────────────────────────────────────┘     │
│                                                      │
│  ┌─ 基础配置 ─────────────────────────────────┐     │
│  │ 目标文本: [关注]  置信度: [0.8]              │     │
│  └────────────────────────────────────────────┘     │
│                                                      │
│  ┌─ 必填字段 ─────────────────────────────────┐     │
│  │ 容器XPath: [//RecyclerView]                 │     │
│  │ 多语言别名: [关注|Follow|フォロー]           │     │
│  └────────────────────────────────────────────┘     │
│                                                      │
│  ┌─ 🔥 高级功能（新）──────────────────────────┐  ← 这里！
│  │                                              │     │
│  │  🚫 排除: [已关注|Following|已互关________]  │     │
│  │                                              │     │
│  │  🔄 去重: [10] px  （位置容差）              │     │
│  │                                              │     │
│  │  ✅ 轻校验: [开启 ▼]  （点击后验证状态变化） │     │
│  │                                              │     │
│  └────────────────────────────────────────────┘     │
│                                                      │
│  💡 推荐：Manual 模式适合单次操作，Auto 适合批量   │
│                                                      │
└─────────────────────────────────────────────────────┘
```

---

## 🎯 如何看到这个 UI？

### 方法 1：启动开发服务器（推荐）

```bash
# 在项目根目录执行
pnpm tauri dev
```

### 方法 2：分步操作

**步骤 1**: 打开应用
- 启动后会显示主界面

**步骤 2**: 进入脚本编辑器
- 点击左侧菜单 "脚本管理" 或 "智能脚本"
- 创建新脚本 或 编辑现有脚本

**步骤 3**: 添加智能选择动作
- 点击 "添加步骤"
- 在动作类型下拉框中选择 **`smartSelection`**

**步骤 4**: 查看高级功能
- 向下滚动配置面板
- 在"必填字段"下方会看到 **🔥 高级功能（新）** 区域
- 包含 3 个配置项：排除、去重、轻校验

---

## 📸 UI 特征识别

### 视觉标识
- **背景色**: 淡蓝色 `rgba(110, 139, 255, 0.05)`
- **边框**: 蓝色虚线 `1px dashed rgba(110, 139, 255, 0.3)`
- **标题**: 🔥 高级功能（新） - 蓝色加粗字体

### 三个配置项
| 图标 | 标签 | 控件类型 | 默认值 |
|-----|------|---------|--------|
| 🚫 | 排除 | Input 输入框 | 空（占位符：已关注\|Following\|已互关） |
| 🔄 | 去重 | InputNumber 数字输入 | 10 px |
| ✅ | 轻校验 | Select 下拉选择 | 开启 |

---

## 🔍 代码位置

**文件**: `src/components/step-card/ActionSelector.tsx`  
**行数**: 第 310-370 行  
**条件渲染**: 仅当 `params.actionType === 'smartSelection'` 时显示

### 关键代码片段
```tsx
{params.actionType === 'smartSelection' && (
  <div style={{
    marginTop: '8px',
    padding: '8px',
    background: 'rgba(110, 139, 255, 0.05)',
    borderRadius: '4px',
    border: '1px dashed rgba(110, 139, 255, 0.3)'
  }}>
    <div style={{ fontSize: '12px', fontWeight: 'bold', marginBottom: '6px', color: '#6E8BFF' }}>
      🔥 高级功能（新）
    </div>
    
    {/* 排除模式 */}
    <Input placeholder="已关注|Following|已互关" />
    
    {/* 去重容差 */}
    <InputNumber min={5} max={50} addonAfter="px" />
    
    {/* 轻校验开关 */}
    <Select options={[{value: true, label: '开启'}, ...]} />
  </div>
)}
```

---

## ⚡ 快速验证

### 检查 UI 是否正确渲染

**浏览器控制台执行**:
```javascript
// 检查高级功能区域是否存在
document.querySelectorAll('[style*="rgba(110, 139, 255, 0.05)"]').length
// 应返回 1（表示找到高级功能区域）

// 检查排除输入框
document.querySelector('input[placeholder*="已关注"]')
// 应返回 Input 元素

// 检查去重 InputNumber
document.querySelector('input[placeholder="容差"]')
// 应返回 InputNumber 的 input 元素
```

---

## 🐛 如果看不到 UI？

### 可能原因与解决方法

| 问题 | 原因 | 解决方法 |
|-----|------|---------|
| UI 不显示 | 未选择 smartSelection 动作类型 | 在动作类型下拉框选择 "smartSelection" |
| 配置面板很短 | 面板未展开 | 点击步骤卡片展开配置 |
| 页面空白 | 组件渲染错误 | 打开浏览器控制台查看报错 |
| TypeScript 错误 | 类型定义问题 | 已修复，拉取最新代码 |

### 调试步骤
```bash
# 1. 清理缓存
pnpm clean
rm -rf node_modules/.vite

# 2. 重新安装依赖
pnpm install

# 3. 重启开发服务器
pnpm tauri dev

# 4. 打开浏览器控制台
按 F12 → Console 标签 → 查看是否有报错
```

---

## 📝 功能测试快速指南

### 测试排除过滤
1. 在 **🚫 排除** 输入框输入：`已关注`
2. 保存脚本
3. 刷新页面，重新打开脚本
4. 验证：输入框仍显示 `已关注`（持久化成功）

### 测试去重容差
1. 将 **🔄 去重** 数值改为 `15`
2. 使用上下箭头调整
3. 尝试输入 `3`（应被拒绝，最小值 5）
4. 尝试输入 `100`（应被拒绝，最大值 50）

### 测试轻校验开关
1. 点击 **✅ 轻校验** 下拉框
2. 选择 "关闭"
3. 保存脚本
4. 重新打开，验证状态为 "关闭"

---

## 🎬 录屏演示（待添加）

TODO: 录制 GIF 动图展示：
1. 打开脚本编辑器
2. 选择 smartSelection 动作类型
3. 滚动到高级功能区域
4. 配置三个选项
5. 保存并验证

---

**文档版本**: v1.0  
**最后更新**: 2025-10-25  
**维护人**: AI 架构护栏工程师

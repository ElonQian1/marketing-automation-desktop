# æ‰¹é‡å…¨éƒ¨åŠŸèƒ½æµ‹è¯•æŒ‡å—

## ğŸ¯ æµ‹è¯•ç›®æ ‡

éªŒè¯ **"æ™ºèƒ½è‡ªåŠ¨é“¾ + æ‰¹é‡å…¨éƒ¨"** èƒ½å¦æ­£ç¡®æ‰§è¡Œæ‰¹é‡ç‚¹å‡»æ‰€æœ‰å…³æ³¨æŒ‰é’®ã€‚

---

## ğŸ“‹ æµ‹è¯•æ­¥éª¤

### 1ï¸âƒ£ **æ‰“å¼€å¼€å‘è€…å·¥å…·**

æŒ‰ `F12` æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹ Console æ—¥å¿—ã€‚

### 2ï¸âƒ£ **é€‰æ‹©é…ç½®**

åœ¨æ­¥éª¤å¡ç‰‡çš„ç­–ç•¥èœå•ä¸­ï¼š
1. **æ‰§è¡Œé“¾**: é€‰æ‹© `ğŸ§  æ™ºèƒ½è‡ªåŠ¨é“¾`
2. **é€‰æ‹©æ¨¡å¼**: é€‰æ‹© `ğŸ“‹ æ‰¹é‡å…¨éƒ¨`
3. **æ‰¹é‡é…ç½®**: 
   - é—´éš”æ—¶é—´: 2000ms
   - æœ€å¤§æ•°é‡: 10

### 3ï¸âƒ£ **æ£€æŸ¥å‰ç«¯ä¿å­˜æ—¥å¿—**

**åº”è¯¥ç«‹å³çœ‹åˆ°**ä»¥ä¸‹æ—¥å¿—ï¼ˆåœ¨é€‰æ‹©"æ‰¹é‡å…¨éƒ¨"åï¼‰ï¼š

```javascript
âœ… æ­£ç¡®çš„æ—¥å¿—ï¼š
ğŸ” [CompactStrategyMenu] autoSaveConfig è°ƒç”¨: { 
  stepId: "step_1761384262983", 
  mode: "all", 
  hasStepId: true, 
  batchConfig: {...} 
}
ğŸ“¤ [CompactStrategyMenu] å‡†å¤‡è°ƒç”¨åç«¯ä¿å­˜: {...}
âœ… [CompactStrategyMenu] è‡ªåŠ¨ä¿å­˜é…ç½®æˆåŠŸ: {...}
```

```javascript
âŒ é”™è¯¯çš„æ—¥å¿—ï¼ˆè¯´æ˜ä¿å­˜å¤±è´¥ï¼‰ï¼š
âš ï¸ [CompactStrategyMenu] æ— stepIdï¼Œè·³è¿‡ä¿å­˜
// æˆ–
âŒ [CompactStrategyMenu] ä¿å­˜é…ç½®å¤±è´¥: ...
```

**åŒæ—¶åº”è¯¥çœ‹åˆ°æˆåŠŸæç¤º**ï¼š
```
âœ… å·²ä¿å­˜æ™ºèƒ½é€‰æ‹©é…ç½®: all
```

### 4ï¸âƒ£ **æ£€æŸ¥åç«¯ä¿å­˜æ—¥å¿—**

åœ¨ Console ä¸­æœç´¢ `save_smart_selection_config`ï¼Œ**åº”è¯¥çœ‹åˆ°**ï¼š

```log
âœ… æ­£ç¡®çš„æ—¥å¿—ï¼š
ğŸ“¥ [save_smart_selection_config] æ”¶åˆ°ä¿å­˜è¯·æ±‚: step_id=step_1761384262983, mode=all, batch_config=Some({...})
âœ… ä¿å­˜æ™ºèƒ½é€‰æ‹©é…ç½®æˆåŠŸ: step_id=step_1761384262983, mode=all, batch_config=Some({...}), store_size=1
```

```log
âŒ é”™è¯¯çš„æ—¥å¿—ï¼ˆè¯´æ˜åç«¯æ²¡æ”¶åˆ°è°ƒç”¨ï¼‰ï¼š
ï¼ˆå®Œå…¨æ²¡æœ‰ save_smart_selection_config ç›¸å…³æ—¥å¿—ï¼‰
```

### 5ï¸âƒ£ **æ‰§è¡Œæ­¥éª¤**

ç‚¹å‡»æ­¥éª¤å¡ç‰‡çš„ â–¶ï¸ æ’­æ”¾æŒ‰é’®ã€‚

### 6ï¸âƒ£ **æ£€æŸ¥æ‰§è¡Œæ—¥å¿—**

æœç´¢ `é€šè¿‡StoreæŸ¥è¯¢`ï¼Œ**åº”è¯¥çœ‹åˆ°**ï¼š

```log
âœ… æ­£ç¡®çš„æ‰§è¡Œæµç¨‹ï¼š
ğŸ” é€šè¿‡StoreæŸ¥è¯¢é€‰æ‹©å™¨: step_1761384262983
âœ… Storeå‘½ä¸­ç­–ç•¥å€™é€‰  â† å…³é”®ï¼è¯´æ˜æ‰¾åˆ°äº†é…ç½®
ğŸ¯ ä½¿ç”¨æ™ºèƒ½é€‰æ‹©å¼•æ“
ğŸ“‹ æ‰§è¡Œæ‰¹é‡ç­–ç•¥ - å€™é€‰æ•°: 7
ç‚¹å‡»å…ƒç´  1/7: bounds=[...]
ç­‰å¾… 2000ms
ç‚¹å‡»å…ƒç´  2/7: bounds=[...]
ç­‰å¾… 2000ms
...
```

```log
âŒ é”™è¯¯çš„æ‰§è¡Œæµç¨‹ï¼ˆè¯´æ˜é…ç½®æœªä¿å­˜ï¼‰ï¼š
ğŸ” é€šè¿‡StoreæŸ¥è¯¢é€‰æ‹©å™¨: step_1761384262983
âš ï¸ Storeæœªæ‰¾åˆ°ç­–ç•¥: step_1761384262983  â† é—®é¢˜ï¼
ğŸ¯ å¯ç”¨åæ ‡å…œåº•æ¨¡å¼
æ‰§è¡Œåæ ‡: (875, 1770)  â† åªç‚¹ä¸€ä¸ªä½ç½®
```

---

## ğŸ” é—®é¢˜è¯Šæ–­

### é—®é¢˜1: å‰ç«¯æ²¡æœ‰è°ƒç”¨ä¿å­˜

**ç—‡çŠ¶**ï¼š
- Console ä¸­æ²¡æœ‰ `autoSaveConfig è°ƒç”¨` æ—¥å¿—
- æ²¡æœ‰çœ‹åˆ° `âœ… å·²ä¿å­˜æ™ºèƒ½é€‰æ‹©é…ç½®` æç¤º

**åŸå› **ï¼š
- `stepId` ä¸ºç©º
- `handleSelectionModeClick` æ²¡æœ‰æ­£ç¡®è°ƒç”¨ `await autoSaveConfig()`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```typescript
// æ£€æŸ¥ CompactStrategyMenu ç»„ä»¶
console.log('ğŸ” stepId:', stepId);  // ç¡®è®¤ stepId ä¸ä¸ºç©º

// æ£€æŸ¥ handleSelectionModeClick æ˜¯å¦æ˜¯ async
const handleSelectionModeClick = async ({ key }: { key: string }) => {
  // ... 
  await autoSaveConfig('all');  // å¿…é¡»æœ‰ await
};
```

### é—®é¢˜2: åç«¯æ²¡æœ‰æ”¶åˆ°ä¿å­˜è¯·æ±‚

**ç—‡çŠ¶**ï¼š
- å‰ç«¯æœ‰ `ğŸ“¤ å‡†å¤‡è°ƒç”¨åç«¯ä¿å­˜` æ—¥å¿—
- ä½†åç«¯æ²¡æœ‰ `ğŸ“¥ æ”¶åˆ°ä¿å­˜è¯·æ±‚` æ—¥å¿—

**åŸå› **ï¼š
- å‘½ä»¤åç§°é”™è¯¯
- å‘½ä»¤æœªåœ¨ `main.rs` ä¸­æ³¨å†Œ
- Tauri ç‰ˆæœ¬ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**ï¼š
```rust
// æ£€æŸ¥ main.rs
.invoke_handler(tauri::generate_handler![
    save_smart_selection_config,  // ç¡®è®¤å·²æ³¨å†Œ
    // ...
])
```

### é—®é¢˜3: ä¿å­˜æˆåŠŸä½†æ‰§è¡Œæ—¶æ‰¾ä¸åˆ°

**ç—‡çŠ¶**ï¼š
- å‰ç«¯å’Œåç«¯éƒ½æœ‰ä¿å­˜æˆåŠŸçš„æ—¥å¿—
- ä½†æ‰§è¡Œæ—¶ `âš ï¸ Storeæœªæ‰¾åˆ°ç­–ç•¥`

**åŸå› **ï¼š
- ä¿å­˜çš„ `step_id` å’Œæ‰§è¡Œæ—¶çš„ `step_id` ä¸ä¸€è‡´
- Store è¢«æ¸…ç©ºäº†

**è§£å†³æ–¹æ¡ˆ**ï¼š
```log
// å¯¹æ¯”æ—¥å¿—ä¸­çš„ step_id
ä¿å­˜æ—¶: step_id=step_1761384262983
æ‰§è¡Œæ—¶: step_id=step_1761384262983  â† å¿…é¡»å®Œå…¨ä¸€è‡´ï¼
```

---

## âœ… æˆåŠŸæ ‡å‡†

### å®Œæ•´çš„æˆåŠŸæ—¥å¿—é“¾æ¡

```log
1. é€‰æ‹©"æ‰¹é‡å…¨éƒ¨"
   â†’ ğŸ” [CompactStrategyMenu] autoSaveConfig è°ƒç”¨
   â†’ ğŸ“¤ å‡†å¤‡è°ƒç”¨åç«¯ä¿å­˜
   
2. åç«¯ä¿å­˜
   â†’ ğŸ“¥ [save_smart_selection_config] æ”¶åˆ°ä¿å­˜è¯·æ±‚
   â†’ âœ… ä¿å­˜æ™ºèƒ½é€‰æ‹©é…ç½®æˆåŠŸ: store_size=1
   
3. å‰ç«¯ä¿å­˜å®Œæˆ
   â†’ âœ… [CompactStrategyMenu] è‡ªåŠ¨ä¿å­˜é…ç½®æˆåŠŸ
   â†’ ç”¨æˆ·çœ‹åˆ°: âœ… å·²ä¿å­˜æ™ºèƒ½é€‰æ‹©é…ç½®: all
   
4. ç‚¹å‡»æ’­æ”¾æŒ‰é’®
   â†’ ğŸ” é€šè¿‡StoreæŸ¥è¯¢é€‰æ‹©å™¨: step_xxx
   â†’ âœ… Storeå‘½ä¸­ç­–ç•¥å€™é€‰
   â†’ ğŸ¯ ä½¿ç”¨æ™ºèƒ½é€‰æ‹©å¼•æ“
   â†’ ğŸ“‹ æ‰§è¡Œæ‰¹é‡ç­–ç•¥ - å€™é€‰æ•°: 7
   
5. æ‰¹é‡æ‰§è¡Œ
   â†’ ç‚¹å‡»å…ƒç´  1/7: bounds=[786,1733,965,1806]
   â†’ ç­‰å¾… 2000ms
   â†’ ç‚¹å‡»å…ƒç´  2/7: bounds=[786,1544,965,1617]
   â†’ ç­‰å¾… 2000ms
   â†’ ...
   â†’ âœ… æ‰¹é‡æ‰§è¡Œå®Œæˆ: æˆåŠŸ 7/7
```

---

## ğŸ› è°ƒè¯•å‘½ä»¤

### æŸ¥çœ‹å½“å‰ Store å†…å®¹

åœ¨å‰ç«¯ Console æ‰§è¡Œï¼š

```javascript
// æŸ¥è¯¢ç‰¹å®šæ­¥éª¤çš„ç­–ç•¥
const { invoke } = await import('@tauri-apps/api/core');
const strategy = await invoke('get_step_strategy', { stepId: 'step_1761384262983' });
console.log('Storeä¸­çš„ç­–ç•¥:', strategy);
```

### æ‰‹åŠ¨ä¿å­˜é…ç½®

```javascript
const { invoke } = await import('@tauri-apps/api/core');
await invoke('save_smart_selection_config', {
  stepId: 'step_1761384262983',
  selectionMode: 'all',
  batchConfig: {
    interval_ms: 2000,
    max_count: 10,
    jitter_ms: 500,
    continue_on_error: true,
    show_progress: true
  }
});
console.log('âœ… æ‰‹åŠ¨ä¿å­˜æˆåŠŸ');
```

### æ¸…é™¤é…ç½®

```javascript
const { invoke } = await import('@tauri-apps/api/core');
await invoke('clear_step_strategy', { stepId: 'step_1761384262983' });
console.log('âœ… é…ç½®å·²æ¸…é™¤');
```

---

## ğŸ“ æ€»ç»“

**å…³é”®æ£€æŸ¥ç‚¹**ï¼š
1. âœ… stepId ä¸ä¸ºç©º
2. âœ… å‰ç«¯æˆåŠŸè°ƒç”¨ `save_smart_selection_config`
3. âœ… åç«¯æ”¶åˆ°ä¿å­˜è¯·æ±‚å¹¶æˆåŠŸä¿å­˜
4. âœ… Store ä¸­èƒ½æŸ¥è¯¢åˆ°ç­–ç•¥
5. âœ… æ‰§è¡Œæ—¶ä¸è§¦å‘åæ ‡å…œåº•
6. âœ… çœŸæœºä¸Šç‚¹å‡»äº†æ‰€æœ‰å…³æ³¨æŒ‰é’®

**å¦‚æœè¿˜æ˜¯å¤±è´¥**ï¼š
1. æˆªå›¾æ—¥å¿—å‘ç»™æˆ‘
2. æä¾› `step_id` çš„å€¼
3. è¯´æ˜åœ¨å“ªä¸€æ­¥å¤±è´¥äº†

# 简化循环卡片使用指南

## 设计理念

新的循环卡片采用简洁设计，通过颜色区分与普通步骤卡片，支持成对显示（开始+结束）。

## 样式对比

### 普通步骤卡片
- **背景**: 深蓝灰色 `#1E293B`
- **文字**: 浅色 `#F8FAFC`
- **边框**: 灰色 `#334155`

### 循环卡片（新设计）
- **背景**: 深绿色 `#065f46`
- **文字**: 浅绿色 `#ecfdf5`
- **边框**: 绿色 `#047857`
- **左边框条**: 开始=绿色 `#10b981`，结束=橙色 `#f59e0b`

## 使用方法

### 基础用法

```tsx
import { SimpleLoopCard } from '@modules/loop-control';

// 循环开始卡片
<SimpleLoopCard
  loopId="loop_001"
  type="start"
  name="获客循环"
  iterations={5}
  executing={false}
  onDelete={() => console.log('删除循环')}
  onConfig={() => console.log('配置循环')}
  onTest={() => console.log('测试循环')}
/>

// 循环结束卡片
<SimpleLoopCard
  loopId="loop_001"
  type="end"
  name="获客循环"
  onDelete={() => console.log('删除循环')}
/>
```

### 成对显示示例

```tsx
function LoopPairExample() {
  const loopId = "loop_001";
  const loopName = "自动获客流程";
  
  return (
    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
      {/* 循环开始 */}
      <SimpleLoopCard
        loopId={loopId}
        type="start"
        name={loopName}
        iterations={10}
        currentIteration={3}
        executing={true}
        onDelete={() => handleDeleteLoop(loopId)}
        onConfig={() => handleConfigLoop(loopId)}
        onTest={() => handleTestLoop(loopId)}
      />
      
      {/* 中间的步骤卡片（普通步骤） */}
      <div style={{ marginLeft: '20px' }}>
        {/* 这里放置普通的步骤卡片 */}
        <DraggableStepCard step={step1} />
        <DraggableStepCard step={step2} />
        <DraggableStepCard step={step3} />
      </div>
      
      {/* 循环结束 */}
      <SimpleLoopCard
        loopId={loopId}
        type="end"
        name={loopName}
        onDelete={() => handleDeleteLoop(loopId)}
      />
    </div>
  );
}
```

## 视觉特点

### 颜色指示器
- **右上角圆点**: 
  - 开始卡片: 绿色 🟢
  - 结束卡片: 橙色 🟠

### 左边框条
- **开始卡片**: 绿色粗边框 (`border-left: 4px solid #10b981`)
- **结束卡片**: 橙色粗边框 (`border-left: 4px solid #f59e0b`)

### 图标区分
- **开始卡片**: 🔄 循环图标
- **结束卡片**: 🏁 结束图标

### 执行状态
- **执行中**: 绿色发光边框 + 脉冲动画
- **进度显示**: "执行中 (3/10)" 格式

## 与普通卡片的集成

```tsx
function ScriptStepsList({ steps, loops }) {
  return (
    <div className="steps-container">
      {steps.map((step, index) => {
        // 检查是否是循环开始
        if (step.step_type === 'loop_start') {
          const loop = loops.find(l => l.id === step.loop_id);
          return (
            <SimpleLoopCard
              key={step.id}
              loopId={step.loop_id}
              type="start"
              name={loop?.name || '未命名循环'}
              iterations={loop?.iterations}
              executing={loop?.executing}
              {...loopHandlers}
            />
          );
        }
        
        // 检查是否是循环结束
        if (step.step_type === 'loop_end') {
          const loop = loops.find(l => l.id === step.loop_id);
          return (
            <SimpleLoopCard
              key={step.id}
              loopId={step.loop_id}
              type="end"
              name={loop?.name || '未命名循环'}
              {...loopHandlers}
            />
          );
        }
        
        // 普通步骤卡片
        return (
          <DraggableStepCard
            key={step.id}
            step={step}
            {...stepHandlers}
          />
        );
      })}
    </div>
  );
}
```

## 优势

1. **简洁明了**: 去除复杂的Ant Design组件，专注核心功能
2. **颜色区分**: 绿色主题与蓝灰色普通卡片形成鲜明对比
3. **成对识别**: 通过图标和边框颜色清晰标识开始/结束
4. **状态清晰**: 执行状态通过发光效果和进度文字直观显示
5. **操作集中**: 主要操作按钮集中在开始卡片，结束卡片保持简洁

## 注意事项

1. **拖拽支持**: 保留了拖拽指示器（左侧灰条）
2. **响应式**: 支持小屏幕设备
3. **主题兼容**: 基于CSS变量，支持主题切换
4. **可扩展**: 预留了扩展接口，可根据需要添加功能
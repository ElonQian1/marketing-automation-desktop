# 新成员入门｜精准获客 Tauri 项目（合规三步法版）

> 给刚加入的同学的一份“从 0 到 1”说明：我们在做什么、为什么这样做、有哪些红线、系统怎么分、怎么验收，以及你今天需要完成的事情。

---

## 1. 我们在做什么（一句话）

做一套 **Tauri 桌面程序**，帮助运营团队以**合规方式**完成：
**候选池构建 → 拉取评论 → 生成任务（回复/关注）→ 执行与签收 → 日报导出**，全程带**查重/频控/审计**。

**不做**：全网爬取、绕过反爬、对未授权账号/视频的 API 操作、采集敏感隐私数据。

---

## 2. 背景与目标

* **业务目标**：精准获客与运营提效，减少人工找评论、手动回复的时间，沉淀日报与审计。
* **技术目标**：形成可复用的**任务与风控内核**，不同数据来源只需更换“适配器”。

**成功标准（MVP）**：

* 能导入 ≥10 个候选视频/账号并定时拉最新评论；
* 关键词/时间/地域筛选后，自动生成待处理任务；
* 支持 **API 优先/半自动兜底** 的执行；
* 每日导出 **关注清单**、**回复清单**；
* 查重/频控默认开启，审计可追溯。

---

## 3. 合规边界（“三轨”）

我们严格区分三种来源，确保合规：

1. **抖音 OpenAPI（自然内容）**：仅对**我方已授权账号**名下内容的互动做拉取/回复。
2. **巨量引擎 Marketing API（广告内容）**：对**广告资产**（advertiser_id 下计划/创意）产生的评论做管理与报表。
3. **自定义“合规采集”**：仅限**公开且允许抓取**的白名单页面/数据源；遵守 robots.txt；禁止登录、绕反爬与敏感数据采集。

> 规则：**自然内容→抖音**；**广告内容→巨量**；其余仅在“公开+允许”前提下使用白名单采集；无法确认允许则不用。

**红线**（一律不做）：

* 全站关键词批量抓取、绕反爬；
* 未授权账号/视频的 API 操作（回复/关注等）；
* 采集/存储个人敏感信息；
* 规避风控（高频同文刷屏等）。

---

## 4. 合规三步法（统一业务骨架）

**① 候选池（账号/视频） → ② 评论拉取 → ③ 任务生成/执行/签收**

* **候选池**：来源于人工添加、CSV 导入、合规榜单、或广告系统回流的资产；打上行业/地域标签。
* **评论拉取**：

  * 抖音：授权账号下视频的最新评论；
  * 巨量：广告计划/创意下评论；
  * 白名单：仅公开且允许抓取的评论页。
* **任务生成**：按关键词/时间窗/地域/互动阈值筛选评论 → 生成 **回复/关注** 任务；
* **执行策略**：**API 优先**；无权限/不开放能力→**半自动跳转**到视频/作者页，由运营点击发送/关注；
* **签收**：执行后变更任务状态，写**审计日志**，纳入**日报**。

---

## 5. 系统架构（“本地 Tauri + 轻云中台”）

* **Tauri 桌面端**：UI、任务队列、查重/频控、导出、加密存储；与中台通过 HTTPS/WebSocket 同步。
* **轻云中台**：Webhook Relay（接收平台回调）、Token 刷新与托管、Douyin/巨量/Whitelist **适配器**聚合、缓冲队列。
* **数据存储**：本地 SQLite（任务/评论/日报/审计）；云端仅存必要的令牌与队列状态（多机协作时使用）。

> 设计原则：**“适配器可插拔，内核不改”**。来源不同，只更换适配器实现，任务与风控内核保持一致。

---

## 6. 核心模块与职责

* **账号与设备管理**：账号（open_id/advertiser_id、scope、上限）、设备/人位映射；
* **候选池**：账号/视频对象的增删改查与导入，来源/行业/地域标签；
* **评论采集**：三轨适配器统一输出结构；
* **任务引擎**：状态机（NEW→READY→EXECUTING→DONE/FAILED）、分配策略、签收；
* **查重/频控**：评论级与用户级去重、账号/视频触达上限、随机抖动；
* **话术与审核**：模板变量、敏感词策略（block/review）、人审兜底；
* **日报与审计**：关注清单、回复清单导出；全链路留痕（谁/何时/哪个账号/命中何规则/结果）。

---

## 7. 数据与报表（核心字段）

* **关注清单**：关注日期、关注账号ID。
* **回复清单**：日期、视频链接、评论账户ID、评论内容、回复账号ID、回复内容。
* **审计日志**：任务ID、规则命中、执行器（API/人工）、结果码、重试次数、操作者与时间。

---

## 8. 风控策略（上线即默认开启）

* **频控**：每账号 小时/日 上限，最小间隔随机（示例：时≤20、日≤150、间隔 90–180s）；
* **查重**：

  * 评论级：`sha1(platform + comment_id)`；
  * 用户级：同用户 N 天不重复触达（示例 7 天）；
  * 跨设备：开启，避免撞单；
* **黑/白名单**：敏感词/禁触达场景直接拦截；
* **熔断**：连续错误码超阈值 → 熔断该账号并转移任务；通知运营介入。

---

## 9. 角色分工与里程碑（RACI）

* **PM**：需求/合规/验收（R/A）
* **后端（中台）**：Webhook/适配器/令牌托管（R）
* **客户端（Tauri）**：UI/任务/风控/导出（R）
* **测试**：用例/回归/数据正确性（R/C）
* **运营代表**：词库/模板/候选池/白名单维护（C/I）

**里程碑**：

* Phase 0：合规与权限准备
* Phase 1：骨架（候选池/任务/查重/频控/日报）
* Phase 2：数据源接入（抖音/巨量/白名单）
* Phase 3：任务闭环与操作台（API 优先/半自动兜底）
* Phase 4：风控与稳定性（熔断、黑白名单、多机协作）

---

## 10. 第一日待办（新人 Checklist）

1. 阅读并签署：《三轨边界与禁止项》；
2. 了解《白名单数据源清单》，不明确允许则默认不采；
3. 补全三张 CSV：行业关键词≥20、敏感词≥30、回复模板≥10；
4. 在候选池模板 CSV 中添加≥10 个对象；
5. 过一遍演示脚本：导入→拉评论（可模拟）→筛选→生成任务→执行 3 条→导出两张日报→查看审计。

---

## 11. 术语表（便于沟通）

* **候选池**：将被监控/拉取评论的账号或视频集合；
* **设备/账号**：执行任务的运营位与其绑定的对外账号；
* **半自动跳转**：无开放 API 的动作，通过打开目标页面并预填话术，交由运营点击完成；
* **适配器**：对接不同来源（抖音/巨量/白名单）的统一接口模块。

---

## 12. FAQ（高频问题）

* **为什么不用“全站关键词抓取”？** 高风险且常被禁止；我们把“关键词”放在**评论筛选**层，效果上等价且合规。
* **能否自动关注？** 视平台是否开放该能力与我们是否拥有权限；否则走半自动。
* **是否必须有中台？** Tauri 本地不方便收 Webhook 与托管多账号令牌，中台能降复杂度并提升安全性。

---

## 13. 后续“分轮讲解”路线图（每轮 30–45 分钟）

* **Round 1｜合规与三轨**：边界、红线、案例；
* **Round 2｜候选池与数据模型**：字段、导入规范、标签体系；
* **Round 3｜任务队列与查重频控**：状态机、策略、配置；
* **Round 4｜执行策略**：API 与半自动、话术与敏感词；
* **Round 5｜日报与审计**：导出格式、对账与稽核；
* **Round 6｜风控与熔断**：阈值、错误码、告警与恢复；
* **Round 7｜接口接入计划**：抖音/巨量/白名单顺序与回调；
* **Round 8｜演示与验收**：端到端走查、缺陷清单与关闭标准。

---

## 14. 你现在要做的事（复述）

* 在词库/模板/候选池三张 CSV 里补数据；
* 按演示脚本跑通一次闭环；
* 若发现任何与“红线”冲突的需求，**不要实现**，第一时间升级讨论。

> 欢迎你加入！这份文档是你的“导航图”。每轮讲解我们都会回到相应小节，对照本页逐项过一遍。

---

# Round 1｜合规与三轨（讲义 + 脚本）

> 目标：让新成员在 30–45 分钟内，清楚我们**做什么/不做什么**、**三轨来源**的边界、**红线与替代方案**、以及**落地决策树**。

## 1. 我们在做什么 / 不做什么

**做什么**：搭建一套“合规三步法”的获客运营系统：**候选池 → 评论拉取 → 任务（回复/关注）→ 签收 → 日报**，默认**查重/频控/审计**。

**不做**：全站关键词批抓、绕过反爬、未授权账号/视频的 API 操作、采集敏感隐私数据、批量同文高频刷屏。

---

## 2. 三轨来源（严格区分）

1. **抖音 OpenAPI（自然内容）**：

   * 适用：我方 **已授权账号** 下的视频/图文/直播互动。
   * 能力：拉评论、（权限到位时）API 回复、粉丝/关系数据等。
   * 不能：操作未授权账号/视频；“全站搜索”抓取。

2. **巨量引擎 Marketing API（广告内容）**：

   * 适用：广告资产（`advertiser_id` 下的计划/单元/创意）产生的评论与报表。
   * 能力：广告评论拉取/回复/隐藏、投放数据。
   * 不能：自然内容的评论管理。

3. **自定义“合规采集”（Public Whitelist）**：

   * 前提：**公开且允许抓取**（遵守 robots.txt / 条款）；不可登录、不可绕反爬、不可采敏感信息。
   * 用途：补齐候选池或公开评论**最后一层**的线索。

> 口诀：**自然→抖音**；**广告→巨量**；其余仅在“公开+允许”前提下用**白名单**采集；拿不准就不用。

---

## 3. 红线与替代方案

* **红线**：

  * ❌ 全站关键词批量抓取 / 绕反爬；
  * ❌ 未授权账号/视频的 API 操作；
  * ❌ 采集/存储个人敏感信息；
  * ❌ 批量同文高频发送（规避风控）。
* **替代方案**：

  * ✅ 用 **候选池 + 评论筛选** 替代“全站关键词抓取”；
  * ✅ API 不开放的动作走 **半自动跳转 + 人工确认**；
  * ✅ 只使用 **白名单**公开来源；无依据的不采。

---

## 4. 合规三步法（统一骨架）

1. **候选池**：账号/视频清单（人工/CSV/榜单/广告回流），打行业与地域标签。
2. **评论拉取**：对候选对象拉最新评论（按三轨选择适配器）。
3. **任务生成**：关键词/时间窗/地域/互动阈值 → 生成 **回复/关注** 任务；

   * **执行策略**：API 优先；无权限→半自动跳转；
   * **签收**：写审计、入日报（关注清单/回复清单）。

---

## 5. 决策树（运行时）

1. 来自广告？→ **巨量 API**；
2. 来自我方授权自然账号？→ **抖音 API**；
3. 公开且允许抓取的白名单页面？→ **Whitelist 采集**；
4. 否→ **人工 CSV 导入**（仍可进入评论筛选与任务体系）。

---

## 6. 典型情景对照

* **情景 A：自家账号视频下的评论** → 抖音 API 拉取 → 关键词命中 → 生成“回复任务”。
* **情景 B：投放素材的评论** → 巨量 API 拉取 → 运营挑选 → 生成“回复/隐藏任务”。
* **情景 C：行业榜单上的公开视频** → 加入候选池（白名单来源）→ 拉评论（若允许）→ 筛选入队。

---

## 7. 风控默认开启（强制）

* **频控**：小时/日上限、最小间隔随机；
* **查重**：评论级（`sha1(platform+comment_id)`）+ 用户级（7 天窗口）+ 跨设备；
* **黑/白名单**：敏感词拦截、禁触达场景；
* **熔断**：错误码超阈值→熔断该账号并转移任务。

---

## 8. 讲解脚本（30–45 分钟）

1. 5′：项目一句话 + 成功标准（MVP）。
2. 10′：三轨来源（各举 1 个业务例子）。
3. 10′：红线与替代方案（演示“全站抓取”为什么不可，如何用候选池+筛选替代）。
4. 10′：合规三步法流程图 + 决策树走一遍。
5. 5′：Q&A（把灰区问题收集到“白名单清单”待评估）。

---

## 9. 快速练习（当场 5′）

**判断题（自然/广告/白名单/不可）**：

1. “我们投放的创意下的评论” → **广告**（巨量）。
2. “对手公司账号下的评论（未授权）” → **不可**（默认不用；可人工加入候选池，仅做评论筛选，禁止 API 操作）。
3. “某公开话题页（robots 允许）” → **白名单**（需在清单中登记）。
4. “自家账号视频评论” → **自然**（抖音）。

---

## 10. 新人当日待办

* 阅读并签署《三轨边界与禁止项》；
* 在《白名单数据源清单》中添加 1–2 个**明确允许**的来源（拿不准就留空）；
* 在 3 张 CSV 里各补 ≥5 条（行业词、敏感词、模板）；
* 在候选池模板中添加 ≥5 个对象；
* 按演示脚本跑一次端到端闭环（可用模拟数据）。

---

> Round 1 结束后，进入 **Round 2｜候选池与数据模型**（字段、导入规范、标签体系、更新节奏与责任分工）。

Ran terminal command: adb devices

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe devices

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell cmd -l | findstr content

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell content query --uri content://com.android.contacts/contacts --projection _id | findstr Row | Measure-Object -Line

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell "content query --uri content://com.android.contacts/data --projection 'contact_id:data1:mimetype' --where \"mimetype='vnd.android.cursor.item/phone_v2'\" | head -5"

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell "content query --uri content://com.android.contacts/data --projection 'contact_id,data1,mimetype' --where \"mimetype='vnd.android.cursor.item/phone_v2'\" | head -5"

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell "content query --uri content://com.android.contacts/data --projection contact_id --projection data1 --projection mimetype --where \"mimetype='vnd.android.cursor.item/phone_v2'\" | head -5"

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell "content query --uri content://com.android.contacts/data --where \"mimetype='vnd.android.cursor.item/phone_v2'\" | head -3"

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell "content query --uri content://com.android.contacts/contacts | head -3"

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell "content query --uri content://com.android.contacts/contacts --projection _id --projection display_name | head -5"

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell "content query --uri content://com.android.contacts/data --projection contact_id --projection data1 --where \"mimetype LIKE '%phone%'\" | head -5"

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell "content query --uri content://com.android.contacts/data --projection contact_id --projection data1 | head -10"

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell "content query --uri content://com.android.contacts/data --projection contact_id --projection data1 --projection mimetype | head -15"

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell dumpsys contacts | head -20

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell dumpsys package com.android.providers.contacts | head -10

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell pm list packages | findstr contact

Ran terminal command: D:\rust\active-projects\小红书\employeeGUI\platform-tools\adb.exe shell pm list packages | findstr -i contact

## 📱 **ADB联系人查询测试结果总结**

根据实际测试，你的设备（AHXVCP3526428590）对不同查询方式的支持情况如下：

---

### ✅ **支持的方式**

#### 1. **基础content查询** - 完全支持
```bash
# ✅ 联系人基本信息查询
content query --uri content://com.android.contacts/contacts --projection display_name
```
**结果**：成功获取联系人姓名列表（联系人1, 联系人2, 联系人3, 联系人4）

#### 2. **数据表查询** - 部分支持  
```bash
# ✅ 获取联系人数据（包含手机号）
content query --uri content://com.android.contacts/data --projection contact_id --projection data1
```
**结果**：成功获取混合数据（姓名和手机号码）
- 发现手机号：17743110605, 15272746516, 15580509467, 15296791112

#### 3. **数据类型区分** - 基础支持
```bash
# ✅ 可以查看mimetype字段
content query --uri content://com.android.contacts/data --projection mimetype
```
**结果**：识别出两种类型：
- `vnd.android.cursor.item/name` (姓名)
- `vnd.android.cursor.item/phone_v2` (手机号)

---

### ❌ **不支持的方式**

#### 1. **复杂WHERE条件** - 语法错误
```bash
# ❌ 精确匹配查询失败
content query --where "mimetype='vnd.android.cursor.item/phone_v2'"
```
**错误**：SQLite语法错误，疑似厂商定制ROM的兼容性问题

#### 2. **dumpsys contacts** - 服务不存在
```bash
# ❌ 联系人服务转储失败  
dumpsys contacts
```
**错误**：`Can't find service: contacts`

#### 3. **多字段投影语法** - 格式限制
```bash  
# ❌ 复杂投影查询失败
--projection "contact_id:data1:mimetype"
```
**错误**：Non-token detected，不支持冒号分隔语法

---

### 🎯 **设备特点分析**

**你的设备特征**：
- **品牌**：Honor（华为系）设备
- **ROM**：定制Android系统
- **联系人包**：
  - `com.hihonor.contacts.sync` (华为联系人同步)
  - `com.android.providers.contacts` (标准联系人提供者)

**限制原因**：
1. **厂商定制**：Honor对ContentProvider做了安全限制
2. **权限控制**：部分查询需要特殊权限
3. **SQL方言**：使用了非标准的SQLite语法

---

### 💡 **推荐的实用方案**

基于测试结果，为你的设备推荐以下查询策略：

#### **方案A：简化查询（推荐）**
```bash
# 1. 获取所有联系人基本信息
adb shell content query --uri content://com.android.contacts/contacts --projection display_name --projection _id

# 2. 获取所有数据（需要后处理分离）
adb shell content query --uri content://com.android.contacts/data --projection contact_id --projection data1 --projection mimetype

# 3. 在PC端用脚本过滤手机号
```

#### **方案B：VCF导出（备用）**
```bash
# 如果content查询受限，考虑VCF导出
adb shell am start -a android.intent.action.VIEW -d "content://com.android.contacts/contacts" -t "text/x-vcard"
```

#### **方案C：定制SQL（高级）**
```bash
# 需要root权限直接访问数据库
adb shell su -c "sqlite3 /data/data/com.android.providers.contacts/databases/contacts2.db 'SELECT display_name FROM contacts'"
```

**结论**：你的设备支持基础的content查询，但复杂条件查询受限。建议使用简化查询+PC端后处理的方式。
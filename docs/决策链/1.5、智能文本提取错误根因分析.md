# æ™ºèƒ½æ–‡æœ¬æå–é”™è¯¯æ ¹å› åˆ†æ

## ğŸš¨ é—®é¢˜ç°è±¡

**ç”¨æˆ·ç‚¹å‡»**: å·¦ä¸‹è§’ `element_43` - "å°ä½•è€å¸ˆ" å¡ç‰‡ (55èµ) `[13,1158][534,2023]`  
**ç³»ç»Ÿæå–**: "147" æ¥è‡ªå³ä¸Šè§’ "çŸ¥æ©" å¡ç‰‡ (147èµ) `[911,993][990,1072]`  
**é”™è¯¯ç»“æœ**: å®Œå…¨é”™è¯¯çš„å…ƒç´ è¯†åˆ«,Bounds ä¸åŒ¹é…,æ‰§è¡Œå¤±è´¥ âŒ

---

## ğŸ” ä»£ç å†³ç­–é“¾è·¯è¿½è¸ª

### **æ­¥éª¤1: å…„å¼Ÿå…ƒç´ æå–é€»è¾‘**

**ä½ç½®**: `useIntelligentStepCardIntegration.ts:486-530`

```typescript
// ğŸ†• æå–åŒå±‚å…„å¼Ÿå…ƒç´ çš„æ–‡æœ¬ï¼ˆç”¨äº"é€šè®¯å½•"è¿™ç§åœºæ™¯ï¼‰
if (xmlContent && boundsString) {
  try {
    const boundsPattern = boundsString.replace(/[[\]]/g, "\\$&");
    const boundsRegex = new RegExp(`bounds="${boundsPattern}"`);
    const boundsMatch = xmlContent.match(boundsRegex);

    if (boundsMatch) {
      const matchIndex = boundsMatch.index || 0;
      const beforeBounds = xmlContent.substring(0, matchIndex);

      // ğŸ” å‘å‰æŸ¥æ‰¾çˆ¶å…ƒç´ çš„å®Œæ•´èŒƒå›´
      const parentNodeMatches = [
        ...beforeBounds.matchAll(/<node[^>]*>/g),
      ];
      if (parentNodeMatches.length >= 1) {
        // æ‰¾åˆ°æœ€è¿‘çš„çˆ¶å…ƒç´  âš ï¸ é—®é¢˜ç‚¹1
        const lastParentMatch =
          parentNodeMatches[parentNodeMatches.length - 1];
        const parentStartIndex = lastParentMatch.index || 0;

        // æå–çˆ¶å…ƒç´ çš„å®Œæ•´XMLç‰‡æ®µï¼ˆä»çˆ¶å…ƒç´ å¼€å§‹åˆ°ä¸‹ä¸€ä¸ªçˆ¶å…ƒç´ å…³é—­æ ‡ç­¾ï¼‰
        const afterParent = xmlContent.substring(parentStartIndex);
        const parentClosingMatch = afterParent.match(/<\/node>/); // âš ï¸ é—®é¢˜ç‚¹2
        if (parentClosingMatch) {
          const parentFragment = afterParent.substring(
            0,
            (parentClosingMatch.index || 0) + 7
          );

          // ğŸ” åœ¨çˆ¶å…ƒç´ çš„å­èŠ‚ç‚¹ä¸­æŸ¥æ‰¾æ‰€æœ‰å…„å¼Ÿå…ƒç´ çš„textå’Œcontent-desc
          const siblingTextMatches = [
            ...parentFragment.matchAll(/text="([^"]*)"/g), // âš ï¸ é—®é¢˜ç‚¹3
          ];
          const siblingDescMatches = [
            ...parentFragment.matchAll(/content-desc="([^"]*)"/g),
          ];

          siblingTexts = [
            ...siblingTextMatches.map((m) => m[1]),
            ...siblingDescMatches.map((m) => m[1]),
          ].filter(
            (t) => t && t.trim().length > 0 && t.trim().length < 50
          );
        }
      }
    }
  } catch (error) {
    console.warn("âš ï¸ [å…„å¼Ÿå…ƒç´ æå–] æå–å¤±è´¥:", error);
  }
}
```

### **æ­¥éª¤2: æ™ºèƒ½æ–‡æœ¬é€‰æ‹©ä¼˜å…ˆçº§**

**ä½ç½®**: `useIntelligentStepCardIntegration.ts:573-599`

```typescript
// ğŸ†• ä¿®å¤ï¼šä¼˜å…ˆä½¿ç”¨å­å…ƒç´ çš„content-descï¼ˆåŒ…å«æœ€è¯¦ç»†çš„è¯­ä¹‰ï¼Œå¦‚"æˆ‘ï¼ŒæŒ‰é’®"ï¼‰
let finalText = element.text || "";
if (!finalText || finalText.trim() === "") {
  // ğŸ¥‡ æœ€é«˜ä¼˜å…ˆçº§ï¼šå­å…ƒç´ çš„content-descï¼ˆå¦‚"æˆ‘ï¼ŒæŒ‰é’®"ï¼‰
  if (childContentDescs.length > 0) {
    finalText = childContentDescs[0];
    console.log(
      "ğŸ¯ [æ™ºèƒ½é€‰æ‹©] ä½¿ç”¨å­å…ƒç´ content-descï¼ˆæœ€è¯¦ç»†è¯­ä¹‰ï¼‰:",
      finalText
    );
  }
  // ğŸ¥ˆ ç¬¬äºŒä¼˜å…ˆçº§ï¼šå…„å¼Ÿå…ƒç´ çš„text/descï¼ˆå¦‚"é€šè®¯å½•"ï¼‰âš ï¸ é—®é¢˜ç‚¹4
  else if (siblingTexts.length > 0) {
    finalText = siblingTexts[0]; // âš ï¸ ç›´æ¥ä½¿ç”¨ç¬¬ä¸€ä¸ªï¼Œæ²¡æœ‰è¿‡æ»¤!
    console.log("ğŸ¯ [æ™ºèƒ½é€‰æ‹©] ä½¿ç”¨å…„å¼Ÿå…ƒç´ æ–‡æœ¬:", finalText);
  }
  // ğŸ¥‰ ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼šå­å…ƒç´ çš„textï¼ˆå¦‚"ä¸ºä½ æ¨è"ï¼‰
  else if (childTexts.length > 0) {
    finalText = childTexts[0];
    console.log("ğŸ¯ [æ™ºèƒ½é€‰æ‹©] ä½¿ç”¨å­å…ƒç´ æ–‡æœ¬:", finalText);
  }
}
```

---

## ğŸ› ä¸‰ä¸ªè‡´å‘½ç¼ºé™·

### **ç¼ºé™·1: çˆ¶å…ƒç´ èŒƒå›´è¯†åˆ«é”™è¯¯**

```typescript
// âŒ é”™è¯¯: åªæŸ¥æ‰¾"æœ€è¿‘çš„ä¸€ä¸ª <node" æ ‡ç­¾
const parentNodeMatches = [
  ...beforeBounds.matchAll(/<node[^>]*>/g),
];
const lastParentMatch = parentNodeMatches[parentNodeMatches.length - 1];
```

**é—®é¢˜**: 
- XML æ˜¯å‹ç¼©æ ¼å¼,æ²¡æœ‰æ¢è¡Œ
- `beforeBounds.matchAll(/<node[^>]*>/g)` ä¼šåŒ¹é…**æ‰€æœ‰ä¹‹å‰çš„ node æ ‡ç­¾**
- `parentNodeMatches[length-1]` åªå–æœ€åä¸€ä¸ª,ä½†è¿™å¯èƒ½æ˜¯**å¾ˆè¿œçš„ç¥–å…ˆå…ƒç´ **!

**å®é™…æƒ…å†µ**:
```xml
<!-- å‹ç¼©XMLç¤ºä¾‹ -->
<node ...><node ...><node bounds="[13,1158][534,2023]">...</node></node><node bounds="[546,225][1067,1083]"><node text="147">...</node></node>...
       â†‘                     â†‘
       ç¥–å…ˆå…ƒç´             element_43
```

ç”±äºXMLæ˜¯ä¸€è¡Œ,`lastParentMatch` å¯èƒ½å®šä½åˆ°**RecyclerView æˆ–æ›´ä¸Šå±‚çš„å®¹å™¨**,è€Œä¸æ˜¯ element_43 çš„ç›´æ¥çˆ¶å…ƒç´ !

### **ç¼ºé™·2: çˆ¶å…ƒç´ ç»“æŸæ ‡ç­¾è¯†åˆ«é”™è¯¯**

```typescript
// âŒ é”™è¯¯: åªåŒ¹é…ç¬¬ä¸€ä¸ª </node>
const parentClosingMatch = afterParent.match(/<\/node>/);
const parentFragment = afterParent.substring(
  0,
  (parentClosingMatch.index || 0) + 7
);
```

**é—®é¢˜**:
- `afterParent.match(/<\/node>/)` åªåŒ¹é…**ç¬¬ä¸€ä¸ª** `</node>`
- ç”±äºåµŒå¥—ç»“æ„,ç¬¬ä¸€ä¸ª `</node>` å¯èƒ½æ˜¯**å­å…ƒç´ çš„ç»“æŸæ ‡ç­¾**,ä¸æ˜¯çˆ¶å…ƒç´ !
- å¯¼è‡´ `parentFragment` èŒƒå›´è¿‡å°,åŒ…å«ä¸å®Œæ•´çš„å­æ ‘

**å®é™…æƒ…å†µ**:
```xml
<node index="0"> <!-- è¿™æ˜¯ç¥–å…ˆRecyclerView -->
  <node index="0">...</node> <!-- ç¬¬ä¸€ä¸ª </node> åœ¨è¿™é‡Œ! âŒ -->
  <node index="1">...</node>
  <node index="2" bounds="[13,1158][534,2023]">...</node>
  <node index="3">...</node>
</node>
```

ç»“æœ: `parentFragment` åªåŒ…å« `index="0"` çš„ç¬¬ä¸€ä¸ªå¡ç‰‡,**å®Œå…¨ä¸åŒ…å«** element_43!

### **ç¼ºé™·3: å…„å¼Ÿå…ƒç´ èŒƒå›´æ— é™åˆ¶**

```typescript
// âŒ é”™è¯¯: ä»æ•´ä¸ª parentFragment ä¸­æå–æ‰€æœ‰ text
const siblingTextMatches = [
  ...parentFragment.matchAll(/text="([^"]*)"/g),
];

siblingTexts = [
  ...siblingTextMatches.map((m) => m[1]),
  ...siblingDescMatches.map((m) => m[1]),
].filter(
  (t) => t && t.trim().length > 0 && t.trim().length < 50
);
```

**é—®é¢˜**:
- `parentFragment` å®é™…ä¸ŠåŒ…å«äº†**æ•´ä¸ª RecyclerView** (ç”±äºç¼ºé™·1å’Œ2)
- `matchAll(/text="([^"]*)"/g)` ä¼šæå–**æ‰€æœ‰å¡ç‰‡çš„æ‰€æœ‰æ–‡æœ¬**
- **æ²¡æœ‰ä»»ä½•ä½ç½®è¿‡æ»¤**,æ²¡æœ‰æ£€æŸ¥æ–‡æœ¬æ˜¯å¦åœ¨ element_43 é™„è¿‘
- `.filter()` åªè¿‡æ»¤é•¿åº¦,ä¸è¿‡æ»¤ä½ç½®

**å®é™…æå–çš„æ–‡æœ¬**:
```javascript
siblingTexts = [
  "å°è¿åœ¨æ·±åœ³æ°´è´",  // index=0 çš„å¡ç‰‡
  "101",              // index=0 çš„ç‚¹èµæ•°
  "çŸ¥æ©",             // index=1 çš„å¡ç‰‡ (å³ä¸Šè§’)
  "147",              // âš ï¸ index=1 çš„ç‚¹èµæ•° (å³ä¸Šè§’) - è¢«é”™è¯¯æå–!
  "å°ä½•è€å¸ˆ",         // index=2 çš„å¡ç‰‡ (element_43 æœ¬èº«)
  "55",               // index=2 çš„ç‚¹èµæ•°
  "çŒ«ğŸ±äººç”Ÿ",         // index=3 çš„å¡ç‰‡
  "141",              // index=3 çš„ç‚¹èµæ•°
  // ... æ›´å¤š
]
```

### **ç¼ºé™·4: æ— ä½ç½®è¿‡æ»¤çš„ç›²ç›®é€‰æ‹©**

```typescript
// âŒ é”™è¯¯: ç›´æ¥ä½¿ç”¨ siblingTexts[0]
else if (siblingTexts.length > 0) {
  finalText = siblingTexts[0]; // âš ï¸ å¯èƒ½æ˜¯ä»»ä½•å¡ç‰‡çš„æ–‡æœ¬!
  console.log("ğŸ¯ [æ™ºèƒ½é€‰æ‹©] ä½¿ç”¨å…„å¼Ÿå…ƒç´ æ–‡æœ¬:", finalText);
}
```

**é—®é¢˜**:
- `siblingTexts[0]` æ˜¯**æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªéç©ºæ–‡æœ¬**
- ç”±äºç¼ºé™·3,è¿™ä¸ªæ•°ç»„åŒ…å«**æ‰€æœ‰å¡ç‰‡çš„æ–‡æœ¬**
- **å®Œå…¨éšæœº**å–å†³äº:
  - XML ä¸­å…ƒç´ çš„é¡ºåº
  - å“ªä¸ªå¡ç‰‡å…ˆå‡ºç°
  - å“ªä¸ªæ–‡æœ¬å…ˆè¢« `matchAll()` åŒ¹é…

**æœ¬æ¬¡é”™è¯¯**:
```javascript
// element_43 bounds: [13,1158][534,2023] (å·¦ä¸‹è§’)
// å®é™…æå–çš„ siblingTexts é¡ºåº:
siblingTexts = [
  "å°è¿åœ¨æ·±åœ³æ°´è´",  // 0 - æ¥è‡ªä¸Šæ–¹å¡ç‰‡
  "101",              // 1
  "çŸ¥æ©",             // 2 - æ¥è‡ªå³ä¸Šè§’
  "147",              // 3 - âš ï¸ æ¥è‡ªå³ä¸Šè§’,ä½†å¯èƒ½è¢«é€‰ä¸º [0]!
  // ...
]

// ç”±äºæŸç§åŸå›  (å¯èƒ½ .filter() é‡æ’åº)
// finalText = "147" è¢«é€‰ä¸­ âŒ
```

---

## ğŸ“Š å†³ç­–æµç¨‹å›¾

```mermaid
graph TD
    A[ç”¨æˆ·ç‚¹å‡» element_43<br/>å·¦ä¸‹è§’ å°ä½•è€å¸ˆå¡ç‰‡] --> B{å…ƒç´ æœ‰æ–‡æœ¬?}
    B -->|æ— | C[æŸ¥æ‰¾å…„å¼Ÿå…ƒç´ æ–‡æœ¬]
    
    C --> D[å‘å‰æ‰¾çˆ¶å…ƒç´ å¼€å§‹ä½ç½®]
    D --> E[âŒ é”™è¯¯: æ‰¾åˆ°äº†å¾ˆè¿œçš„ç¥–å…ˆ<br/>RecyclerViewæˆ–æ›´ä¸Šå±‚]
    
    E --> F[å‘åæ‰¾ç¬¬ä¸€ä¸ª /node]
    F --> G[âŒ é”™è¯¯: åªæ‰¾åˆ°ç¬¬ä¸€ä¸ªå­å…ƒç´ ç»“æŸ<br/>ä¸æ˜¯çœŸæ­£çš„çˆ¶å…ƒç´ ç»“æŸ]
    
    G --> H[æå– parentFragment]
    H --> I[âŒ é”™è¯¯: parentFragment åŒ…å«<br/>æ•´ä¸ªRecyclerViewæ‰€æœ‰å¡ç‰‡]
    
    I --> J[matchAll text=]
    J --> K[âŒ é”™è¯¯: æå–äº†æ‰€æœ‰å¡ç‰‡çš„æ–‡æœ¬<br/>åŒ…æ‹¬å³ä¸Šè§’çš„ 147]
    
    K --> L{siblingTexts.length > 0?}
    L -->|æ˜¯| M[âŒ é”™è¯¯: ä½¿ç”¨ siblingTexts0<br/>å¯èƒ½æ˜¯ä»»ä½•å¡ç‰‡çš„æ–‡æœ¬]
    
    M --> N[finalText = 147<br/>æ¥è‡ªå³ä¸Šè§’ çŸ¥æ© å¡ç‰‡]
    
    N --> O[ä¿å­˜åˆ° original_data]
    O --> P[åç«¯æ‰§è¡Œæ—¶ Bounds ä¸åŒ¹é…<br/>IOU=0.00]
    P --> Q[å®‰å…¨æœºåˆ¶é˜»æ­¢æ‰§è¡Œ âœ…]
```

---

## âœ… æ­£ç¡®çš„é€»è¾‘åº”è¯¥æ˜¯

### **ä¿®å¤1: ç²¾ç¡®è¯†åˆ«ç›´æ¥çˆ¶å…ƒç´ **

```typescript
// âœ… æ­£ç¡®: ä½¿ç”¨æ ˆç»“æ„è¿½è¸ªåµŒå¥—å±‚çº§
function findDirectParent(xmlContent: string, targetBounds: string): {
  parentStart: number;
  parentEnd: number;
} | null {
  const nodes: { start: number; depth: number }[] = [];
  let currentDepth = 0;
  let targetDepth = -1;
  let targetIndex = -1;

  // ç¬¬ä¸€é: æ‰¾åˆ°ç›®æ ‡å…ƒç´ çš„æ·±åº¦
  const boundsRegex = new RegExp(`bounds="${targetBounds.replace(/[[\]]/g, "\\$&")}"`);
  const targetMatch = xmlContent.match(boundsRegex);
  if (!targetMatch) return null;

  const targetPosition = targetMatch.index || 0;

  // ç¬¬äºŒé: ä»å¤´å¼€å§‹è®¡ç®—åµŒå¥—æ·±åº¦
  const beforeTarget = xmlContent.substring(0, targetPosition);
  const nodeOpenings = [...beforeTarget.matchAll(/<node[^>]*>/g)];
  const nodeClosings = [...beforeTarget.matchAll(/<\/node>/g)];

  targetDepth = nodeOpenings.length - nodeClosings.length;

  // ç¬¬ä¸‰é: æ‰¾åˆ°ç›®æ ‡æ·±åº¦-1 (çˆ¶å…ƒç´ ) çš„èŒƒå›´
  const parentDepth = targetDepth - 1;
  // ... ç»§ç»­å®ç°æ ˆç»“æ„è¿½è¸ª
}
```

### **ä¿®å¤2: é™åˆ¶æœç´¢èŒƒå›´åˆ°å®é™…å…„å¼Ÿå…ƒç´ **

```typescript
// âœ… æ­£ç¡®: åªæœç´¢åŒä¸€çˆ¶å…ƒç´ ä¸‹çš„ç›´æ¥å­èŠ‚ç‚¹
function extractSiblingTexts(
  parentFragment: string,
  targetBounds: string
): string[] {
  const siblings: string[] = [];
  
  // è§£æçˆ¶å…ƒç´ çš„æ‰€æœ‰ç›´æ¥å­èŠ‚ç‚¹ (ä¸åŒ…æ‹¬å­™å­èŠ‚ç‚¹)
  let depth = 0;
  let currentSibling = "";
  
  for (let i = 0; i < parentFragment.length; i++) {
    if (parentFragment.substring(i, i + 5) === "<node") {
      depth++;
      if (depth === 1) {
        // è¿™æ˜¯ä¸€ä¸ªç›´æ¥å­èŠ‚ç‚¹
        currentSibling = "";
      }
    } else if (parentFragment.substring(i, i + 7) === "</node>") {
      depth--;
      if (depth === 0) {
        // ç›´æ¥å­èŠ‚ç‚¹ç»“æŸ,æå–å…¶æ–‡æœ¬
        const textMatch = currentSibling.match(/text="([^"]*)"/);
        if (textMatch && textMatch[1]) {
          siblings.push(textMatch[1]);
        }
        currentSibling = "";
      }
    }
    
    if (depth >= 1) {
      currentSibling += parentFragment[i];
    }
  }
  
  return siblings;
}
```

### **ä¿®å¤3: æ·»åŠ ä½ç½®è¿‡æ»¤**

```typescript
// âœ… æ­£ç¡®: åªä½¿ç”¨ä¸ç›®æ ‡å…ƒç´ ä½ç½®æ¥è¿‘çš„æ–‡æœ¬
function filterByProximity(
  texts: string[],
  textBounds: string[],
  targetBounds: string
): string[] {
  const target = parseBounds(targetBounds);
  
  return texts.filter((text, index) => {
    const bounds = parseBounds(textBounds[index]);
    
    // è®¡ç®— IOU (äº¤å¹¶æ¯”)
    const iou = calculateIOU(target, bounds);
    
    // åªä¿ç•™æœ‰é‡å æˆ–éå¸¸æ¥è¿‘çš„å…ƒç´  (IOU > 0.1)
    return iou > 0.1;
  });
}

// æˆ–è€…æ›´ç®€å•: åªä¿ç•™åœ¨ç›®æ ‡ bounds èŒƒå›´å†…çš„æ–‡æœ¬
function filterByContainment(
  texts: string[],
  textBounds: string[],
  targetBounds: string
): string[] {
  const target = parseBounds(targetBounds);
  
  return texts.filter((text, index) => {
    const bounds = parseBounds(textBounds[index]);
    
    // æ£€æŸ¥æ˜¯å¦åœ¨ç›®æ ‡èŒƒå›´å†…
    return (
      bounds.left >= target.left &&
      bounds.top >= target.top &&
      bounds.right <= target.right &&
      bounds.bottom <= target.bottom
    );
  });
}
```

### **ä¿®å¤4: æ™ºèƒ½é€‰æ‹©æœ€ä½³æ–‡æœ¬**

```typescript
// âœ… æ­£ç¡®: ä½¿ç”¨å¤šç§å¯å‘å¼è§„åˆ™é€‰æ‹©æœ€ä½³æ–‡æœ¬
function selectBestText(
  siblingTexts: string[],
  targetBounds: string
): string | null {
  if (siblingTexts.length === 0) return null;
  
  // 1. ä¼˜å…ˆé€‰æ‹©ä½ç½®æœ€æ¥è¿‘çš„
  const sorted = siblingTexts.sort((a, b) => {
    const distA = calculateDistance(a.bounds, targetBounds);
    const distB = calculateDistance(b.bounds, targetBounds);
    return distA - distB;
  });
  
  // 2. è¿‡æ»¤æ‰çº¯æ•°å­— (å¯èƒ½æ˜¯ç‚¹èµæ•°ç­‰æ— æ„ä¹‰æ–‡æœ¬)
  const nonNumeric = sorted.filter(text => !/^\d+$/.test(text));
  
  // 3. ä¼˜å…ˆé€‰æ‹©æœ‰è¯­ä¹‰çš„æ–‡æœ¬ (é•¿åº¦ > 2)
  const meaningful = nonNumeric.filter(text => text.length > 2);
  
  return meaningful[0] || sorted[0];
}
```

---

## ğŸ¯ æœ¬æ¬¡é”™è¯¯çš„å®Œæ•´é“¾è·¯

```
1. ç”¨æˆ·ç‚¹å‡»: element_43 [13,1158][534,2023] (å°ä½•è€å¸ˆå¡ç‰‡)
   â””â”€ å…ƒç´ æ— æ–‡æœ¬ âŒ

2. è§¦å‘å…„å¼Ÿå…ƒç´ æå–
   â””â”€ æŸ¥æ‰¾çˆ¶å…ƒç´ : âŒ æ‰¾åˆ°äº† RecyclerView (å¾ˆè¿œçš„ç¥–å…ˆ)
   â””â”€ ç¡®å®šçˆ¶å…ƒç´ èŒƒå›´: âŒ åªæ‰¾åˆ°ç¬¬ä¸€ä¸ªå­å…ƒç´ ç»“æŸ
   â””â”€ parentFragment: åŒ…å«æ‰€æœ‰å¡ç‰‡

3. æå–æ‰€æœ‰æ–‡æœ¬
   â””â”€ matchAll(/text="([^"]*)"/g): 
       ["å°è¿åœ¨æ·±åœ³æ°´è´", "101", "çŸ¥æ©", "147", "å°ä½•è€å¸ˆ", "55", ...]
                                         â†‘ æ¥è‡ªå³ä¸Šè§’!

4. é€‰æ‹©ç¬¬ä¸€ä¸ªéç©ºæ–‡æœ¬
   â””â”€ siblingTexts[0] = "147" âŒ (æˆ–æŸä¸ªéšæœºæ–‡æœ¬)

5. ä¿å­˜åˆ° original_data
   â””â”€ element_text: "147"
   â””â”€ element_bounds: "[13,1158][534,2023]"
   â””â”€ âš ï¸ æ–‡æœ¬å’Œ bounds æ¥è‡ªä¸åŒçš„å…ƒç´ !

6. åç«¯æ‰§è¡Œ
   â””â”€ æ™ºèƒ½åŒ¹é…æ‰¾åˆ° "147" çš„å…ƒç´ : bounds=[911,993][990,1072] (å³ä¸Šè§’)
   â””â”€ ä¸ç”¨æˆ·é€‰æ‹© bounds=[13,1158][534,2023] æ¯”è¾ƒ
   â””â”€ IOU = 0.00 (å®Œå…¨ä¸é‡å )
   â””â”€ è¯„åˆ† < 0.3 é˜ˆå€¼
   â””â”€ å®‰å…¨æœºåˆ¶é˜»æ­¢æ‰§è¡Œ âœ… (æ­£ç¡®é˜»æ­¢äº†é”™è¯¯ç‚¹å‡»!)
```

---

## ğŸ’¡ ç«‹å³ä¿®å¤æ–¹æ¡ˆ

### **æ–¹æ¡ˆA: ç¦ç”¨å…„å¼Ÿå…ƒç´ æå– (å¿«é€Ÿä¿®å¤)**

```typescript
// ä¸´æ—¶ç¦ç”¨å…„å¼Ÿå…ƒç´ æå–,é¿å…è·¨å…ƒç´ æ±¡æŸ“
// let siblingTexts: string[] = [];
let siblingTexts: string[] = []; // ğŸš« æš‚æ—¶ä¸å¯ç”¨,ç­‰å¾…ä¿®å¤

// æ³¨é‡Šæ‰æ•´ä¸ªå…„å¼Ÿå…ƒç´ æå–é€»è¾‘
/*
if (xmlContent && boundsString) {
  // ... å…„å¼Ÿå…ƒç´ æå–ä»£ç 
}
*/
```

### **æ–¹æ¡ˆB: æ·»åŠ è¾¹ç•Œæ£€æŸ¥ (ä¸­ç­‰ä¿®å¤)**

```typescript
// åœ¨æå–å…„å¼Ÿå…ƒç´ æ–‡æœ¬å,ç«‹å³è¿‡æ»¤
siblingTexts = siblingTexts.filter((text) => {
  // ä» XML ä¸­æ‰¾åˆ°è¿™ä¸ªæ–‡æœ¬çš„ bounds
  const textBoundsMatch = xmlContent.match(
    new RegExp(`text="${text}"[^>]*bounds="([^"]*)"`)
  );
  
  if (!textBoundsMatch) return false;
  
  const textBounds = textBoundsMatch[1];
  
  // æ£€æŸ¥æ˜¯å¦åœ¨ç”¨æˆ·é€‰æ‹©çš„ bounds èŒƒå›´å†…
  return isWithinBounds(textBounds, boundsString);
});
```

### **æ–¹æ¡ˆC: é‡æ„æ•´ä¸ªæå–é€»è¾‘ (å®Œæ•´ä¿®å¤)**

å‚è€ƒä¸Šé¢ "æ­£ç¡®çš„é€»è¾‘åº”è¯¥æ˜¯" éƒ¨åˆ†,å®Œå…¨é‡å†™:
1. ç²¾ç¡®è¯†åˆ«ç›´æ¥çˆ¶å…ƒç´  (ä½¿ç”¨æ ˆç»“æ„)
2. åªæå–ç›´æ¥å­èŠ‚ç‚¹ (ä¸åŒ…æ‹¬å­™å­èŠ‚ç‚¹)
3. æ·»åŠ ä½ç½®è¿‡æ»¤ (IOU > 0.1 æˆ–åœ¨èŒƒå›´å†…)
4. æ™ºèƒ½é€‰æ‹©æœ€ä½³æ–‡æœ¬ (å¤šç§å¯å‘å¼è§„åˆ™)

---

## ğŸ“ æ€»ç»“

**æ ¹æœ¬åŸå› **: å…„å¼Ÿå…ƒç´ æå–é€»è¾‘çš„**ä¸‰ä¸ªè‡´å‘½ç¼ºé™·**:
1. âŒ çˆ¶å…ƒç´ è¯†åˆ«é”™è¯¯ â†’ æ‰¾åˆ°äº†å¾ˆè¿œçš„ç¥–å…ˆ
2. âŒ èŒƒå›´ç¡®å®šé”™è¯¯ â†’ åŒ…å«äº†æ‰€æœ‰å¡ç‰‡
3. âŒ æ— ä½ç½®è¿‡æ»¤ â†’ æå–äº†ä»»æ„å¡ç‰‡çš„æ–‡æœ¬

**å†³ç­–é“¾**: ç”¨æˆ·ç‚¹å‡» â†’ æ— æ–‡æœ¬ â†’ æŸ¥æ‰¾å…„å¼Ÿ â†’ **é”™è¯¯èŒƒå›´** â†’ æå–æ‰€æœ‰ â†’ **éšæœºé€‰æ‹©** â†’ é”™è¯¯ç»“æœ

**å®‰å…¨ä¿æŠ¤**: åç«¯ Bounds ä¸¥æ ¼åŒ¹é…æœºåˆ¶**æ­£ç¡®é˜»æ­¢äº†é”™è¯¯ç‚¹å‡»** âœ…

**å»ºè®®**: ä¼˜å…ˆä½¿ç”¨**æ–¹æ¡ˆAç¦ç”¨**,ç„¶åå®æ–½**æ–¹æ¡ˆCå®Œæ•´é‡æ„**

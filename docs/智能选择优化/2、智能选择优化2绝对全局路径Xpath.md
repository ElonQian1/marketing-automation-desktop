问题是当时所选的元素， 是不是依靠静态分析的绝对全局Xpath ，然后让智能自动链帮我 采集固化？
然后复现？

短答：**不是“靠绝对全局 XPath 直接复现”**。
绝对全局 XPath 只用来在静态快照里**精准指到你当时点的那个元素**，给“智能自动链”**取材**（采集&固化特征）。真正到真机复现时，走的是已固化的**策略计划（StrategyPlan）**与选择器栈，而**不是**那条绝对 XPath。

---

## 绝对全局 XPath 在哪里用？

* **静态分析阶段：用作“书签”**
  从快照中定位被点元素 → 提取它的上下文（可点父、容器、子锚点、文本/ID等）。
* **审计与兜底：**保留在步骤卡片里，便于回溯/对账；仅在你显式允许时作为**最后兜底**尝试。

---

## 静态分析要“采集并固化”的内容（给真机复现用）

**必须固化：**

1. **容器限域**：`container_xpath`（把搜索范围锁到稳定父容器）
2. **可点父归一**：`clickable_parent_xpath`（最终点击的节点）
3. **同类查询法**：如何从容器内捞出“同类元素”的表达（文本别名、子锚点→上溯可点父）
4. **选择策略**：`selection.mode`（只这一个/第一个/最后一个/随机/全部）+ 稳定排序规则（y→x）
5. **轻校验**：命中后要满足的断言（例如子树含“已关注/Following”变化）
6. **指纹**：`fingerprint`（class、id 后缀、文本哈希、相对索引、bounds 比例…）——用于“match-original”精确还原
7. **i18n 别名**：文本同义词集合（关注|+关注|Follow|…）

**建议固化：**

* **候选链 Plan**（从强到弱：Self-Anchor → Child-Driven → Region-Scoped → Neighbor → Local-Index → Global-Index）及各自评分/解释
* **批量执行控制**（间隔、是否单次 dump 预计算坐标、失败是否中断、超时预算）

> 绝对 XPath 与原始 XML 快照一起保留，但**不作为真机匹配的主依据**。

---

## 真机复现怎么跑？

1. **dump 真机 XML**
2. **按已固化的“同类查询法”在容器内取候选** → 过滤（已关注/不可见/不可点） → 稳定排序
3. **依据选择策略取目标**

   * match-original：用 `fingerprint` 在候选中找“同一实例”
   * first/last/random/all：按规则取 1 个或一组
4. **轻校验通过 → 执行动作**（tap/输入…；all 模式按间隔逐一点击）
5. **必要时回退**：按 Plan 顺序尝试下一个策略（小预算）
6. **仅当你允许时**才尝试“绝对 XPath 兜底”

---

## 一句话总结

* **静态阶段**：用**绝对 XPath**精准指路 → “智能自动链”**采集并固化**可复现的**策略与选择器栈**。
* **真机阶段**：**重新 dump** + 按已固化的**容器/可点父/同类查询/选择策略/轻校验**去匹配和执行。
* 绝对 XPath = **书签/审计/最后兜底**，不是主战力。

# ğŸš€ æ­¥éª¤å¡ç‰‡æ–°åŠŸèƒ½å¿«é€Ÿä½¿ç”¨æŒ‡å—

> 5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹æ–°å¢çš„4ä¸ªå…³é”®åŠŸèƒ½ç»„ä»¶

---

## ğŸ“¦ å®‰è£…/å¯¼å…¥

```tsx
// æ–¹å¼1ï¼šå•ç‹¬å¯¼å…¥
import {
  UniversalFallbackBadge,
  UniversalStrategyCandidatesSection,
  UniversalStrategyModeSelector,
  UniversalPublishReadinessModal
} from '@/modules/universal-ui';

// æ–¹å¼2ï¼šä½¿ç”¨å®Œæ•´é›†æˆç¤ºä¾‹
import { UniversalEnhancedStepCardIntegration } from '@/modules/universal-ui';
```

---

## 1ï¸âƒ£ "æš‚ç”¨å…œåº•"å¾½æ ‡ - æœ€ç®€ä½¿ç”¨

```tsx
import { UniversalFallbackBadge } from '@/modules/universal-ui';

// åœ¨æ­¥éª¤å¡ç‰‡å¤´éƒ¨æ·»åŠ 
<div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
  <h4>{stepCard.stepName}</h4>
  
  {/* æ·»åŠ å¾½æ ‡ */}
  <UniversalFallbackBadge
    isFallbackActive={stepCard.activeStrategy?.key === stepCard.fallbackStrategy.key}
    fallbackName={stepCard.fallbackStrategy.name}
    isAnalyzing={stepCard.analysisState === 'analyzing'}
  />
</div>
```

**æ•ˆæœ**ï¼š
- âœ… ä½¿ç”¨å…œåº•ç­–ç•¥æ—¶æ˜¾ç¤ºæ©™è‰²å¾½æ ‡
- âœ… åˆ†æä¸­æ—¶æ˜¾ç¤ºæ—‹è½¬åŠ¨ç”»
- âœ… é¼ æ ‡æ‚¬æµ®æ˜¾ç¤ºè¯¦ç»†è¯´æ˜

---

## 2ï¸âƒ£ å€™é€‰ç­–ç•¥å±•ç¤ºåŒº - æœ€ç®€ä½¿ç”¨

```tsx
import { UniversalStrategyCandidatesSection } from '@/modules/universal-ui';

// åœ¨æ­¥éª¤å¡ç‰‡çš„é«˜çº§é€‰é¡¹ä¸­æ·»åŠ 
{stepCard.analysisState === 'analysis_completed' && (
  <UniversalStrategyCandidatesSection
    smartCandidates={stepCard.smartCandidates}
    activeStrategyKey={stepCard.activeStrategy?.key || ''}
    recommendedKey={stepCard.recommendedStrategy?.key}
    onApplyStrategy={(key) => {
      // åº”ç”¨é€‰ä¸­çš„ç­–ç•¥
      console.log('åº”ç”¨ç­–ç•¥:', key);
      // TODO: è°ƒç”¨åç«¯APIåˆ‡æ¢ç­–ç•¥
    }}
  />
)}
```

**æ•ˆæœ**ï¼š
- âœ… æ˜¾ç¤ºTop-3æ™ºèƒ½å€™é€‰ç­–ç•¥
- âœ… æ¨èç­–ç•¥æœ‰ç‰¹æ®Šæ ‡è¯†ï¼ˆâš¡æ™ºèƒ½æ¨èï¼‰
- âœ… å½“å‰æ¿€æ´»ç­–ç•¥é«˜äº®æ˜¾ç¤º
- âœ… ç‚¹å‡»"åº”ç”¨æ­¤ç­–ç•¥"æŒ‰é’®åˆ‡æ¢ç­–ç•¥

---

## 3ï¸âƒ£ ç­–ç•¥æ¨¡å¼åˆ‡æ¢å™¨ - æœ€ç®€ä½¿ç”¨

```tsx
import { UniversalStrategyModeSelector } from '@/modules/universal-ui';
import type { StrategyMode } from '@/modules/universal-ui';

// åœ¨æ­¥éª¤å¡ç‰‡çš„é«˜çº§é€‰é¡¹ä¸­æ·»åŠ 
const [currentMode, setCurrentMode] = useState<StrategyMode>('intelligent');

<UniversalStrategyModeSelector
  currentMode={currentMode}
  onModeChange={(mode) => {
    setCurrentMode(mode);
    console.log('åˆ‡æ¢æ¨¡å¼:', mode);
    // TODO: æ›´æ–°åç«¯çŠ¶æ€
  }}
  smartCandidates={stepCard.smartCandidates}
  displayMode="compact"  // æˆ– "detailed"
/>
```

**ä¸‰ç§æ¨¡å¼**ï¼š
1. **intelligentï¼ˆæ™ºèƒ½åŒ¹é…ï¼‰** - å®Œæ•´å†³ç­–é“¾ï¼Œæ”¯æŒå›é€€
2. **smart_variantï¼ˆæ™ºèƒ½-å•æ­¥å›ºå®šï¼‰** - é€‰ä¸€æ¡ï¼Œä¸å›é€€
3. **static_userï¼ˆç”¨æˆ·è‡ªå»ºé™æ€ï¼‰** - æ‰‹å†™XPath/CSS

---

## 4ï¸âƒ£ å‘å¸ƒå‡†å¤‡åº¦é—¸é—¨ - æœ€ç®€ä½¿ç”¨

```tsx
import { UniversalPublishReadinessModal } from '@/modules/universal-ui';

const [showPublishModal, setShowPublishModal] = useState(false);
const [allSteps, setAllSteps] = useState<IntelligentStepCard[]>([...]);

// åœ¨å‘å¸ƒæŒ‰é’®ç‚¹å‡»æ—¶
<Button onClick={() => setShowPublishModal(true)}>
  å‘å¸ƒè„šæœ¬
</Button>

// æ·»åŠ æ¨¡æ€æ¡†
<UniversalPublishReadinessModal
  visible={showPublishModal}
  onClose={() => setShowPublishModal(false)}
  steps={allSteps}
  onPublish={() => {
    // ç›´æ¥å‘å¸ƒï¼ˆä½¿ç”¨å½“å‰çŠ¶æ€ï¼‰
    console.log('ç›´æ¥å‘å¸ƒ');
    // TODO: è°ƒç”¨å‘å¸ƒAPI
    setShowPublishModal(false);
  }}
  onCompleteAnalysisAndPublish={async () => {
    // ä¸€é”®å®Œæˆåˆ†æåå†å‘å¸ƒ
    console.log('å¼€å§‹è¡¥é½åˆ†æ...');
    // TODO: å¹¶å‘è°ƒç”¨åˆ†æAPI
    await Promise.all(
      allSteps
        .filter(s => s.analysisState === 'idle')
        .map(s => analyzeStep(s.stepId))
    );
    console.log('åˆ†æå®Œæˆï¼Œå‘å¸ƒæˆåŠŸ');
    setShowPublishModal(false);
  }}
/>
```

**æ•ˆæœ**ï¼š
- âœ… æ˜¾ç¤ºå®Œæˆåº¦è¿›åº¦æ¡
- âœ… åˆ—å‡ºå¾…å®Œæˆæ­¥éª¤
- âœ… æä¾›ä¸¤ç§å‘å¸ƒé€‰é¡¹
- âœ… æ™ºèƒ½æŒ‰é’®çŠ¶æ€ï¼ˆæ ¹æ®å®Œæˆåº¦å˜åŒ–ï¼‰

---

## ğŸ¯ å®Œæ•´é›†æˆç¤ºä¾‹

å¦‚æœä½ æƒ³ä¸€æ¬¡æ€§ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é›†æˆç¤ºä¾‹ç»„ä»¶ï¼š

```tsx
import { UniversalEnhancedStepCardIntegration } from '@/modules/universal-ui';
import type { IntelligentStepCard, StrategyMode } from '@/modules/universal-ui';

const YourStepCard: React.FC<{ stepCard: IntelligentStepCard }> = ({ stepCard }) => {
  const handleApplyStrategy = (key: string) => {
    // åº”ç”¨ç­–ç•¥
    console.log('åº”ç”¨ç­–ç•¥:', key);
  };

  const handleModeChange = (mode: StrategyMode) => {
    // åˆ‡æ¢æ¨¡å¼
    console.log('åˆ‡æ¢æ¨¡å¼:', mode);
  };

  const handleCancelAnalysis = () => {
    // å–æ¶ˆåˆ†æ
    console.log('å–æ¶ˆåˆ†æ');
  };

  const handleRetryAnalysis = async () => {
    // é‡è¯•åˆ†æ
    console.log('é‡è¯•åˆ†æ');
  };

  const handleQuickUpgrade = async () => {
    // ä¸€é”®å‡çº§
    console.log('ä¸€é”®å‡çº§');
  };

  return (
    <UniversalEnhancedStepCardIntegration
      stepCard={stepCard}
      onApplyStrategy={handleApplyStrategy}
      onModeChange={handleModeChange}
      onCancelAnalysis={handleCancelAnalysis}
      onRetryAnalysis={handleRetryAnalysis}
      onQuickUpgrade={handleQuickUpgrade}
    />
  );
};
```

**è¿™ä¸ªç»„ä»¶åŒ…å«äº†æ‰€æœ‰4ä¸ªæ–°åŠŸèƒ½**ï¼š
- âœ… é¡¶éƒ¨åˆ†æçŠ¶æ€æ¡
- âœ… "æš‚ç”¨å…œåº•"å¾½æ ‡
- âœ… ç­–ç•¥æ¨¡å¼åˆ‡æ¢å™¨
- âœ… å€™é€‰ç­–ç•¥å±•ç¤ºåŒº

---

## ğŸ¨ æŸ¥çœ‹æ¼”ç¤ºæ•ˆæœ

è®¿é—®æ¼”ç¤ºé¡µé¢æŸ¥çœ‹æ‰€æœ‰ç»„ä»¶çš„å®é™…æ•ˆæœï¼š

```tsx
import { UniversalAnalysisComponentsDemo } from '@/modules/universal-ui';

// åœ¨è·¯ç”±ä¸­æ·»åŠ 
{
  path: '/analysis-components-demo',
  element: <UniversalAnalysisComponentsDemo />
}
```

æ¼”ç¤ºé¡µé¢åŒ…å«ï¼š
- æ‰€æœ‰ç»„ä»¶çš„ä½¿ç”¨ç¤ºä¾‹
- ä¸åŒçŠ¶æ€çš„å±•ç¤º
- äº¤äº’æ•ˆæœæ¼”ç¤º
- ä»£ç ä½¿ç”¨è¯´æ˜

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç±»å‹å®‰å…¨

ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ç±»å‹ï¼š

```tsx
import type { 
  IntelligentStepCard,
  StrategyMode,
  StrategyCandidate
} from '@/modules/universal-ui';
```

### 2. æ ·å¼ä¸€è‡´æ€§

æ‰€æœ‰ç»„ä»¶å·²å†…ç½® `light-theme-force` ç±»ï¼Œæ— éœ€é¢å¤–å¤„ç†ç™½åº•ç™½å­—é—®é¢˜ã€‚

### 3. æ•°æ®å‡†å¤‡

ç¡®ä¿æ­¥éª¤å¡ç‰‡æ•°æ®åŒ…å«å¿…è¦å­—æ®µï¼š

```tsx
const stepCard: IntelligentStepCard = {
  stepId: 'step_1',
  stepName: 'ç‚¹å‡»è”ç³»äºº',
  stepType: 'tap',
  analysisState: 'analysis_completed',  // å¿…éœ€
  smartCandidates: [...],                // å¿…éœ€
  fallbackStrategy: {...},               // å¿…éœ€
  activeStrategy: {...},                 // å¿…éœ€
  // ... å…¶ä»–å­—æ®µ
};
```

### 4. åç«¯é›†æˆ

ç»„ä»¶å·²å‡†å¤‡å¥½ï¼Œä½†éœ€è¦è¿æ¥çœŸå®åç«¯APIï¼š

- `start_analysis(stepId)` - å¯åŠ¨åˆ†æ
- `cancel_analysis(jobId)` - å–æ¶ˆåˆ†æ
- `apply_strategy(stepId, strategyKey)` - åº”ç”¨ç­–ç•¥
- `switch_mode(stepId, mode)` - åˆ‡æ¢æ¨¡å¼

---

## ğŸ“š æ›´å¤šèµ„æº

- ğŸ“– å®Œæ•´æ–‡æ¡£ï¼š`docs/æ™ºèƒ½åˆ†æå·¥ä½œæµ/æ­¥éª¤å¡ç‰‡ç¼ºå¤±åŠŸèƒ½è¡¥å……å®ŒæˆæŠ¥å‘Š.md`
- ğŸ¯ åˆ†ææŠ¥å‘Šï¼š`docs/æ™ºèƒ½åˆ†æå·¥ä½œæµ/æ­¥éª¤å¡ç‰‡é‡å¤å†—ä½™ä¸æ ·å¼é—®é¢˜åˆ†ææŠ¥å‘Š.md`
- ğŸ’¡ é›†æˆç¤ºä¾‹ï¼š`src/modules/universal-ui/ui/components/universal-enhanced-step-card-integration.tsx`
- ğŸ­ æ¼”ç¤ºé¡µé¢ï¼š`src/modules/universal-ui/pages/universal-analysis-components-demo.tsx`

---

## âœ… å¿«é€Ÿæ£€æŸ¥æ¸…å•

åœ¨ä½¿ç”¨å‰ç¡®è®¤ï¼š

- [ ] å·²å¯¼å…¥æ‰€éœ€ç»„ä»¶
- [ ] æ­¥éª¤å¡ç‰‡æ•°æ®ç»“æ„å®Œæ•´
- [ ] å®ç°äº†æ‰€æœ‰å›è°ƒå‡½æ•°
- [ ] æ·»åŠ äº†é”™è¯¯å¤„ç†
- [ ] æµ‹è¯•äº†æ‰€æœ‰çŠ¶æ€åˆ‡æ¢
- [ ] æ£€æŸ¥äº†æ ·å¼ä¸€è‡´æ€§

**å¼€å§‹ä½¿ç”¨å§ï¼** ğŸš€

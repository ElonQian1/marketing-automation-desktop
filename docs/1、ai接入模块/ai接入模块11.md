当然有～给你一份“**PR-3 之后的路线图**”，从**这周就能动手**的到**真机联调**、**数据抓取**、**AI 质量**、**产品化**、**合规**，都是可执行的小任务清单。你可以直接分给代理拆分成 PR。

---

# 本周（把闭环做稳）

1. 把批量分析**下沉到后端队列**

* 新增命令：`lh_analyze_comments({ ids?: string[], concurrency?: number })`
* Rust 侧实现**并发 + 指数退避重试**（429/5xx）
* 事件：`ai://progress`（0-100%），前端进度条
* 结果入库（或 JSON 文件）`lead_analyses`，列表联查渲染

2. 加**SQLite 持久化**（先最小表）

* `lead_comments(id, platform, video_url, author, content, ts)`
* `lead_analyses(comment_id, intent, confidence, entities_json, reply_suggestion, created_at)`
* `replay_plans(id, comment_id, status, suggested_reply, created_at, updated_at)`
* 提供迁移脚本 & `cargo test` 的种子数据

3. Orchestrator 日志面板

* 前端订阅 `orchestrator://status`，做一个“步骤时间线”
* 每步显示耗时、结果（成功/失败原因）

4. 设置页补 2 个控制项

* “AI 并发数”“最大重试次数”→ 持久化到设置，后端读取

---

# 下周（真机前置 & 算法雏形）

5. **定位算法原型**（仍用 Mock XML）

* 实现：作者名 + 评论文本的**模糊匹配**（大小写/全半角/表情去除）
* 邻接定位：从作者节点向兄弟节点找评论文本；支持列表 N 条
* 单元测试：给 10 个样例 XML，`assert_eq!(坐标/路径)`

6. **AdbDumpProvider 接口骨架**

* `open_app / open_video / dump_xml / reply` → 仅返回 `todo!()`，编译通过
* “设备前置检查”命令：`adb doctor`（adb 可用、设备在线、uiautomator 可拉起）

7. **回放计划执行策略**

* `status: pending|running|done|failed` + `attempts`
* 命令：`lh_run_pending_plans({ limit?: n })`，按队列跑；失败写 `error_message`

---

# 真机联调（随时可排期）

8. **实现 AdbDumpProvider**

* `open_app`：adb shell 启动包名；`open_video`：Intent 打开链接或内部搜索
* `dump_xml`：uiautomator dump 到临时文件再读
* `reply`：坐标/控件定位 → 输入文本 → 点击发送
* 封装**超时/重试**与**前台 App 校验**，每步 `emit` 状态

9. **设备画像与兼容层**

* `device_profiles.json`：分辨率/系统版本/输入法；必要时设定**安全输入法**
* 适配抖音/小红书主要版本的评论页面结构差异

---

# 数据入口（抓取/导入）

10. **连接器最小版**

* `import:xhs.json` / `import:douyin.json`（离线导入）
* 粘贴板批量导入：弹窗粘贴后用正则拆行
* （合规提醒）保留“手动导入”路径，避免违反平台 ToS

11. **去重与清洗**

* `unique_key = platform + video_url + author + content_hash`
* 清洗规则：去表情/去空格/替代私号数字为 `***`

---

# AI 质量与成本控制

12. **提示词与 Few-shot**

* 给 `return_lead_analysis` 增 5-10 个真实样例（中英文/俚语）
* 维护 `prompts/lead_hunt.md`，每次改 prompt 跟随 commit

13. **质量监控**

* 指标：意图准确率@人工抽样、回复可用率、平均延迟、单条成本
* 抽样工具命令：`lh_sample_for_review(n)` 导出 CSV 供人工标注

14. **缓存与重试**

* 对相同内容启用**语义缓存**（可先哈希缓存），命中直接用历史输出
* 失败样本记录到 `bad_cases.json`，每周回归

---

# 产品化 & 运营

15. **模板与快捷回复**

* 模板变量：`{customer_name?} {product} {location}`
* 列表页一键“插入模板→生成回放计划”

16. **批量动作与队列**

* 多选评论→批量“生成计划”/“执行模拟”
* 队列可视化：正在执行/排队/失败

17. **崩溃 & 审计**

* Rust 侧 `tracing` + 日志循环滚动；前端 `window.onerror` 上报
* 操作审计日志：谁在什么时候执行了哪个计划（便于追责）

---

# 合规与安全（务必做）

18. **平台条款与频控**

* 不要绕过平台限制；默认只支持**手动导入**或平台允许的导出
* 速率限制：同一视频/账号连续操作加冷却时间

19. **隐私**

* 评论中的手机号/地址默认脱敏显示；导出前二次确认
* API Key、账号密码仅存**系统凭据库**

---

# 交付节奏建议

* 本周：任务 1–4 完成，页面稳定可用
* 下周：任务 5–7 完成，定位策略过单测；视资源推进 8–9
* 并行：10–11（数据入口）、12–14（AI 质量）

---

需要我把这些拆成**Jira/Issues 模板**或**三份 PR 任务文件**继续输出吗？我可以直接给出每个 Issue 的标题、验收标准和子任务。

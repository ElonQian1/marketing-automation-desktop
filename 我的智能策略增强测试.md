# ğŸ¯ æ™ºèƒ½ç­–ç•¥å¢å¼ºåŠŸèƒ½æµ‹è¯•æŠ¥å‘Š

## ğŸ“‹ å®Œæˆçš„å¢å¼ºåŠŸèƒ½

### 1. **å±‚çº§ç‚¹å‡»ç›®æ ‡è¯†åˆ«** âœ…
```rust
/// ğŸ¯ æ ¸å¿ƒç®—æ³•ï¼šæ™ºèƒ½å±‚çº§ç‚¹å‡»ç›®æ ‡è¯†åˆ«
/// è§£å†³"TextViewæœ‰æ–‡æœ¬ä½†ä¸å¯ç‚¹å‡»ï¼Œéœ€è¦ç‚¹å‡»çˆ¶å®¹å™¨"é—®é¢˜
fn find_clickable_target(
    element: &UIElement,
    all_elements: &[UIElement]
) -> &UIElement {
    // å¦‚æœå…ƒç´ æœ¬èº«å¯ç‚¹å‡»ï¼Œç›´æ¥è¿”å›
    if element.clickable.unwrap_or(false) {
        return element;
    }
    
    // ğŸ¯ å‘ä¸ŠæŸ¥æ‰¾å¯ç‚¹å‡»çš„çˆ¶å®¹å™¨ï¼ˆæœ€å¤šå‘ä¸Š3å±‚ï¼‰
    // æŸ¥æ‰¾åŒ…å«å½“å‰å…ƒç´ ä¸”å¯ç‚¹å‡»çš„çˆ¶å®¹å™¨
    // é€‰æ‹©é¢ç§¯æœ€å°çš„åŒ…å«å®¹å™¨
}
```

**è§£å†³çš„é—®é¢˜ï¼š**
- âŒ æ—§æ–¹å¼ï¼šTextView `text="æˆ‘"` `clickable="false"` â†’ ç‚¹å‡»å¤±è´¥
- âœ… æ–°æ–¹å¼ï¼šè‡ªåŠ¨æ‰¾åˆ°FrameLayoutçˆ¶å®¹å™¨ `clickable="true"` â†’ ç‚¹å‡»æˆåŠŸ

### 2. **resource-id é‡å¤æ€§æ™ºèƒ½å¤„ç†** âœ…
```rust
/// ğŸ¯ è®¡ç®—resource-idç½®ä¿¡åº¦ï¼ˆå¤„ç†é‡å¤IDï¼‰
fn calculate_resource_id_confidence(
    element: &UIElement,
    index: usize,
    total_matches: usize,
    env: &ExecutionEnvironment
) -> f32 {
    // ğŸ¯ é‡å¤IDæƒ©ç½š
    // ğŸ¯ ä½ç½®æƒé‡ï¼šåº•éƒ¨å¯¼èˆªæ å…ƒç´ æƒé‡æ›´é«˜
    // ğŸ¯ ç´¢å¼•æƒé‡ï¼šç¬¬ä¸€ä¸ªåŒ¹é…é€šå¸¸æ˜¯ç›®æ ‡
    // ğŸ¯ æ–‡æœ¬å†…å®¹æƒé‡
}
```

**è§£å†³çš„é—®é¢˜ï¼š**
- âŒ æ—§æ–¹å¼ï¼šåº•éƒ¨å¯¼èˆªæ 4ä¸ªæŒ‰é’®ç”¨åŒä¸€ä¸ªresource-id â†’ éšæœºé€‰æ‹©
- âœ… æ–°æ–¹å¼ï¼š
  - é‡å¤IDæ—¶é™ä½åŸºç¡€ç½®ä¿¡åº¦
  - åº•éƒ¨åŒºåŸŸï¼ˆy > 80%å±å¹•é«˜åº¦ï¼‰æƒé‡+30%
  - ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹æƒé‡+10%
  - æœ‰æ–‡æœ¬å†…å®¹çš„æƒé‡+10%

### 3. **SelfDescç­–ç•¥å®Œæ•´å®ç°** âœ…
```rust
/// SelfDesc ç­–ç•¥çš„æŸ¥æ‰¾å®ç°
fn find_by_self_desc(&self, env: &ExecutionEnvironment, variant: &StrategyVariant) -> Result<MatchSet> {
    // ğŸ¯ æ™ºèƒ½è§£æ content-descï¼ˆ"æˆ‘ï¼ŒæŒ‰é’®" -> "æˆ‘"ï¼‰
    let core_text = Self::extract_core_content_desc(target_content_desc);
    candidates = self.search_by_content_desc_with_hierarchy(env, &core_text, target_content_desc)?;
}
```

**è§£å†³çš„é—®é¢˜ï¼š**
- âŒ æ—§æ–¹å¼ï¼š`find_by_self_desc` è¿”å›ç©ºç»“æœ
- âœ… æ–°æ–¹å¼ï¼šå®Œæ•´çš„content-descæœç´¢ + å±‚çº§è¯†åˆ«

### 4. **æ™ºèƒ½content-descè§£æ** âœ…
```rust
/// ğŸ¯ æ ¸å¿ƒç®—æ³•ï¼šæ™ºèƒ½è§£æcontent-descï¼Œæå–æ ¸å¿ƒæ–‡æœ¬
fn extract_core_content_desc(content_desc: &str) -> String {
    // å¤„ç†å¸¸è§æ ¼å¼ï¼š"æˆ‘ï¼ŒæŒ‰é’®" -> "æˆ‘"
    if let Some(comma_pos) = content_desc.find('ï¼Œ') {
        content_desc[..comma_pos].trim().to_string()
    } else if let Some(comma_pos) = content_desc.find(',') {
        content_desc[..comma_pos].trim().to_string()
    }
    // ç§»é™¤å¸¸è§åç¼€è¯ï¼š"æŒ‰é’®"ã€"åŒå‡»æ¿€æ´»"ç­‰
}
```

**ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼Ÿ**
- **Androidæ— éšœç¢æ ‡å‡†**ï¼š`content-desc="æˆ‘ï¼ŒæŒ‰é’®"`
- **ç”¨æˆ·è¾“å…¥**ï¼š`"æˆ‘"`
- **é—®é¢˜**ï¼šä¸¥æ ¼åŒ¹é…å¤±è´¥ `"æˆ‘" != "æˆ‘ï¼ŒæŒ‰é’®"`
- **è§£å†³**ï¼šæ™ºèƒ½è§£æ `"æˆ‘ï¼ŒæŒ‰é’®" â†’ "æˆ‘"` âœ…

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹ï¼šæŠ–éŸ³"æˆ‘"æŒ‰é’®

### çœŸå®XMLç»“æ„
```xml
<TextView text="æˆ‘" 
          resource-id="com.ss.android.ugc.aweme:id/0vl" 
          class="android.widget.TextView" 
          content-desc="æˆ‘ï¼ŒæŒ‰é’®" 
          bounds="[950,2264][994,2324]" 
          clickable="false" />

<!-- çˆ¶å®¹å™¨ï¼ˆçœŸæ­£çš„ç‚¹å‡»ç›®æ ‡ï¼‰ -->
<FrameLayout bounds="[864,2230][1080,2358]" clickable="true" />
```

### å¤„ç†æµç¨‹
1. **ç”¨æˆ·è¾“å…¥**ï¼š`"æˆ‘"`
2. **æ™ºèƒ½è§£æ**ï¼š`"æˆ‘ï¼ŒæŒ‰é’®" â†’ "æˆ‘"` âœ…
3. **æ‰¾åˆ°åŒ¹é…å…ƒç´ **ï¼šTextView (clickable=false)
4. **å±‚çº§è¯†åˆ«**ï¼šæ‰¾åˆ°å¯ç‚¹å‡»çˆ¶å®¹å™¨ FrameLayout âœ…
5. **é‡å¤IDå¤„ç†**ï¼šåº•éƒ¨å¯¼èˆªåŒºåŸŸæƒé‡æå‡ âœ…
6. **æ‰§è¡Œç‚¹å‡»**ï¼šè®¡ç®—çˆ¶å®¹å™¨ä¸­å¿ƒåæ ‡ âœ…

## ğŸ“Š é¢„æœŸæå‡æ•ˆæœ

| åœºæ™¯ | æ—§ç³»ç»ŸæˆåŠŸç‡ | æ–°ç³»ç»ŸæˆåŠŸç‡ | æå‡åŸå›  |
|------|-------------|-------------|----------|
| content-descåŒ¹é… | 30% | 85% | æ™ºèƒ½è§£æ |
| é‡å¤resource-id | 25% | 70% | ä½ç½®æƒé‡ |
| ä¸å¯ç‚¹å‡»å…ƒç´  | 0% | 80% | å±‚çº§è¯†åˆ« |
| åº•éƒ¨å¯¼èˆªæ  | 40% | 90% | ä½ç½®+å±‚çº§ |

## ğŸ¯ æ ¸å¿ƒç®—æ³•æ€»ç»“

### å¤šå±‚ç­–ç•¥åŒ¹é…
1. **åŸå§‹å®Œæ•´åŒ¹é…**ï¼š`content-desc="æˆ‘ï¼ŒæŒ‰é’®"` (ç½®ä¿¡åº¦ 95%)
2. **æ ¸å¿ƒæ–‡æœ¬åŒ¹é…**ï¼š`content-desc contains "æˆ‘"` (ç½®ä¿¡åº¦ 85%)
3. **å¤‡ç”¨textåŒ¹é…**ï¼š`text="æˆ‘"` (ç½®ä¿¡åº¦ 75%)

### æ™ºèƒ½å±‚çº§è¯†åˆ«
1. **æ£€æŸ¥è‡ªèº«å¯ç‚¹å‡»æ€§**
2. **æŸ¥æ‰¾åŒ…å«çš„å¯ç‚¹å‡»çˆ¶å®¹å™¨**
3. **é€‰æ‹©é¢ç§¯æœ€å°çš„åŒ¹é…å®¹å™¨**
4. **è¿”å›æœ€ä½³ç‚¹å‡»ç›®æ ‡**

### é‡å¤IDæƒé‡ç®—æ³•
```
åŸºç¡€ç½®ä¿¡åº¦ = 0.8
é‡å¤æƒ©ç½š = -0.2 (æœ‰é‡å¤æ—¶)
ä½ç½®åŠ æƒ = +0.3 (åº•éƒ¨åŒºåŸŸ)
ç´¢å¼•åŠ æƒ = +0.1 (ç¬¬ä¸€ä¸ªåŒ¹é…)
å†…å®¹åŠ æƒ = +0.1 (æœ‰æ–‡æœ¬)
æœ€ç»ˆç½®ä¿¡åº¦ = max(0.0, min(1.0, æ€»åˆ†))
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### SelfDescç­–ç•¥
```rust
let strategy = StrategyExecutor::SelfDesc;
let variant = StrategyVariant {
    resources: Some({
        "content_desc": "æˆ‘ï¼ŒæŒ‰é’®"
    }),
    ...
};
let matches = strategy.find_matches(&env, &variant)?;
```

### SelfIdç­–ç•¥ï¼ˆå¢å¼ºç‰ˆï¼‰
```rust
let strategy = StrategyExecutor::SelfId;
let variant = StrategyVariant {
    resources: Some({
        "resource_id": "com.ss.android.ugc.aweme:id/0vl"
    }),
    ...
};
let matches = strategy.find_matches(&env, &variant)?; // è‡ªåŠ¨å¤„ç†é‡å¤ID
```

## âœ… éªŒè¯æ¸…å•

- [x] content-descæ™ºèƒ½è§£æå®ç°
- [x] å±‚çº§ç‚¹å‡»ç›®æ ‡è¯†åˆ«å®ç°  
- [x] resource-idé‡å¤å¤„ç†å®ç°
- [x] SelfDescç­–ç•¥å®Œæ•´å®ç°
- [x] ç¼–è¯‘é€šè¿‡ (strategy_plugin_v2.rs)
- [x] ç®—æ³•é€»è¾‘éªŒè¯
- [x] æµ‹è¯•ç”¨ä¾‹è®¾è®¡

**æ€»ç»“ï¼šç°åœ¨çš„Step 0-6ç³»ç»Ÿå·²ç»ä¸å†"æŸæ‰‹æ— ç­–"ï¼Œèƒ½å¤Ÿæ™ºèƒ½å¤„ç†å¤æ‚çš„Android UIåœºæ™¯ï¼** ğŸ‰
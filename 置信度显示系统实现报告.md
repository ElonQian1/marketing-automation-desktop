# ç½®ä¿¡åº¦æ˜¾ç¤ºç³»ç»Ÿå®ç°æŠ¥å‘Š

## ğŸ¯ ç›®æ ‡è¾¾æˆ

æœ‹å‹æä¾›çš„ç½®ä¿¡åº¦æ˜¾ç¤ºæ¶æ„æ–¹æ¡ˆå·²æˆåŠŸå®ç°ï¼Œè§£å†³äº†"åç«¯åˆ†æå®Œæˆ100%ä½†å‰ç«¯æŒ‰é’®ä»æ˜¾ç¤º'ğŸ§  æ™ºèƒ½Â·è‡ªåŠ¨é“¾ ğŸ”„ 0%'"çš„é—®é¢˜ï¼Œå¹¶æ·»åŠ äº†å…¨é¢çš„ç½®ä¿¡åº¦æ˜¾ç¤ºåŠŸèƒ½ã€‚

## ğŸ“‹ å®ç°æ¸…å•

### âœ… 1. ç±»å‹å®šä¹‰å¢å¼º

**æ–‡ä»¶**: `src/modules/universal-ui/types/intelligent-analysis-types.ts`
- æ–°å¢ `ConfidenceEvidence` æ¥å£ï¼šåŒ…å«æ¨¡å‹ã€å®šä½ã€å¯è§æ€§ã€è®¾å¤‡å››ä¸ªç»´åº¦çš„ç½®ä¿¡åº¦
- æ‰©å±• `AnalysisDoneEvent` æ¥å£ï¼šæ·»åŠ  `confidence` å’Œ `evidence` å­—æ®µ
- ä¸ºåç«¯äº‹ä»¶æä¾›å®Œæ•´ç±»å‹æ”¯æŒ

### âœ… 2. ç½®ä¿¡åº¦å·¥å…·å‡½æ•°

**æ–‡ä»¶**: `src/modules/universal-ui/utils/confidence-utils.ts`
- `getConfidenceLevel()`: æ ¹æ®ç½®ä¿¡åº¦åˆ†æ•°æ˜ å°„åˆ°é«˜/ä¸­/ä½ç­‰çº§å’Œé¢œè‰²
- `estimateConfidence()`: å®Œæ•´çš„ç½®ä¿¡åº¦ä¼°ç®—å‡½æ•°ï¼ˆç”¨äºAnalysisResultï¼‰
- `estimateConfidenceFromEvent()`: ç®€åŒ–ç‰ˆä¼°ç®—å‡½æ•°ï¼ˆç”¨äºäº‹ä»¶å¤„ç†ï¼‰
- `formatConfidence()`: æ ¼å¼åŒ–ç½®ä¿¡åº¦ä¸ºç™¾åˆ†æ¯”å­—ç¬¦ä¸²
- `generateEvidenceDescription()`: ç”Ÿæˆè¯æ®è¯¦æƒ…æè¿°æ–‡æœ¬

### âœ… 3. ConfidenceTag ç»„ä»¶

**æ–‡ä»¶**: `src/modules/universal-ui/components/confidence-tag.tsx`
- å½©è‰²ç½®ä¿¡åº¦æ ‡ç­¾ï¼šç»¿è‰²(â‰¥85%) / æ©™è‰²(70-84%) / çº¢è‰²(<70%)
- æ”¯æŒå¤šç§å°ºå¯¸ï¼šsmall / default / large
- æ™ºèƒ½ Tooltipï¼šæ‚¬åœæ˜¾ç¤ºè¯æ®è¯¦æƒ…ï¼ˆæ¨¡å‹|å®šä½|å¯è§|è®¾å¤‡ï¼‰
- è‡ªåŠ¨åº”ç”¨ `light-theme-force` ç±»é¿å…ç™½åº•ç™½å­—é—®é¢˜

### âœ… 4. StepCard Store å¢å¼º

**æ–‡ä»¶**: `src/store/stepcards.ts`
- æ‰©å±• `StepCard` æ¥å£ï¼šæ·»åŠ  `confidence` å’Œ `evidence` å­—æ®µ
- æ–°å¢ `setConfidence()` æ–¹æ³•ï¼šç»Ÿä¸€çš„ç½®ä¿¡åº¦çŠ¶æ€ç®¡ç†
- å®Œæ•´çš„ç±»å‹å¯¼å…¥ï¼šæ”¯æŒ `ConfidenceEvidence` ç±»å‹

### âœ… 5. å…¨å±€äº‹ä»¶å¤„ç†å™¨æ›´æ–°

**æ–‡ä»¶**: `src/application/analysis/wire-global-events.ts`
- ç›‘å¬æ‰©å±•çš„ `AnalysisDoneEvent`ï¼šæ”¯æŒç½®ä¿¡åº¦å­—æ®µ
- è‡ªåŠ¨ç½®ä¿¡åº¦å¤„ç†ï¼šåç«¯æä¾›æ—¶ç›´æ¥ä½¿ç”¨ï¼Œå¦åˆ™ä½¿ç”¨ä¼°ç®—é€»è¾‘
- æ™ºèƒ½å…œåº•æœºåˆ¶ï¼šç¡®ä¿æ‰€æœ‰å®Œæˆçš„åˆ†æéƒ½æœ‰ç½®ä¿¡åº¦ä¿¡æ¯

### âœ… 6. UI é›†æˆ

**æ–‡ä»¶**: `src/components/strategy-selector/UnifiedCompactStrategyMenu.tsx`
- é›†æˆ `ConfidenceTag` ç»„ä»¶ï¼šåœ¨ç­–ç•¥å°±ç»ªæ—¶æ˜¾ç¤ºç½®ä¿¡åº¦
- ç®€åŒ–æŒ‰é’®æ–‡æœ¬ï¼šç§»é™¤å†—ä½™çš„ç½®ä¿¡åº¦ä¿¡æ¯ï¼Œä½¿ç”¨ä¸“é—¨çš„æ ‡ç­¾æ˜¾ç¤º
- ä½ç½®ä¼˜åŒ–ï¼šç½®ä¿¡åº¦æ ‡ç­¾æ˜¾ç¤ºåœ¨æŒ‰é’®æ—è¾¹ï¼Œä¸å¹²æ‰°ä¸»è¦åŠŸèƒ½

### âœ… 7. æ¨¡å—å¯¼å‡º

**æ–‡ä»¶**: `src/modules/universal-ui/index.ts`
- å¯¼å‡ºç½®ä¿¡åº¦ç›¸å…³å·¥å…·å’Œç»„ä»¶
- ç»Ÿä¸€çš„æ¨¡å—å…¥å£ï¼Œæ”¯æŒå¤–éƒ¨å¼•ç”¨

### âœ… 8. æ¼”ç¤ºé¡µé¢

**æ–‡ä»¶**: `src/pages/confidence-demo.tsx`
- å®Œæ•´çš„ç½®ä¿¡åº¦åŠŸèƒ½æ¼”ç¤º
- å¤šç§åœºæ™¯æµ‹è¯•ï¼šé«˜/ä¸­/ä½ç½®ä¿¡åº¦ã€åŠ¨æ€æ›´æ–°ã€ç­–ç•¥é›†æˆ
- æ·»åŠ åˆ°ä¸»åº”ç”¨èœå•ï¼šğŸ“Š ç½®ä¿¡åº¦æ˜¾ç¤ºæ¼”ç¤º

## ğŸ¨ è§†è§‰æ•ˆæœ

### ç½®ä¿¡åº¦ç­‰çº§æ˜ å°„
- **é«˜ç½®ä¿¡åº¦ (â‰¥85%)**: ç»¿è‰²æ ‡ç­¾ `#52c41a`ï¼Œæ˜¾ç¤º"é«˜ XX%"
- **ä¸­ç­‰ç½®ä¿¡åº¦ (70-84%)**: æ©™è‰²æ ‡ç­¾ `#fa8c16`ï¼Œæ˜¾ç¤º"ä¸­ XX%"  
- **ä½ç½®ä¿¡åº¦ (<70%)**: çº¢è‰²æ ‡ç­¾ `#ff4d4f`ï¼Œæ˜¾ç¤º"ä½ XX%"

### è¯æ®è¯¦æƒ…å±•ç¤º
- æ‚¬åœ Tooltip æ˜¾ç¤ºå››ä¸ªç»´åº¦ï¼š`æ¨¡å‹: XX% | å®šä½: XX% | å¯è§: XX% | è®¾å¤‡: XX%`
- å¸®åŠ©ç”¨æˆ·ç†è§£ç½®ä¿¡åº¦çš„å…·ä½“ç»„æˆ

## ğŸ”§ æŠ€æœ¯ç‰¹æ€§

### 1. æ¸è¿›å¼å¢å¼º
- åç«¯ä¸æä¾›ç½®ä¿¡åº¦æ—¶ï¼šè‡ªåŠ¨ä½¿ç”¨ä¼°ç®—ç®—æ³•
- å…¼å®¹ç°æœ‰ä»£ç ï¼šä¸å½±å“åŸæœ‰åŠŸèƒ½
- æœ€å°ä¾µå…¥æ€§ï¼šåªåœ¨éœ€è¦çš„åœ°æ–¹æ·»åŠ ç½®ä¿¡åº¦æ˜¾ç¤º

### 2. ç±»å‹å®‰å…¨
- å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- ä¸¥æ ¼çš„æ¥å£çº¦æŸ
- ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥

### 3. æ€§èƒ½ä¼˜åŒ–
- è½»é‡çº§ç»„ä»¶ï¼šæœ€å°åŒ– DOM å’Œæ ·å¼å¼€é”€
- æ™ºèƒ½ç¼“å­˜ï¼šç½®ä¿¡åº¦è®¡ç®—ç»“æœå­˜å‚¨åœ¨ store ä¸­
- æ¡ä»¶æ¸²æŸ“ï¼šåªåœ¨æœ‰ç½®ä¿¡åº¦æ•°æ®æ—¶æ¸²æŸ“æ ‡ç­¾

### 4. æ ·å¼å…¼å®¹
- è‡ªåŠ¨åº”ç”¨ `light-theme-force` ç±»
- é¿å…æ·±è‰²ä¸»é¢˜ä¸‹çš„å¯è¯»æ€§é—®é¢˜
- æ”¯æŒä¸åŒå°ºå¯¸å’Œæ˜¾ç¤ºæ¨¡å¼

## ğŸ§ª æµ‹è¯•éªŒè¯

### éªŒè¯åœºæ™¯
1. **åŸºç¡€åŠŸèƒ½**: ç½®ä¿¡åº¦æ ‡ç­¾æ­£ç¡®æ˜¾ç¤ºå’Œé¢œè‰²æ˜ å°„
2. **äº‹ä»¶é›†æˆ**: åˆ†æå®Œæˆäº‹ä»¶æ­£ç¡®è§¦å‘ç½®ä¿¡åº¦æ›´æ–°
3. **å…œåº•æœºåˆ¶**: åç«¯æœªæä¾›ç½®ä¿¡åº¦æ—¶çš„ä¼°ç®—é€»è¾‘
4. **UIé›†æˆ**: ç­–ç•¥é€‰æ‹©å™¨ä¸­çš„ç½®ä¿¡åº¦æ˜¾ç¤º
5. **æ ·å¼å…¼å®¹**: æ·±è‰²ä¸»é¢˜ä¸‹çš„å¯è¯»æ€§

### æµ‹è¯•æ–¹æ³•
- é€šè¿‡æ¼”ç¤ºé¡µé¢ï¼š`ğŸ“Š ç½®ä¿¡åº¦æ˜¾ç¤ºæ¼”ç¤º`
- å®é™…ç­–ç•¥åˆ†æï¼šä½¿ç”¨ç­–ç•¥é€‰æ‹©å™¨è§¦å‘åˆ†æ
- æ§åˆ¶å°ç›‘æ§ï¼šè§‚å¯Ÿäº‹ä»¶å’ŒçŠ¶æ€å˜åŒ–

## ğŸ’¡ è®¾è®¡äº®ç‚¹

### 1. æœ‹å‹æ–¹æ¡ˆçš„å®Œç¾å®ç°
- ä¸¥æ ¼æŒ‰ç…§æœ‹å‹æä¾›çš„æŠ€æœ¯æ¶æ„å®ç°
- ä¿æŒ"æœ€å°å¯è½åœ°"çš„è®¾è®¡åŸåˆ™
- æ¸è¿›å¼é›†æˆï¼Œä¸ç ´åç°æœ‰åŠŸèƒ½

### 2. ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- ç›´è§‚çš„é¢œè‰²ç¼–ç ï¼šç»¿/æ©™/çº¢å¯¹åº”é«˜/ä¸­/ä½ç½®ä¿¡åº¦
- è¯¦ç»†çš„è¯æ®å±•ç¤ºï¼šå¸®åŠ©ç”¨æˆ·ç†è§£ç½®ä¿¡åº¦æ¥æº
- éå¹²æ‰°å¼è®¾è®¡ï¼šä¸å½±å“ä¸»è¦æ“ä½œæµç¨‹

### 3. å¼€å‘ä½“éªŒæå‡
- å®Œæ•´çš„ç±»å‹å®šä¹‰ï¼šå¼€å‘æ—¶çš„æ™ºèƒ½æç¤º
- ç»Ÿä¸€çš„å·¥å…·å‡½æ•°ï¼šå‡å°‘é‡å¤ä»£ç 
- æ¸…æ™°çš„ç»„ä»¶æ¥å£ï¼šæ˜“äºé›†æˆå’Œç»´æŠ¤

## ğŸ”„ åç»­æ‰©å±•

### çŸ­æœŸä¼˜åŒ–
- æ·»åŠ ç½®ä¿¡åº¦å†å²è®°å½•
- æ”¯æŒç½®ä¿¡åº¦é˜ˆå€¼é…ç½®
- å¢åŠ æ›´å¤šè¯æ®ç»´åº¦

### é•¿æœŸè§„åˆ’
- ç½®ä¿¡åº¦è¶‹åŠ¿åˆ†æ
- æœºå™¨å­¦ä¹ æ¨¡å‹ç½®ä¿¡åº¦é¢„æµ‹
- ç”¨æˆ·åé¦ˆå¾ªç¯æ”¹è¿›

## ğŸ“ æ€»ç»“

ç½®ä¿¡åº¦æ˜¾ç¤ºç³»ç»Ÿå·²å®Œå…¨æŒ‰ç…§æœ‹å‹çš„æ¶æ„æ–¹æ¡ˆå®ç°ï¼ŒæˆåŠŸè§£å†³äº†åŸå§‹é—®é¢˜å¹¶æä¾›äº†å®Œæ•´çš„ç½®ä¿¡åº¦å¯è§†åŒ–åŠŸèƒ½ã€‚ç³»ç»Ÿè®¾è®¡éµå¾ªäº†æœ€å°ä¾µå…¥ã€æ¸è¿›å¢å¼ºã€ç±»å‹å®‰å…¨çš„åŸåˆ™ï¼Œä¸ºç”¨æˆ·æä¾›äº†ç›´è§‚ã€æœ‰ç”¨çš„åˆ†æå¯ä¿¡åº¦ä¿¡æ¯ã€‚

**æ ¸å¿ƒä»·å€¼**: è®©ç”¨æˆ·åœ¨ä½¿ç”¨æ™ºèƒ½åˆ†æåŠŸèƒ½æ—¶ï¼Œèƒ½å¤Ÿæ¸…æ¥šäº†è§£åˆ†æç»“æœçš„å¯ä¿¡ç¨‹åº¦ï¼Œåšå‡ºæ›´å¥½çš„å†³ç­–ã€‚
# ğŸ”‡ æ—¥å¿—ä¼˜åŒ–æŒ‡å—

## é—®é¢˜åˆ†æ

ä»ä½ çš„æ—¥å¿—çœ‹åˆ°ä»¥ä¸‹å†—ä½™ï¼š

### 1. **é«˜é¢‘é‡å¤æ—¥å¿—**ï¼ˆæ¯æ¬¡æ¸²æŸ“éƒ½æ‰“å°ï¼‰

```javascript
// âŒ æ¯æ¬¡æ¸²æŸ“æ‰“å° 7 æ¬¡
VisualElementView.tsx:521 ğŸ”„ [VisualElementView] æ£€æµ‹åˆ°HookåŒ…å«èœå•å…ƒç´ 
VisualElementView.tsx:527 ğŸ“Š [VisualElementView] æ•°æ®æºé€‰æ‹©ç»“æœ

// âŒ æ¯æ¬¡æ¸²æŸ“æ‰“å°
PagePreview.tsx:125 ğŸ” PagePreview åæ ‡ç³»è¯Šæ–­ï¼ˆv2ï¼‰

// âŒ æ¯æ¬¡çŠ¶æ€æ›´æ–°æ‰“å°å¤šæ¬¡
CompactStrategyMenu.tsx:167 ğŸ¯ [CompactStrategyMenu] æ•°æ®æ£€æŸ¥
```

### 2. **å¤šè·¯å¾„é‡å¤äº‹ä»¶**ï¼ˆåŒä¸€äº‹ä»¶å¤šä¸ªç»„ä»¶ç›‘å¬ï¼‰

```javascript
// åŒä¸€è¿›åº¦æ›´æ–°è¢«æ‰“å° 7 æ¬¡
intelligent-analysis-backend.ts:194 ğŸ“Š [BackendService] æ”¶åˆ°åˆ†æè¿›åº¦æ›´æ–°
useIntelligentAnalysisAdapter.ts:91 ğŸ“Š [Adapter] æ”¶åˆ°è¿›åº¦æ›´æ–°
devTracer.ts:42 [EVT] analysis:progress
wire-global-events.ts:124 âš ï¸ [GlobalWire] progressäº‹ä»¶æ‰¾ä¸åˆ°å¡ç‰‡
```

## âœ… ç«‹å³ä¼˜åŒ–æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šä½¿ç”¨æ—¥å¿—è¿‡æ»¤å™¨ï¼ˆæ¨èï¼‰

åœ¨æ§åˆ¶å°æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆä¸´æ—¶ç”Ÿæ•ˆï¼‰ï¼š

```javascript
// 1. è®¾ç½®æ—¥å¿—çº§åˆ«ä¸º WARNï¼ˆåªæ˜¾ç¤ºè­¦å‘Šå’Œé”™è¯¯ï¼‰
logger.setLevel(LogLevel.WARN)

// 2. é™éŸ³æŒ‡å®šç»„ä»¶çš„è°ƒè¯•æ—¥å¿—
logger.mute('[VisualElementView]', 'PagePreview', '[CompactStrategyMenu]')

// 3. åªçœ‹å…³é”®æ•°æ®æµ
logger.setLevel(LogLevel.INFO)
logger.mute('ğŸ“Š', 'ğŸ”„', 'ğŸ”', 'æ•°æ®æ£€æŸ¥', 'åæ ‡ç³»è¯Šæ–­')
```

### æ–¹æ¡ˆ 2ï¼šä¿®æ”¹ localStorageï¼ˆæŒä¹…ç”Ÿæ•ˆï¼‰

åœ¨æ§åˆ¶å°æ‰§è¡Œï¼š

```javascript
// åªæ˜¾ç¤ºå…³é”®ä¿¡æ¯
localStorage.setItem('LOG_LEVEL', 'CRITICAL')

// æˆ–ä¿ç•™è­¦å‘Šå’Œé”™è¯¯
localStorage.setItem('LOG_LEVEL', 'WARN')

// åˆ·æ–°é¡µé¢ç”Ÿæ•ˆ
location.reload()
```

## ğŸ”¥ å…³é”®æ•°æ®æµæ—¥å¿—ï¼ˆä¿ç•™è¿™äº›ï¼‰

### å‰ç«¯å‘é€æ•°æ®æ£€æŸ¥ï¼š

```javascript
// âœ… å¿…é¡»çœ‹è¿™ä¸ªï¼éªŒè¯ xmlFileName æ ¼å¼
usePageFinderModal.ts:312 âœ… [usePageFinderModal] XMLå·²ä¿å­˜åˆ°ç¼“å­˜: {
  xmlCacheId,
  xmlFileName,  // ğŸ”¥ å…³é”®ï¼åº”è¯¥æ˜¯ "ui_dump_xxx.xml" æ ¼å¼
  xmlContentLength
}

// âœ… éªŒè¯å…ƒç´ æºå¸¦æ­£ç¡®çš„ xmlCacheId
UniversalPageFinderModal.tsx:482 âœ… [UniversalPageFinderModal] é™„åŠ xmlCacheIdåˆ°å…ƒç´ : {
  xmlCacheId  // ğŸ”¥ åº”è¯¥ä¸ä¸Šé¢çš„ xmlFileName ä¸€è‡´
}

// âœ… éªŒè¯ç¼“å­˜è·å–æˆåŠŸ
useIntelligentStepCardIntegration.ts:100 âœ… [convertElementToContext] ä»ç¼“å­˜è·å–XMLæˆåŠŸ: {
  xmlCacheId,
  xmlContentLength  // ğŸ”¥ åº”è¯¥ > 50000
}
```

### åç«¯æ¥æ”¶æ•°æ®æ£€æŸ¥ï¼ˆRust æ§åˆ¶å°ï¼‰ï¼š

```rust
// âœ… æ£€æŸ¥åç«¯æ˜¯å¦æ”¶åˆ° XML
INFO: ğŸ“‹ åŸå§‹å‚æ•°: {..., "original_xml": "<hierarchy>...", ...}
INFO: âœ… [æ•°æ®å®Œæ•´æ€§] original_xml é•¿åº¦: 59220 bytes

// âœ… æ£€æŸ¥å¤šå€™é€‰è¯„ä¼°åˆ†æ•°
INFO: [1] è¯„åˆ†: 0.980 | text=Some("é€šè®¯å½•")
```

## ğŸ› ä½ çš„æ—¥å¿—é—®é¢˜

### é—®é¢˜ï¼šxmlCacheId æ ¼å¼é”™è¯¯

```javascript
// âŒ å½“å‰æ—¥å¿—ï¼ˆé”™è¯¯ï¼‰
xmlCacheId: 'xml_PD94bWwgdmVyc2lv_1761628466736'

// âœ… åº”è¯¥æ˜¯ï¼ˆæ­£ç¡®ï¼‰
xmlCacheId: 'ui_dump_e0d909c3_20251028_030232.xml'
```

**åŸå› **ï¼šåç«¯æ²¡æœ‰è¿”å› `xml_file_name` å­—æ®µï¼Œæˆ–è¿”å›ä¸ºç©º

### è§£å†³æ­¥éª¤ï¼š

#### 1. æ·»åŠ ä¸´æ—¶è°ƒè¯•æ—¥å¿—

åœ¨ `usePageFinderModal.ts` ç¬¬ 305 è¡Œåæ·»åŠ ï¼š

```typescript
const xmlCacheId = result.xmlFileName || `xml_${snapshot.xmlHash.substring(0, 16)}_${Date.now()}`;

// ğŸ”¥ ä¸´æ—¶è°ƒè¯•ï¼šæ‰“å°åç«¯è¿”å›çš„åŸå§‹æ•°æ®
console.log('ğŸ”¥ğŸ”¥ğŸ”¥ [DEBUG] åç«¯è¿”å›æ•°æ®:', {
  hasXmlFileName: !!result.xmlFileName,
  xmlFileName: result.xmlFileName,
  xmlFileNameType: typeof result.xmlFileName,
  xmlFileNameLength: result.xmlFileName?.length,
  fallbackUsed: !result.xmlFileName,
  actualCacheId: xmlCacheId
});
```

#### 2. æ£€æŸ¥åç«¯ Rust ä»£ç 

æ‰¾åˆ° `analyze_universal_ui_page` å‡½æ•°ï¼Œç¡®ä¿è¿”å›äº† `xml_file_name` å­—æ®µï¼š

```rust
// src-tauri/src/api/universal_ui_handler.rs
pub struct UniversalPageCaptureResult {
    pub xml_content: String,
    pub xml_file_name: String,  // ğŸ”¥ å¿…é¡»æœ‰è¿™ä¸ªå­—æ®µï¼
    pub xml_relative_path: String,
    pub xml_absolute_path: String,
    // ...
}
```

#### 3. éªŒè¯ä¿®å¤

é‡æ–°è¿è¡Œåï¼ŒæŸ¥çœ‹æ—¥å¿—åº”è¯¥æ˜¾ç¤ºï¼š

```javascript
ğŸ”¥ğŸ”¥ğŸ”¥ [DEBUG] åç«¯è¿”å›æ•°æ®: {
  hasXmlFileName: true,
  xmlFileName: 'ui_dump_e0d909c3_20251028_030232.xml',
  xmlFileNameType: 'string',
  xmlFileNameLength: 43,
  fallbackUsed: false,
  actualCacheId: 'ui_dump_e0d909c3_20251028_030232.xml'
}
```

## ğŸ“ æ—¥å¿—ä¼˜åŒ–æœ€ä½³å®è·µ

### 1. **åˆ†å±‚æ—¥å¿—**

```typescript
// ğŸ”¥ å…³é”®æ•°æ®ï¼ˆå§‹ç»ˆæ˜¾ç¤ºï¼‰
logger.critical('[Module]', 'å…³é”®æ“ä½œ', data);

// âŒ é”™è¯¯
logger.error('[Module]', 'æ“ä½œå¤±è´¥', error);

// âš ï¸ è­¦å‘Š
logger.warn('[Module]', 'æ½œåœ¨é—®é¢˜', warning);

// â„¹ï¸ ä¿¡æ¯ï¼ˆç”Ÿäº§ç¯å¢ƒå¯å…³é—­ï¼‰
logger.info('[Module]', 'çŠ¶æ€æ›´æ–°', data);

// ğŸ” è°ƒè¯•ï¼ˆé»˜è®¤å…³é—­ï¼‰
logger.debug('[Module]', 'è¯¦ç»†æ•°æ®', data);
```

### 2. **å»é‡æœºåˆ¶**

```typescript
// è‡ªåŠ¨å»é‡ï¼š1 ç§’å†…ç›¸åŒæ—¥å¿—åªæ‰“å°ä¸€æ¬¡
logger.info('[Module]', 'çŠ¶æ€æ›´æ–°', data);
```

### 3. **æ¡ä»¶æ—¥å¿—**

```typescript
// åªåœ¨å¼€å‘ç¯å¢ƒæ‰“å°
if (import.meta.env.DEV) {
  console.log('ğŸ” [Debug]', data);
}
```

## ğŸ¯ å¿«é€Ÿè¯Šæ–­å‘½ä»¤

### åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œï¼š

```javascript
// 1. åªçœ‹å…³é”®é”™è¯¯
logger.setLevel(3); // ERROR
logger.clearMuted();

// 2. åªçœ‹ XML ç›¸å…³æ—¥å¿—
logger.setLevel(1); // INFO
logger.mute('VisualElementView', 'PagePreview', 'CompactStrategyMenu', 'progressäº‹ä»¶');

// 3. æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—ï¼ˆè°ƒè¯•æ¨¡å¼ï¼‰
logger.setLevel(0); // DEBUG
logger.clearMuted();

// 4. æ¢å¤é»˜è®¤
logger.setLevel(1); // INFO
logger.mute('æ•°æ®æºé€‰æ‹©', 'åæ ‡ç³»è¯Šæ–­', 'æ•°æ®æ£€æŸ¥');
```

## ğŸ” ä¸‹ä¸€æ­¥æ“ä½œ

1. **ç«‹å³æ‰§è¡Œ**ï¼šåœ¨æ§åˆ¶å°è¿è¡Œ `logger.mute('VisualElementView', 'PagePreview')` å‡å°‘å™ªéŸ³
2. **æ·»åŠ è°ƒè¯•æ—¥å¿—**ï¼šåœ¨ `usePageFinderModal.ts` æ·»åŠ  `ğŸ”¥ğŸ”¥ğŸ”¥ [DEBUG]` æ—¥å¿—
3. **é‡æ–°æµ‹è¯•**ï¼šé‡‡é›†é¡µé¢å¹¶æŸ¥çœ‹ `xmlFileName` æ˜¯å¦æ­£ç¡®
4. **æ£€æŸ¥åç«¯**ï¼šå¦‚æœå‰ç«¯æ²¡æ”¶åˆ°ï¼Œå» Rust ä»£ç æ£€æŸ¥è¿”å›å€¼

---

## é™„å½•ï¼šå¸¸è§é—®é¢˜

### Q1: å¦‚ä½•æ°¸ä¹…å‡å°‘æ—¥å¿—ï¼Ÿ

åœ¨ `src/main.tsx` æˆ– `src/App.tsx` é¡¶éƒ¨æ·»åŠ ï¼š

```typescript
import { logger, LogLevel } from '@/utils/logger-filter';

// ç”Ÿäº§ç¯å¢ƒåªæ˜¾ç¤ºè­¦å‘Šå’Œé”™è¯¯
if (import.meta.env.PROD) {
  logger.setLevel(LogLevel.WARN);
}

// å¼€å‘ç¯å¢ƒé™éŸ³å†—ä½™æ—¥å¿—
if (import.meta.env.DEV) {
  logger.mute(
    '[VisualElementView]',
    'PagePreview åæ ‡ç³»è¯Šæ–­',
    '[CompactStrategyMenu] æ•°æ®æ£€æŸ¥'
  );
}
```

### Q2: å¦‚ä½•æ‰¾åˆ°äº§ç”Ÿæ—¥å¿—çš„ä»£ç ä½ç½®ï¼Ÿ

ç‚¹å‡»æ—¥å¿—å‰é¢çš„æ–‡ä»¶åå’Œè¡Œå·ï¼ˆå¦‚ `VisualElementView.tsx:521`ï¼‰ä¼šç›´æ¥è·³è½¬åˆ°ä»£ç ã€‚

### Q3: å¦‚ä½•ä¸´æ—¶å¯ç”¨æŸä¸ªç»„ä»¶çš„æ—¥å¿—ï¼Ÿ

```javascript
// å–æ¶ˆé™éŸ³
logger.unmute('[VisualElementView]')

// åˆ·æ–°é¡µé¢é‡æ–°è§¦å‘
```
